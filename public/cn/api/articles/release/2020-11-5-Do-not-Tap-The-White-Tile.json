{"title":"h5别踩白块游戏","slug":"release/2020-11-5-Do-not-Tap-The-White-Tile","date":"2020-11-05T07:01:00.000Z","updated":"2020-11-05T07:01:00.000Z","comments":true,"path":"api/articles/release/2020-11-5-Do-not-Tap-The-White-Tile.json","excerpt":"内容介绍1.简介别踩白块这个游戏相信很多人都在手机上玩过，今天我们就来做一个网页版的，先上一张游戏效果图： 属于简化版别踩白块，代码相对较为简单易学，主要涉及通过 javascript 操作元素节点的增删以及属性节点（class）的操作。 2.知识点 HTML/CSS JavaScript 元素节点增删 属性节点操作 3.项目架构1234puzzle |index.html |css/index.css |js/index.js 项目原理在开始编程之前，让我们先来分析下整个游戏的流程：一定的速度下移，点击黑块，黑块消失，新的黑块出现在普通游戏玩家眼中，应该是游戏开始，黑块不断向下移动，若黑块触底则游戏结束； 而以开发者来说，应将每一个黑块和白块抽象成一个个的数据结构，黑块的消失和出现其实就是数据结构的创造和销毁，我们来看一张游戏的流程图，对于要编写的功能有一个大概的了解: 实现步骤页面布局可以用 div+css 布局来实现别踩白块的静态效果展示，直接上 HTML 代码，我来简要说下 HTML 思路，将主界面分解成一个 4x4 的大矩形格子，每一个方块代表其中一个小的矩形格，其中每一行的","covers":["/cn/posts/59750/uid1133717-20191017-1571294959274.gif","/cn/posts/59750/image-20201105153016423.png","/cn/posts/59750/uid1133717-20191017-1571294959274.gif"],"content":"<h1 id=\"内容介绍\"><a href=\"#内容介绍\" class=\"headerlink\" title=\"内容介绍\"></a>内容介绍</h1><h4 id=\"1-简介\"><a href=\"#1-简介\" class=\"headerlink\" title=\"1.简介\"></a>1.简介</h4><p>别踩白块这个游戏相信很多人都在手机上玩过，今天我们就来做一个网页版的，先上一张游戏效果图：</p>\n<p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"/cn/posts/59750/uid1133717-20191017-1571294959274.gif\" alt=\"图片描述\"></p>\n<p>属于简化版别踩白块，代码相对较为简单易学，主要涉及通过 javascript 操作元素节点的增删以及属性节点（class）的操作。</p>\n<h4 id=\"2-知识点\"><a href=\"#2-知识点\" class=\"headerlink\" title=\"2.知识点\"></a>2.知识点</h4><ul>\n<li>HTML/CSS</li>\n<li>JavaScript</li>\n<li>元素节点增删</li>\n<li>属性节点操作</li>\n</ul>\n<h4 id=\"3-项目架构\"><a href=\"#3-项目架构\" class=\"headerlink\" title=\"3.项目架构\"></a>3.项目架构</h4><figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">puzzle</span><br><span class=\"line\">   |index.html</span><br><span class=\"line\">   |css/index.css</span><br><span class=\"line\">   |js/index.js</span><br></pre></td></tr></tbody></table></figure>\n\n\n\n<h1 id=\"项目原理\"><a href=\"#项目原理\" class=\"headerlink\" title=\"项目原理\"></a>项目原理</h1><p>在开始编程之前，让我们先来分析下整个游戏的流程：一定的速度下移，点击黑块，黑块消失，新的黑块出现在普通游戏玩家眼中，应该是游戏开始，黑块不断向下移动，若黑块触底则游戏结束；</p>\n<p>而以开发者来说，<strong>应将每一个黑块和白块抽象成一个个的数据结构，黑块的消失和出现其实就是数据结构的创造和销毁</strong>，我们来看一张游戏的流程图，对于要编写的功能有一个大概的了解:</p>\n<p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"/cn/posts/59750/image-20201105153016423.png\" alt=\"image-20201105153016423\"></p>\n<h1 id=\"实现步骤\"><a href=\"#实现步骤\" class=\"headerlink\" title=\"实现步骤\"></a>实现步骤</h1><h4 id=\"页面布局\"><a href=\"#页面布局\" class=\"headerlink\" title=\"页面布局\"></a>页面布局</h4><p>可以用 div+css 布局来实现别踩白块的静态效果展示，直接上 HTML 代码，我来简要说下 HTML 思路，将主界面分解成一个 4x4 的大矩形格子，每一个方块代表其中一个小的矩形格，其中每一行的四个白块中有一个黑块，每一行中黑块位于哪一列是随机生成的，但是我们这里现在是静态页面就自己确定了，然后通过 css 控制样式。</p>\n<p>创建 index.html 文件，并输入以下代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>别踩白块<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/index.css\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"main\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"con\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          /*白块*/</span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell black\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          /*黑块*/</span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell black\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell black\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"row\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell black\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"cell\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"js/index.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"添加样式\"><a href=\"#添加样式\" class=\"headerlink\" title=\"添加样式\"></a>添加样式</h4><p>下面是 css 代码，这里有一个要注意的地方，我将 <code>div#con</code> 块级元素向上提了 100 px，这样在游戏的开始就出现了最底一行的空白，隐藏最上面那行，为什么要这样呢，继续往下看就知道了。设置黑白块的样式，为 js 部分动态插入黑白块做准备。</p>\n<p>创建 <code>css/index.css</code> 文件，并输入以下代码：</p>\n<figure class=\"highlight css\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#main</span> {</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">408px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">408px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">2px</span> solid gray;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">h2</span> {</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#con</span> {</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">400px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: -<span class=\"number\">408px</span>; <span class=\"comment\">/*隐藏所有格子*/</span></span><br><span class=\"line\">  <span class=\"attribute\">border-collapse</span>: collapse;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"comment\">/* 行 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.row</span> {</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"comment\">/* 一个块 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.cell</span> {</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">54</span>, <span class=\"number\">74</span>, <span class=\"number\">129</span>) <span class=\"number\">1px</span> solid;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.black</span> {</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: black;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.btn</span> {</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.start</span> {</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">20px</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: yellowgreen;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<p>如果以上部分你都能够理解并且对应着代码实现的话，那么我们看到的应该是一个空格子，我们设置 id 为 con 的 div 的 top 属性为 0 px: <code>#con {top: 0px;}</code>，这样我们就可以看见：</p>\n<p><img src= \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\" data-lazy-src=\"/cn/posts/59750/uid1133717-20191017-1571294959274.gif\" alt=\"图片描述\"></p>\n<p>是不是很像别踩白块的界面了呢，我们已经成功了一大步，然后就是通过 js 来实现动态的插入黑块或白块，以及操作。</p>\n<h4 id=\"游戏初始化\"><a href=\"#游戏初始化\" class=\"headerlink\" title=\"游戏初始化\"></a>游戏初始化</h4><p>根据前面的 HTML 部分我们可以知道，每个 <code>&lt;div class=\"cell\"&gt;</code> 就代表一个白块，<code>&lt;div class=\"cell black\"&gt;</code> 就代表一个黑块，每点击一个黑块消失其实是删除了一个 <code>&lt;div class=\"row\"&gt;</code> 然后从上面添加一个新的 <code>&lt;div class=\"row\"&gt;</code> 所以我们首先要通过 js 来控制 <code>&lt;div class=\"row\"&gt;</code> 的创造和生成（记得删除在编写静态页面时候指定生成的 4 个 <code>div.row</code>）。具体方法如下：</p>\n<p>删除之前写的 4 个 div.row，将 index.html 文件改为以下代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>别踩白块<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"css/index.css\"</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>score<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span> <span class=\"attr\">id</span>=<span class=\"string\">\"score\"</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"main\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"con\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">\"start\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"start()\"</span>&gt;</span></span><br><span class=\"line\">        开始游戏</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"js/index.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>对游戏进行初始化，在 <code>js/index.js</code> 文件中写入以下代码：</p>\n<figure class=\"highlight javascript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建div, className是其类名</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatediv</span>(<span class=\"params\">className</span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> div = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">'div'</span>);</span><br><span class=\"line\">  div.<span class=\"property\">className</span> = className;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> div;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创造一个&lt;div class=\"row\"&gt;并且有四个子节点&lt;div class=\"cell\"&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createrow</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> row = <span class=\"title function_\">creatediv</span>(<span class=\"string\">'row'</span>); <span class=\"comment\">//创建div className=row</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> arr = <span class=\"title function_\">creatcell</span>(); <span class=\"comment\">//定义div cell的类名,其中一个为cell black</span></span><br><span class=\"line\"></span><br><span class=\"line\">  con.<span class=\"title function_\">appendChild</span>(row); <span class=\"comment\">// 添加row为con的子节点</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) {</span><br><span class=\"line\">    row.<span class=\"title function_\">appendChild</span>(<span class=\"title function_\">creatediv</span>(arr[i])); <span class=\"comment\">//添加row的子节点 cell</span></span><br><span class=\"line\">  }</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">firstChild</span> == <span class=\"literal\">null</span>) {</span><br><span class=\"line\">    con.<span class=\"title function_\">appendChild</span>(row);</span><br><span class=\"line\">  } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">    con.<span class=\"title function_\">insertBefore</span>(row, con.<span class=\"property\">firstChild</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//删除div#con的子节点中最后那个&lt;div class=\"row\"&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">delrow</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">childNodes</span>.<span class=\"property\">length</span> == <span class=\"number\">6</span>) {</span><br><span class=\"line\">    con.<span class=\"title function_\">removeChild</span>(con.<span class=\"property\">lastChild</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatcell</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> temp = [<span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>];</span><br><span class=\"line\">  <span class=\"keyword\">var</span> i = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">4</span>); <span class=\"comment\">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span></span><br><span class=\"line\">  temp[i] = <span class=\"string\">'cell black'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"让黑块动起来\"><a href=\"#让黑块动起来\" class=\"headerlink\" title=\"让黑块动起来\"></a>让黑块动起来</h4><p>在可以通过 js 来创造和销毁 <code>div</code> 后，我们就要让黑块动起来，这个时候我们就用到了之前 css 提到的设定 <code>&lt;div id=\"con\"&gt;</code> 隐藏了一行的 <code>&lt;div id=\"row\"&gt;</code>，我们通过 js 的 DOM 操作使其向下方移动，并设置定时器每 30 毫秒移动一次，这样就实现了黑块的平滑移动，在黑块移动的同时，我们要判断黑块是否已经触底，触底则游戏失败，停止调用 <code>move()</code>，触底后调用函数 <code>fail()</code> 游戏失败，具体方法如下：</p>\n<figure class=\"highlight javascript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//让黑块动起来</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">move</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> top = <span class=\"built_in\">parseInt</span>(<span class=\"variable language_\">window</span>.<span class=\"title function_\">getComputedStyle</span>(con, <span class=\"literal\">null</span>)[<span class=\"string\">'top'</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed + top &gt; <span class=\"number\">0</span>) {</span><br><span class=\"line\">    top = <span class=\"number\">0</span>;</span><br><span class=\"line\">  } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">    top += speed;</span><br><span class=\"line\">  }</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = top + <span class=\"string\">'px'</span>; <span class=\"comment\">//不断移动top值，使它动起来</span></span><br><span class=\"line\">  <span class=\"title function_\">over</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (top == <span class=\"number\">0</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">    con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">'-102px'</span>;</span><br><span class=\"line\">    <span class=\"title function_\">delrow</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 加速函数</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">speedup</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  speed += <span class=\"number\">2</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed == <span class=\"number\">20</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">'你超神了'</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断游戏是否结束</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">over</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> rows = con.<span class=\"property\">childNodes</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (rows.<span class=\"property\">length</span> == <span class=\"number\">5</span> &amp;&amp; rows[rows.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">pass</span> !== <span class=\"number\">1</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; rows.<span class=\"property\">length</span>; i++) {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rows[i].<span class=\"property\">pass1</span> == <span class=\"number\">1</span>) {</span><br><span class=\"line\">      <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">    }</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 游戏结束</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fail</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"built_in\">clearInterval</span>(clock);</span><br><span class=\"line\">  flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"title function_\">confirm</span>(<span class=\"string\">'你的最终得分为 '</span> + <span class=\"built_in\">parseInt</span>($(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span>));</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  con.<span class=\"property\">innerHTML</span> = <span class=\"string\">''</span>;</span><br><span class=\"line\">  $(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">'-408px'</span>;</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"点击黑块事件\"><a href=\"#点击黑块事件\" class=\"headerlink\" title=\"点击黑块事件\"></a>点击黑块事件</h4><p>让黑块动起来之后呢，我们就来考虑怎么判断用户有没有点击到黑块呢，同时用户若点击到黑块，我们要让所在那一行消失，那么我们需要一个 <code>judge</code> 方法，具体如下：</p>\n<figure class=\"highlight javascript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 判断是否点击黑块、白块</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">judge</span>(<span class=\"params\">ev</span>) {</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'black'</span>) == -<span class=\"number\">1</span> &amp;&amp;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'cell'</span>) !== -<span class=\"number\">1</span></span><br><span class=\"line\">  ) {</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass1</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表示此行row的白块已经被点击</span></span><br><span class=\"line\">  }</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'black'</span>) !== -<span class=\"number\">1</span>) {</span><br><span class=\"line\">    <span class=\"comment\">//点击目标元素 类名中包含 black 说明是黑块</span></span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span> = <span class=\"string\">'cell'</span>;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表明此行row的黑块已经被点击</span></span><br><span class=\"line\">    <span class=\"title function_\">score</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n<p>其实程序写到这里，几个核心的功能点都已经实现了，是不是感觉很简单呢。剩下来的就是将这些方法组合起来，组成完整的逻辑关系，在我给出的源码里添加有一个记分器记录用户分数的功能，同时设置加速方法，使黑块的移动越来越快等等。有兴趣的的同学可以尝试着添加事件按钮，使这个游戏更接近 APP 版本。</p>\n<h4 id=\"js-完整代码\"><a href=\"#js-完整代码\" class=\"headerlink\" title=\"js 完整代码\"></a>js 完整代码</h4><figure class=\"highlight javascript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 工具封装</span></span><br><span class=\"line\"><span class=\"comment\">// 根据id来获取元素</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">$</span>(<span class=\"params\">id</span>) {</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id);</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建div, className是其类名</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatediv</span>(<span class=\"params\">className</span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> div = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">'div'</span>);</span><br><span class=\"line\">  div.<span class=\"property\">className</span> = className;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> div;</span><br><span class=\"line\">}</span><br><span class=\"line\"><span class=\"keyword\">var</span> clock = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> state = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> speed = <span class=\"number\">6</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//点击开始游戏按钮 开始游戏</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">start</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!flag) {</span><br><span class=\"line\">    <span class=\"title function_\">init</span>();</span><br><span class=\"line\">  } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">'游戏已经开始，无须再次点击！'</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *    初始化 init</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">init</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) {</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 添加onclick事件</span></span><br><span class=\"line\">  $(<span class=\"string\">'main'</span>).<span class=\"property\">onclick</span> = <span class=\"keyword\">function</span> (<span class=\"params\">ev</span>) {</span><br><span class=\"line\">    ev = ev || event;</span><br><span class=\"line\">    <span class=\"title function_\">judge</span>(ev);</span><br><span class=\"line\">  };</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 定时器 每30毫秒调用一次move()</span></span><br><span class=\"line\">  clock = <span class=\"variable language_\">window</span>.<span class=\"built_in\">setInterval</span>(<span class=\"string\">'move()'</span>, <span class=\"number\">30</span>);</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断是否点击黑块、白块</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">judge</span>(<span class=\"params\">ev</span>) {</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'black'</span>) == -<span class=\"number\">1</span> &amp;&amp;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'cell'</span>) !== -<span class=\"number\">1</span></span><br><span class=\"line\">  ) {</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass1</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表示此行row的白块已经被点击</span></span><br><span class=\"line\">  }</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">'black'</span>) !== -<span class=\"number\">1</span>) {</span><br><span class=\"line\">    <span class=\"comment\">//点击目标元素 类名中包含 black 说明是黑块</span></span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span> = <span class=\"string\">'cell'</span>;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表明此行row的黑块已经被点击</span></span><br><span class=\"line\">    <span class=\"title function_\">score</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断游戏是否结束</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">over</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> rows = con.<span class=\"property\">childNodes</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (rows.<span class=\"property\">length</span> == <span class=\"number\">5</span> &amp;&amp; rows[rows.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">pass</span> !== <span class=\"number\">1</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; rows.<span class=\"property\">length</span>; i++) {</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rows[i].<span class=\"property\">pass1</span> == <span class=\"number\">1</span>) {</span><br><span class=\"line\">      <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">    }</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 游戏结束</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fail</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"built_in\">clearInterval</span>(clock);</span><br><span class=\"line\">  flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"title function_\">confirm</span>(<span class=\"string\">'你的最终得分为 '</span> + <span class=\"built_in\">parseInt</span>($(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span>));</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  con.<span class=\"property\">innerHTML</span> = <span class=\"string\">''</span>;</span><br><span class=\"line\">  $(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">'-408px'</span>;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创造一个&lt;div class=\"row\"&gt;并且有四个子节点&lt;div class=\"cell\"&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createrow</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> row = <span class=\"title function_\">creatediv</span>(<span class=\"string\">'row'</span>); <span class=\"comment\">//创建div className=row</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> arr = <span class=\"title function_\">creatcell</span>(); <span class=\"comment\">//定义div cell的类名,其中一个为cell black</span></span><br><span class=\"line\"></span><br><span class=\"line\">  con.<span class=\"title function_\">appendChild</span>(row); <span class=\"comment\">// 添加row为con的子节点</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) {</span><br><span class=\"line\">    row.<span class=\"title function_\">appendChild</span>(<span class=\"title function_\">creatediv</span>(arr[i])); <span class=\"comment\">//添加row的子节点 cell</span></span><br><span class=\"line\">  }</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">firstChild</span> == <span class=\"literal\">null</span>) {</span><br><span class=\"line\">    con.<span class=\"title function_\">appendChild</span>(row);</span><br><span class=\"line\">  } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">    con.<span class=\"title function_\">insertBefore</span>(row, con.<span class=\"property\">firstChild</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatcell</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> temp = [<span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>, <span class=\"string\">'cell'</span>];</span><br><span class=\"line\">  <span class=\"keyword\">var</span> i = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">4</span>); <span class=\"comment\">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span></span><br><span class=\"line\">  temp[i] = <span class=\"string\">'cell black'</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//让黑块动起来</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">move</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> top = <span class=\"built_in\">parseInt</span>(<span class=\"variable language_\">window</span>.<span class=\"title function_\">getComputedStyle</span>(con, <span class=\"literal\">null</span>)[<span class=\"string\">'top'</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed + top &gt; <span class=\"number\">0</span>) {</span><br><span class=\"line\">    top = <span class=\"number\">0</span>;</span><br><span class=\"line\">  } <span class=\"keyword\">else</span> {</span><br><span class=\"line\">    top += speed;</span><br><span class=\"line\">  }</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = top + <span class=\"string\">'px'</span>; <span class=\"comment\">//不断移动top值，使它动起来</span></span><br><span class=\"line\">  <span class=\"title function_\">over</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (top == <span class=\"number\">0</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">    con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">'-102px'</span>;</span><br><span class=\"line\">    <span class=\"title function_\">delrow</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 加速函数</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">speedup</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  speed += <span class=\"number\">2</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed == <span class=\"number\">20</span>) {</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">'你超神了'</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//删除某行</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">delrow</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">'con'</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">childNodes</span>.<span class=\"property\">length</span> == <span class=\"number\">6</span>) {</span><br><span class=\"line\">    con.<span class=\"title function_\">removeChild</span>(con.<span class=\"property\">lastChild</span>);</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 记分</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">score</span>(<span class=\"params\"></span>) {</span><br><span class=\"line\">  <span class=\"keyword\">var</span> newscore = <span class=\"built_in\">parseInt</span>($(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span>) + <span class=\"number\">1</span>; <span class=\"comment\">//分数加一</span></span><br><span class=\"line\">  $(<span class=\"string\">'score'</span>).<span class=\"property\">innerHTML</span> = newscore; <span class=\"comment\">//修改分数</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (newscore % <span class=\"number\">10</span> == <span class=\"number\">0</span>) {</span><br><span class=\"line\">    <span class=\"comment\">//当分数是10 的倍数时使用加速函数，越来越快</span></span><br><span class=\"line\">    <span class=\"title function_\">speedup</span>();</span><br><span class=\"line\">  }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n\n\n\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>仅仅一百多行代码我们就实现了一个简单有趣的 Web 小游戏。如果你刚入门前端，相信本项目可以很好的让你理解，练习如何使用 JavaScript 操作 DOM.</p>\n","more":"<h1 id=\"内容介绍\"><a href=\"#内容介绍\" class=\"headerlink\" title=\"内容介绍\"></a>内容介绍</h1><h4 id=\"1-简介\"><a href=\"#1-简介\" class=\"headerlink\" title=\"1.简介\"></a>1.简介</h4><p>别踩白块这个游戏相信很多人都在手机上玩过，今天我们就来做一个网页版的，先上一张游戏效果图：</p>\n<p><img src=\"/cn/posts/59750/uid1133717-20191017-1571294959274.gif\" alt=\"图片描述\"></p>\n<p>属于简化版别踩白块，代码相对较为简单易学，主要涉及通过 javascript 操作元素节点的增删以及属性节点（class）的操作。</p>\n<h4 id=\"2-知识点\"><a href=\"#2-知识点\" class=\"headerlink\" title=\"2.知识点\"></a>2.知识点</h4><ul>\n<li>HTML/CSS</li>\n<li>JavaScript</li>\n<li>元素节点增删</li>\n<li>属性节点操作</li>\n</ul>\n<h4 id=\"3-项目架构\"><a href=\"#3-项目架构\" class=\"headerlink\" title=\"3.项目架构\"></a>3.项目架构</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">puzzle</span><br><span class=\"line\">   |index.html</span><br><span class=\"line\">   |css/index.css</span><br><span class=\"line\">   |js/index.js</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"项目原理\"><a href=\"#项目原理\" class=\"headerlink\" title=\"项目原理\"></a>项目原理</h1><p>在开始编程之前，让我们先来分析下整个游戏的流程：一定的速度下移，点击黑块，黑块消失，新的黑块出现在普通游戏玩家眼中，应该是游戏开始，黑块不断向下移动，若黑块触底则游戏结束；</p>\n<p>而以开发者来说，<strong>应将每一个黑块和白块抽象成一个个的数据结构，黑块的消失和出现其实就是数据结构的创造和销毁</strong>，我们来看一张游戏的流程图，对于要编写的功能有一个大概的了解:</p>\n<p><img src=\"/cn/posts/59750/image-20201105153016423.png\" alt=\"image-20201105153016423\"></p>\n<h1 id=\"实现步骤\"><a href=\"#实现步骤\" class=\"headerlink\" title=\"实现步骤\"></a>实现步骤</h1><h4 id=\"页面布局\"><a href=\"#页面布局\" class=\"headerlink\" title=\"页面布局\"></a>页面布局</h4><p>可以用 div+css 布局来实现别踩白块的静态效果展示，直接上 HTML 代码，我来简要说下 HTML 思路，将主界面分解成一个 4x4 的大矩形格子，每一个方块代表其中一个小的矩形格，其中每一行的四个白块中有一个黑块，每一行中黑块位于哪一列是随机生成的，但是我们这里现在是静态页面就自己确定了，然后通过 css 控制样式。</p>\n<p>创建 index.html 文件，并输入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>别踩白块<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;css/index.css&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;main&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;con&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;row&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          /*白块*/</span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell black&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          /*黑块*/</span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;row&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell black&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;row&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell black&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;row&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell black&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;cell&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;js/index.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"添加样式\"><a href=\"#添加样式\" class=\"headerlink\" title=\"添加样式\"></a>添加样式</h4><p>下面是 css 代码，这里有一个要注意的地方，我将 <code>div#con</code> 块级元素向上提了 100 px，这样在游戏的开始就出现了最底一行的空白，隐藏最上面那行，为什么要这样呢，继续往下看就知道了。设置黑白块的样式，为 js 部分动态插入黑白块做准备。</p>\n<p>创建 <code>css/index.css</code> 文件，并输入以下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#main</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">408px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">408px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">2px</span> solid gray;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">overflow</span>: hidden;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">h2</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#con</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">400px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: -<span class=\"number\">408px</span>; <span class=\"comment\">/*隐藏所有格子*/</span></span><br><span class=\"line\">  <span class=\"attribute\">border-collapse</span>: collapse;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 行 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.row</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">/* 一个块 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.cell</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">float</span>: left;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">54</span>, <span class=\"number\">74</span>, <span class=\"number\">129</span>) <span class=\"number\">1px</span> solid;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.black</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: black;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.btn</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.start</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">20px</span> auto;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">150px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">height</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: yellowgreen;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">50px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>如果以上部分你都能够理解并且对应着代码实现的话，那么我们看到的应该是一个空格子，我们设置 id 为 con 的 div 的 top 属性为 0 px: <code>#con &#123;top: 0px;&#125;</code>，这样我们就可以看见：</p>\n<p><img src=\"/cn/posts/59750/uid1133717-20191017-1571294959274.gif\" alt=\"图片描述\"></p>\n<p>是不是很像别踩白块的界面了呢，我们已经成功了一大步，然后就是通过 js 来实现动态的插入黑块或白块，以及操作。</p>\n<h4 id=\"游戏初始化\"><a href=\"#游戏初始化\" class=\"headerlink\" title=\"游戏初始化\"></a>游戏初始化</h4><p>根据前面的 HTML 部分我们可以知道，每个 <code>&lt;div class=&quot;cell&quot;&gt;</code> 就代表一个白块，<code>&lt;div class=&quot;cell black&quot;&gt;</code> 就代表一个黑块，每点击一个黑块消失其实是删除了一个 <code>&lt;div class=&quot;row&quot;&gt;</code> 然后从上面添加一个新的 <code>&lt;div class=&quot;row&quot;&gt;</code> 所以我们首先要通过 js 来控制 <code>&lt;div class=&quot;row&quot;&gt;</code> 的创造和生成（记得删除在编写静态页面时候指定生成的 4 个 <code>div.row</code>）。具体方法如下：</p>\n<p>删除之前写的 4 个 div.row，将 index.html 文件改为以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>别踩白块<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;css/index.css&quot;</span> /&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span>&gt;</span>score<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h2</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;score&quot;</span>&gt;</span>0<span class=\"tag\">&lt;/<span class=\"name\">h2</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;main&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;con&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;btn&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;start&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;start()&quot;</span>&gt;</span></span><br><span class=\"line\">        开始游戏</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;js/index.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>对游戏进行初始化，在 <code>js/index.js</code> 文件中写入以下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建div, className是其类名</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatediv</span>(<span class=\"params\">className</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> div = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;div&#x27;</span>);</span><br><span class=\"line\">  div.<span class=\"property\">className</span> = className;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> div;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创造一个&lt;div class=&quot;row&quot;&gt;并且有四个子节点&lt;div class=&quot;cell&quot;&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createrow</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> row = <span class=\"title function_\">creatediv</span>(<span class=\"string\">&#x27;row&#x27;</span>); <span class=\"comment\">//创建div className=row</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> arr = <span class=\"title function_\">creatcell</span>(); <span class=\"comment\">//定义div cell的类名,其中一个为cell black</span></span><br><span class=\"line\"></span><br><span class=\"line\">  con.<span class=\"title function_\">appendChild</span>(row); <span class=\"comment\">// 添加row为con的子节点</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) &#123;</span><br><span class=\"line\">    row.<span class=\"title function_\">appendChild</span>(<span class=\"title function_\">creatediv</span>(arr[i])); <span class=\"comment\">//添加row的子节点 cell</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">firstChild</span> == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">appendChild</span>(row);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">insertBefore</span>(row, con.<span class=\"property\">firstChild</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//删除div#con的子节点中最后那个&lt;div class=&quot;row&quot;&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">delrow</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">childNodes</span>.<span class=\"property\">length</span> == <span class=\"number\">6</span>) &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">removeChild</span>(con.<span class=\"property\">lastChild</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatcell</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> temp = [<span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>];</span><br><span class=\"line\">  <span class=\"keyword\">var</span> i = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">4</span>); <span class=\"comment\">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span></span><br><span class=\"line\">  temp[i] = <span class=\"string\">&#x27;cell black&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"让黑块动起来\"><a href=\"#让黑块动起来\" class=\"headerlink\" title=\"让黑块动起来\"></a>让黑块动起来</h4><p>在可以通过 js 来创造和销毁 <code>div</code> 后，我们就要让黑块动起来，这个时候我们就用到了之前 css 提到的设定 <code>&lt;div id=&quot;con&quot;&gt;</code> 隐藏了一行的 <code>&lt;div id=&quot;row&quot;&gt;</code>，我们通过 js 的 DOM 操作使其向下方移动，并设置定时器每 30 毫秒移动一次，这样就实现了黑块的平滑移动，在黑块移动的同时，我们要判断黑块是否已经触底，触底则游戏失败，停止调用 <code>move()</code>，触底后调用函数 <code>fail()</code> 游戏失败，具体方法如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//让黑块动起来</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">move</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> top = <span class=\"built_in\">parseInt</span>(<span class=\"variable language_\">window</span>.<span class=\"title function_\">getComputedStyle</span>(con, <span class=\"literal\">null</span>)[<span class=\"string\">&#x27;top&#x27;</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed + top &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    top = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    top += speed;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = top + <span class=\"string\">&#x27;px&#x27;</span>; <span class=\"comment\">//不断移动top值，使它动起来</span></span><br><span class=\"line\">  <span class=\"title function_\">over</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (top == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">    con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;-102px&#x27;</span>;</span><br><span class=\"line\">    <span class=\"title function_\">delrow</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 加速函数</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">speedup</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  speed += <span class=\"number\">2</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed == <span class=\"number\">20</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;你超神了&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断游戏是否结束</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">over</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> rows = con.<span class=\"property\">childNodes</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (rows.<span class=\"property\">length</span> == <span class=\"number\">5</span> &amp;&amp; rows[rows.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">pass</span> !== <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; rows.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rows[i].<span class=\"property\">pass1</span> == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 游戏结束</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fail</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"built_in\">clearInterval</span>(clock);</span><br><span class=\"line\">  flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"title function_\">confirm</span>(<span class=\"string\">&#x27;你的最终得分为 &#x27;</span> + <span class=\"built_in\">parseInt</span>($(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span>));</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  con.<span class=\"property\">innerHTML</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">  $(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;-408px&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"点击黑块事件\"><a href=\"#点击黑块事件\" class=\"headerlink\" title=\"点击黑块事件\"></a>点击黑块事件</h4><p>让黑块动起来之后呢，我们就来考虑怎么判断用户有没有点击到黑块呢，同时用户若点击到黑块，我们要让所在那一行消失，那么我们需要一个 <code>judge</code> 方法，具体如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 判断是否点击黑块、白块</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">judge</span>(<span class=\"params\">ev</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;black&#x27;</span>) == -<span class=\"number\">1</span> &amp;&amp;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;cell&#x27;</span>) !== -<span class=\"number\">1</span></span><br><span class=\"line\">  ) &#123;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass1</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表示此行row的白块已经被点击</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;black&#x27;</span>) !== -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//点击目标元素 类名中包含 black 说明是黑块</span></span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span> = <span class=\"string\">&#x27;cell&#x27;</span>;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表明此行row的黑块已经被点击</span></span><br><span class=\"line\">    <span class=\"title function_\">score</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其实程序写到这里，几个核心的功能点都已经实现了，是不是感觉很简单呢。剩下来的就是将这些方法组合起来，组成完整的逻辑关系，在我给出的源码里添加有一个记分器记录用户分数的功能，同时设置加速方法，使黑块的移动越来越快等等。有兴趣的的同学可以尝试着添加事件按钮，使这个游戏更接近 APP 版本。</p>\n<h4 id=\"js-完整代码\"><a href=\"#js-完整代码\" class=\"headerlink\" title=\"js 完整代码\"></a>js 完整代码</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 工具封装</span></span><br><span class=\"line\"><span class=\"comment\">// 根据id来获取元素</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">$</span>(<span class=\"params\">id</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建div, className是其类名</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatediv</span>(<span class=\"params\">className</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> div = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;div&#x27;</span>);</span><br><span class=\"line\">  div.<span class=\"property\">className</span> = className;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> div;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">var</span> clock = <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> state = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> speed = <span class=\"number\">6</span>;</span><br><span class=\"line\"><span class=\"keyword\">var</span> flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//点击开始游戏按钮 开始游戏</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">start</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!flag) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">init</span>();</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;游戏已经开始，无须再次点击！&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *    初始化 init</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">init</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  flag = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 添加onclick事件</span></span><br><span class=\"line\">  $(<span class=\"string\">&#x27;main&#x27;</span>).<span class=\"property\">onclick</span> = <span class=\"keyword\">function</span> (<span class=\"params\">ev</span>) &#123;</span><br><span class=\"line\">    ev = ev || event;</span><br><span class=\"line\">    <span class=\"title function_\">judge</span>(ev);</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 定时器 每30毫秒调用一次move()</span></span><br><span class=\"line\">  clock = <span class=\"variable language_\">window</span>.<span class=\"built_in\">setInterval</span>(<span class=\"string\">&#x27;move()&#x27;</span>, <span class=\"number\">30</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断是否点击黑块、白块</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">judge</span>(<span class=\"params\">ev</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;black&#x27;</span>) == -<span class=\"number\">1</span> &amp;&amp;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;cell&#x27;</span>) !== -<span class=\"number\">1</span></span><br><span class=\"line\">  ) &#123;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass1</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表示此行row的白块已经被点击</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (ev.<span class=\"property\">target</span>.<span class=\"property\">className</span>.<span class=\"title function_\">indexOf</span>(<span class=\"string\">&#x27;black&#x27;</span>) !== -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//点击目标元素 类名中包含 black 说明是黑块</span></span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">className</span> = <span class=\"string\">&#x27;cell&#x27;</span>;</span><br><span class=\"line\">    ev.<span class=\"property\">target</span>.<span class=\"property\">parentNode</span>.<span class=\"property\">pass</span> = <span class=\"number\">1</span>; <span class=\"comment\">//定义属性pass，表明此行row的黑块已经被点击</span></span><br><span class=\"line\">    <span class=\"title function_\">score</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 判断游戏是否结束</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">over</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> rows = con.<span class=\"property\">childNodes</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (rows.<span class=\"property\">length</span> == <span class=\"number\">5</span> &amp;&amp; rows[rows.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">pass</span> !== <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; rows.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rows[i].<span class=\"property\">pass1</span> == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fail</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 游戏结束</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fail</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"built_in\">clearInterval</span>(clock);</span><br><span class=\"line\">  flag = <span class=\"literal\">false</span>;</span><br><span class=\"line\">  <span class=\"title function_\">confirm</span>(<span class=\"string\">&#x27;你的最终得分为 &#x27;</span> + <span class=\"built_in\">parseInt</span>($(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span>));</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  con.<span class=\"property\">innerHTML</span> = <span class=\"string\">&#x27;&#x27;</span>;</span><br><span class=\"line\">  $(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;-408px&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创造一个&lt;div class=&quot;row&quot;&gt;并且有四个子节点&lt;div class=&quot;cell&quot;&gt;</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createrow</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> row = <span class=\"title function_\">creatediv</span>(<span class=\"string\">&#x27;row&#x27;</span>); <span class=\"comment\">//创建div className=row</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> arr = <span class=\"title function_\">creatcell</span>(); <span class=\"comment\">//定义div cell的类名,其中一个为cell black</span></span><br><span class=\"line\"></span><br><span class=\"line\">  con.<span class=\"title function_\">appendChild</span>(row); <span class=\"comment\">// 添加row为con的子节点</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">4</span>; i++) &#123;</span><br><span class=\"line\">    row.<span class=\"title function_\">appendChild</span>(<span class=\"title function_\">creatediv</span>(arr[i])); <span class=\"comment\">//添加row的子节点 cell</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">firstChild</span> == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">appendChild</span>(row);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">insertBefore</span>(row, con.<span class=\"property\">firstChild</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建一个类名的数组，其中一个为cell black, 其余为cell</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">creatcell</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> temp = [<span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>, <span class=\"string\">&#x27;cell&#x27;</span>];</span><br><span class=\"line\">  <span class=\"keyword\">var</span> i = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">4</span>); <span class=\"comment\">//随机产生黑块的位置 Math.random()函数参数 0~1的随机数</span></span><br><span class=\"line\">  temp[i] = <span class=\"string\">&#x27;cell black&#x27;</span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//让黑块动起来</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">move</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">var</span> top = <span class=\"built_in\">parseInt</span>(<span class=\"variable language_\">window</span>.<span class=\"title function_\">getComputedStyle</span>(con, <span class=\"literal\">null</span>)[<span class=\"string\">&#x27;top&#x27;</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed + top &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    top = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    top += speed;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = top + <span class=\"string\">&#x27;px&#x27;</span>; <span class=\"comment\">//不断移动top值，使它动起来</span></span><br><span class=\"line\">  <span class=\"title function_\">over</span>();</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (top == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">createrow</span>();</span><br><span class=\"line\">    con.<span class=\"property\">style</span>.<span class=\"property\">top</span> = <span class=\"string\">&#x27;-102px&#x27;</span>;</span><br><span class=\"line\">    <span class=\"title function_\">delrow</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 加速函数</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">speedup</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  speed += <span class=\"number\">2</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (speed == <span class=\"number\">20</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">alert</span>(<span class=\"string\">&#x27;你超神了&#x27;</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//删除某行</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">delrow</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> con = $(<span class=\"string\">&#x27;con&#x27;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (con.<span class=\"property\">childNodes</span>.<span class=\"property\">length</span> == <span class=\"number\">6</span>) &#123;</span><br><span class=\"line\">    con.<span class=\"title function_\">removeChild</span>(con.<span class=\"property\">lastChild</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 记分</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">score</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> newscore = <span class=\"built_in\">parseInt</span>($(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span>) + <span class=\"number\">1</span>; <span class=\"comment\">//分数加一</span></span><br><span class=\"line\">  $(<span class=\"string\">&#x27;score&#x27;</span>).<span class=\"property\">innerHTML</span> = newscore; <span class=\"comment\">//修改分数</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (newscore % <span class=\"number\">10</span> == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">//当分数是10 的倍数时使用加速函数，越来越快</span></span><br><span class=\"line\">    <span class=\"title function_\">speedup</span>();</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h1><p>仅仅一百多行代码我们就实现了一个简单有趣的 Web 小游戏。如果你刚入门前端，相信本项目可以很好的让你理解，练习如何使用 JavaScript 操作 DOM.</p>\n","categories":[],"tags":[{"name":"前端","path":"api/tags/前端.json"}]}