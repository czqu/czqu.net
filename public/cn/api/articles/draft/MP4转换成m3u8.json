{"title":"利用ffmpeg将MP4转换成m3u8格式的视频切片","slug":"draft/MP4转换成m3u8","date":"2021-09-30T01:25:00.000Z","updated":"2021-09-30T01:25:00.000Z","comments":true,"path":"api/articles/draft/MP4转换成m3u8.json","excerpt":"1.获取ffmpeg打开这里下载 2.视频切片第一步：mp4转成ts格式，一对一转换，转换后大小没什么变化。 1ffmpeg -y -i 迪迦奥特曼.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb 迪迦奥特曼.ts 第二步，按间隔分片，1对N，下面的5即“每个分片5秒”，可以自己切换。 1ffmpeg -i 迪迦奥特曼.ts -c copy -map 0 -f segment -segment_list playlist.m3u8 -segment_time 5 迪迦奥特曼%03d.ts 关于MP4的参数，务必满足视频编码为H264，音视频编码为AAC（YouTube下载的视频默认即此格式），如果不是请用格式工厂进行转换 3.完成把中间生成的ts文件清理 推荐使用DPlayer进行视频播放","covers":null,"content":"<h4 id=\"1-获取ffmpeg\"><a href=\"#1-获取ffmpeg\" class=\"headerlink\" title=\"1.获取ffmpeg\"></a>1.获取ffmpeg</h4><p><a href=\"https://ffmpeg.org/download.html\">打开这里下载</a></p>\n<h4 id=\"2-视频切片\"><a href=\"#2-视频切片\" class=\"headerlink\" title=\"2.视频切片\"></a>2.视频切片</h4><p>第一步：mp4转成ts格式，一对一转换，转换后大小没什么变化。</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -y -i 迪迦奥特曼.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb 迪迦奥特曼.ts</span><br></pre></td></tr></tbody></table></figure>\n\n<p>第二步，按间隔分片，1对N，下面的5即“每个分片5秒”，可以自己切换。</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -i 迪迦奥特曼.ts -c copy -map 0 -f segment -segment_list playlist.m3u8 -segment_time 5 迪迦奥特曼%03d.ts</span><br></pre></td></tr></tbody></table></figure>\n\n<p><strong>关于MP4的参数，务必满足视频编码为H264，音视频编码为AAC（YouTube下载的视频默认即此格式），如果不是请用格式工厂进行转换</strong></p>\n<h4 id=\"3-完成\"><a href=\"#3-完成\" class=\"headerlink\" title=\"3.完成\"></a>3.完成</h4><p>把中间生成的ts文件清理</p>\n<blockquote>\n<p>推荐使用<a href=\"https://dplayer.js.org/\">DPlayer</a>进行视频播放</p>\n</blockquote>\n","more":"<h4 id=\"1-获取ffmpeg\"><a href=\"#1-获取ffmpeg\" class=\"headerlink\" title=\"1.获取ffmpeg\"></a>1.获取ffmpeg</h4><p><a href=\"https://ffmpeg.org/download.html\">打开这里下载</a></p>\n<h4 id=\"2-视频切片\"><a href=\"#2-视频切片\" class=\"headerlink\" title=\"2.视频切片\"></a>2.视频切片</h4><p>第一步：mp4转成ts格式，一对一转换，转换后大小没什么变化。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -y -i 迪迦奥特曼.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb 迪迦奥特曼.ts</span><br></pre></td></tr></table></figure>\n\n<p>第二步，按间隔分片，1对N，下面的5即“每个分片5秒”，可以自己切换。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -i 迪迦奥特曼.ts -c copy -map 0 -f segment -segment_list playlist.m3u8 -segment_time 5 迪迦奥特曼%03d.ts</span><br></pre></td></tr></table></figure>\n\n<p><strong>关于MP4的参数，务必满足视频编码为H264，音视频编码为AAC（YouTube下载的视频默认即此格式），如果不是请用格式工厂进行转换</strong></p>\n<h4 id=\"3-完成\"><a href=\"#3-完成\" class=\"headerlink\" title=\"3.完成\"></a>3.完成</h4><p>把中间生成的ts文件清理</p>\n<blockquote>\n<p>推荐使用<a href=\"https://dplayer.js.org/\">DPlayer</a>进行视频播放</p>\n</blockquote>\n","categories":[],"tags":[{"name":"ffmpeg","path":"api/tags/ffmpeg.json"}]}