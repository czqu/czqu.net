<?xml version="1.0" ?>
  <search>
    <entry>
      
      
      <title>RemoteFingerUnlock API Documentation</title>
      
      
      <link href="/posts/2167915263/"/>
      
      
      <url>/posts/2167915263/</url>
      
      
        
      <content type="html"><![CDATA[<h1 id="Remote-Unlock-API-Documentation"><a href="#Remote-Unlock-API-Documentation" class="headerlink" title="Remote Unlock  API Documentation"></a>Remote Unlock  API Documentation</h1><p><strong>Version:</strong> 1.0</p><p>This document is the official API reference for the Remote Unlock Module. It provides detailed information for all available endpoints, including authentication methods, request parameters, and expected response formats.</p><ul><li><strong>Terms of Service:</strong> <a href="https://rfu.czqu.net/">https://rfu.czqu.net</a></li></ul><h2 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a><strong>Disclaimer</strong></h2><p>The information provided by this [Website/Document/Service/Product] (hereinafter “the Service”) is for general informational purposes only. All information is provided in good faith, however, we make no representation or warranty of any kind, express or implied, regarding the accuracy, adequacy, validity, reliability, availability, or completeness of any information on the Service.</p><p>Under no circumstance shall we have any liability to you for any loss or damage of any kind incurred as a result of the use of the Service or reliance on any information provided on the Service. Your use of the Service and your reliance on any information on the Service is solely at your own risk.</p><p>The Service may contain (or you may be sent through the Service) links to other websites or content belonging to or originating from third parties. Such external links are not investigated, monitored, or checked for accuracy, adequacy, validity, reliability, availability, or completeness by us.</p><p>The content provided by this Service does not constitute professional advice of any kind (including but not limited to legal, financial, medical, or other professional advice). All content is for informational purposes only. Before taking any action based upon such information, we strongly encourage you to consult with the appropriate professionals. We do not provide any kind of professional advice.</p><hr><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Base-URL"><a href="#Base-URL" class="headerlink" title="Base URL"></a>Base URL</h3><p>The base URL for all API requests is as follows:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:2091/api/v1</span><br></pre></td></tr></tbody></table></figure><h3 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h3><p>Most endpoints in this API require authentication via an API key. Please include the <code>Authorization</code> field in the HTTP request header.</p><ul><li><strong>Type:</strong> <code>apiKey</code></li><li><strong>Header Field Name:</strong> <code>Authorization</code></li><li><strong>Format:</strong> <code>Authorization: Bearer &lt;YOUR_API_KEY&gt;</code></li></ul><blockquote><p><strong>Note:</strong> <code>&lt;YOUR_API_KEY&gt;</code> needs to be replaced with the actual authentication token you obtained upon login or from the system configuration. All endpoints that require authentication must carry this header, otherwise, a <code>401 Unauthorized</code> error will be returned.</p></blockquote><h3 id="Common-Response-Format"><a href="#Common-Response-Format" class="headerlink" title="Common Response Format"></a>Common Response Format</h3><p>All API responses follow a unified data structure to facilitate standardized client-side processing.</p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"code"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"msg"</span><span class="punctuation">:</span> <span class="string">"success"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"data"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"request_id"</span><span class="punctuation">:</span> <span class="string">"unique-request-id-string"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><code>code</code>: A status code. <code>0</code> usually indicates success, while other non-zero values represent different types of errors.</li><li><code>msg</code>: A brief description of the response, such as “success” or a specific error message.</li><li><code>data</code>: The actual data payload returned, which can be an object, an array, or null.</li><li><code>request_id</code>: A unique identifier for this request, which can be used for troubleshooting.</li></ul><hr><h2 id="API-Endpoint-Details"><a href="#API-Endpoint-Details" class="headerlink" title="API Endpoint Details"></a>API Endpoint Details</h2><h3 id="PC-Control"><a href="#PC-Control" class="headerlink" title="PC Control"></a>PC Control</h3><h4 id="POST-control-pc-action"><a href="#POST-control-pc-action" class="headerlink" title="POST /control-pc/{action}/"></a><code>POST /control-pc/{action}/</code></h4><p>Controls the computer to perform a specified action, such as shutdown, standby, or lock.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li><li><strong>Description:</strong> Controls the computer based on the <code>action</code> parameter. The <code>shutdown</code> and <code>standby</code> actions can also include a delay time.</li></ul><p><strong>Path Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Enum Values</th><th>Description</th></tr></thead><tbody><tr><td><code>action</code></td><td>string</td><td>Yes</td><td><code>shutdown</code>, <code>standby</code>, <code>lock</code></td><td>The type of action to perform. Respectively: shutdown, standby, lock.</td></tr></tbody></table><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>delay</code></td><td>string</td><td>Yes</td><td>The delay time in seconds before execution. Only valid when <code>action</code> is <code>shutdown</code> or <code>standby</code>.</td></tr><tr><td><code>shutdown_type</code></td><td>string</td><td>No</td><td>The type of shutdown. Only effective when <code>action=shutdown</code>. For example, it can be specified as “force” or “hybrid” (see below for available values).</td></tr></tbody></table><table><thead><tr><th>shutdown_type</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td>No operation</td></tr><tr><td><strong>General</strong></td><td></td></tr><tr><td>1</td><td>Log off the current user</td></tr><tr><td>2</td><td>Force close all applications and shut down</td></tr><tr><td>3</td><td>Force close all applications and restart</td></tr><tr><td><strong>Windows Only</strong></td><td></td></tr><tr><td>4</td><td>Shut down but do not power off</td></tr><tr><td>5</td><td>Restart the computer</td></tr><tr><td>6</td><td>Force close all applications</td></tr><tr><td>7</td><td>Shut down and power off</td></tr><tr><td>8</td><td>Restart applications</td></tr><tr><td>9</td><td>Hybrid shutdown</td></tr><tr><td>10</td><td>Force close applications, shut down, and power off</td></tr><tr><td>11</td><td>Restart the computer and restart applications</td></tr><tr><td>12</td><td>Force close applications, restart, and restart applications</td></tr><tr><td>13</td><td>Shut down without powering off, then restart applications after shutdown</td></tr><tr><td>14</td><td>Hybrid shutdown and force close applications</td></tr><tr><td>15</td><td>Hybrid shutdown and restart applications</td></tr><tr><td>16</td><td>Hybrid shutdown, force close applications, and restart applications</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: The command was sent successfully.</li><li><code>400 Bad Request</code>: Invalid action type (<code>action</code> is not in the enum list).</li><li><code>500 Internal Server Error</code>: Failed to execute the action, possibly due to insufficient permissions or other system errors.</li></ul><hr><h3 id="System"><a href="#System" class="headerlink" title="System"></a>System</h3><h4 id="GET-info"><a href="#GET-info" class="headerlink" title="GET /info"></a><code>GET /info</code></h4><p>Gets basic information about the software, such as its version.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li></ul><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved information.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-info-check-update"><a href="#GET-info-check-update" class="headerlink" title="GET /info/check_update"></a><code>GET /info/check_update</code></h4><p>Checks if there are any available updates for the system.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li><li><strong>Description:</strong> Returns details of the latest available update, including the version number, update URL, and release notes.</li></ul><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td><code>lang</code></td><td>string</td><td>No</td><td><code>en</code></td><td>Specifies the language for the update information.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved update information.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-info-language"><a href="#GET-info-language" class="headerlink" title="GET /info/language"></a><code>GET /info/language</code></h4><p>Gets the currently configured system language.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Not Required</li></ul><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved the language setting.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="PATCH-info-language"><a href="#PATCH-info-language" class="headerlink" title="PATCH /info/language"></a><code>PATCH /info/language</code></h4><p>Sets the system language.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Not Required</li></ul><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td><code>lang</code></td><td>string</td><td>No</td><td><code>en</code></td><td>The target language to set.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Language successfully set.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-logs-module"><a href="#GET-logs-module" class="headerlink" title="GET /logs/{module}"></a><code>GET /logs/{module}</code></h4><p>Gets a real-time stream of system logs.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li><li><strong>Description:</strong> This endpoint establishes a long-lived connection to push system logs in real-time. The connection will remain open until closed by the client or an error occurs.</li></ul><p><strong>Path Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>module</code></td><td>string</td><td>Yes</td><td>Specifies which module’s logs to retrieve. In this document, the value must be <code>service</code>.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Starts pushing the log stream (<code>Content-Type: text/event-stream</code>).</li><li><code>400 Bad Request</code>: An invalid module was specified.</li><li><code>500 Internal Server Error</code>: Internal server error, e.g., the log buffer is unavailable.</li></ul><hr><h3 id="Power-Saving"><a href="#Power-Saving" class="headerlink" title="Power Saving"></a>Power Saving</h3><h4 id="POST-power-saving"><a href="#POST-power-saving" class="headerlink" title="POST /power-saving"></a><code>POST /power-saving</code></h4><p>Enables, disables, or sets power-saving mode to auto.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li><li><strong>Description:</strong> This function first writes the setting to the database. If the write is successful, it then applies the setting to the system. The value in the database will be updated even if the system application fails.</li></ul><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Description</th></tr></thead><tbody><tr><td><code>mode</code></td><td>string</td><td>No</td><td><code>auto</code></td><td>Power saving mode. Possible values are <code>enable</code>, <code>disable</code>, or <code>auto</code>.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Power saving mode set successfully.</li><li><code>400 Bad Request</code>: Invalid request parameters.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-power-saving-status"><a href="#GET-power-saving-status" class="headerlink" title="GET /power-saving/status"></a><code>GET /power-saving/status</code></h4><p>Gets the current status of the power-saving mode.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li></ul><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved the power-saving mode status.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><hr><h3 id="Network-Interfaces"><a href="#Network-Interfaces" class="headerlink" title="Network Interfaces"></a>Network Interfaces</h3><h4 id="GET-interface"><a href="#GET-interface" class="headerlink" title="GET /interface"></a><code>GET /interface</code></h4><p>Gets a list of active network interfaces.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li><li><strong>Description:</strong> Returns a list of all active network interfaces on the current device, based on the specified IP version (IPv4 or IPv6).</li></ul><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Default Value</th><th>Enum Values</th><th>Description</th></tr></thead><tbody><tr><td><code>type</code></td><td>string</td><td>No</td><td><code>4</code></td><td><code>4</code>, <code>6</code></td><td>IP protocol version. <code>4</code> for IPv4, <code>6</code> for IPv6.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully returned the list of network interfaces.</li><li><code>400 Bad Request</code>: Incorrect request parameters.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-interface-ip"><a href="#GET-interface-ip" class="headerlink" title="GET /interface/{ip}"></a><code>GET /interface/{ip}</code></h4><p>Gets the MAC address corresponding to an IP address.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li></ul><p><strong>Path Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>ip</code></td><td>string</td><td>Yes</td><td>The IP address to query.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved the MAC address.</li><li><code>400 Bad Request</code>: Invalid request format (e.g., invalid IP address).</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="GET-interface-ip-all"><a href="#GET-interface-ip-all" class="headerlink" title="GET /interface/{ip}/all"></a><code>GET /interface/{ip}/all</code></h4><p>Gets complete interface information for an IP address.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required</li></ul><p><strong>Path Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>ip</code></td><td>string</td><td>Yes</td><td>The IP address to query.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Successfully retrieved interface information.</li><li><code>400 Bad Request</code>: Invalid request format.</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><hr><h3 id="User-Authentication-amp-Operations"><a href="#User-Authentication-amp-Operations" class="headerlink" title="User Authentication &amp; Operations"></a>User Authentication &amp; Operations</h3><h4 id="POST-login"><a href="#POST-login" class="headerlink" title="POST /login"></a><code>POST /login</code></h4><p>User login.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Required (This might refer to basic client authentication to exchange for a longer-lived token)</li><li><strong>Description:</strong> Authenticates using a username and password. On success, it returns a JWT (JSON Web Token) to be used for subsequent authenticated API requests.</li></ul><p><strong>Request Body</strong></p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"your_username"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"your_password"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><strong>Schema:</strong> <code>LoginRequest</code></li></ul><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Authentication successful. The <code>data</code> field of the response will contain the JWT Token.</li><li><code>400 Bad Request</code>: Invalid request parameters (e.g., empty username or password).</li><li><code>500 Internal Server Error</code>: Internal server error.</li></ul><h4 id="POST-unlock"><a href="#POST-unlock" class="headerlink" title="POST /unlock"></a><code>POST /unlock</code></h4><p>Unlock your computer.</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Not Required</li><li><strong>Description:</strong> Sends the computer’s username and password to perform the unlock operation.</li></ul><p><strong>Request Body</strong></p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"your_pc_username"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"your_pc_password"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><strong>Schema:</strong> <code>PcUserInfo</code></li></ul><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Unlock successful.</li><li><code>400 Bad Request</code>: Invalid request format.</li><li><code>500 Internal Server Error</code>: Internal error (e.g., incorrect username or password, unlock failed).</li></ul><hr><h3 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><h4 id="GET-ping"><a href="#GET-ping" class="headerlink" title="GET /ping"></a><code>GET /ping</code></h4><p>Service health check (Ping).</p><ul><li><strong>Authentication:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> Not Required</li><li><strong>Description:</strong> Used to check if the service is running correctly, or the status of specific sub-services (like WebSocket).</li></ul><p><strong>Query Parameters</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Required</th><th>Enum Values</th><th>Description</th></tr></thead><tbody><tr><td><code>type</code></td><td>string</td><td>No</td><td><code>ws</code>, <code>pairing</code></td><td>The type of probe. <code>ws</code> might be for testing the WebSocket service, <code>pairing</code> for the pairing service.</td></tr></tbody></table><p><strong>Responses</strong></p><ul><li><code>200 OK</code>: Service is OK.</li><li><code>500 Internal Server Error</code>: Service is not available.</li></ul><hr><h2 id="Data-Models-Definitions"><a href="#Data-Models-Definitions" class="headerlink" title="Data Models (Definitions)"></a>Data Models (Definitions)</h2><h3 id="LoginRequest"><a href="#LoginRequest" class="headerlink" title="LoginRequest"></a><code>LoginRequest</code></h3><p>The credentials object used for user login.</p><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>username</code></td><td>string</td><td>Yes</td><td>Username</td></tr><tr><td><code>password</code></td><td>string</td><td>Yes</td><td>Password</td></tr></tbody></table><h3 id="PcUserInfo"><a href="#PcUserInfo" class="headerlink" title="PcUserInfo"></a><code>PcUserInfo</code></h3><p>The user information object used to unlock the computer.</p><table><thead><tr><th>Field Name</th><th>Type</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td><code>username</code></td><td>string</td><td>No</td><td>The computer’s username</td></tr><tr><td><code>password</code></td><td>string</td><td>No</td><td>The computer’s login password</td></tr></tbody></table><h3 id="ResponseData"><a href="#ResponseData" class="headerlink" title="ResponseData"></a><code>ResponseData</code></h3><p>The common data structure for all API responses.</p><table><thead><tr><th>Field Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>code</code></td><td>integer</td><td>Business status code, <code>0</code> indicates success</td></tr><tr><td><code>data</code></td><td>object</td><td>The actual returned data</td></tr><tr><td><code>msg</code></td><td>string</td><td>A message providing details</td></tr><tr><td><code>request_id</code></td><td>string</td><td>The unique ID for this request</td></tr></tbody></table>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> RemoteFingerUnlock </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> RemoteFingerUnlock </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>RemoteFingerUnlock FAQ</title>
      
      
      <link href="/posts/31496/"/>
      
      
      <url>/posts/31496/</url>
      
      
        
      <content type="html"><![CDATA[<h3 id="Contact-Us"><a href="#Contact-Us" class="headerlink" title="Contact Us:"></a>Contact Us:</h3><p>Discord:  <a href="https://discord.gg/b5fMzvdmeX">https://discord.gg/b5fMzvdmeX</a> (Recommended)</p><blockquote><p>Or leave your comments and suggestions in the comments section at the end of the article.</p></blockquote><h3 id="Frequently-Asked-Questions"><a href="#Frequently-Asked-Questions" class="headerlink" title="Frequently Asked Questions:"></a>Frequently Asked Questions:</h3><h5 id="1-No-response-on-the-lock-screen-Can’t-connect"><a href="#1-No-response-on-the-lock-screen-Can’t-connect" class="headerlink" title="1. No response on the lock screen? Can’t connect?"></a>1. No response on the lock screen? Can’t connect?</h5><p>The new version does not display the unlock result on the lock screen, but returns it through an API. You can see it when you call the API. The API documentation can be found on the official website.</p><p>The inability to connect may be a firewall issue. You can try to disable the firewall first to troubleshoot. This problem may occur because the creation of a firewall rule was blocked during installation. Please manually add a rule for LogonUI.exe.</p><p>Another possibility is that pairing has been initiated.</p><p>Currently, there is only a LAN version, which listens on all IPs and supports IPV6, but it is not recommended to expose it directly to the public network.</p><h5 id="2-The-lock-screen-prompts-that-the-username-or-password-is-incorrect"><a href="#2-The-lock-screen-prompts-that-the-username-or-password-is-incorrect" class="headerlink" title="2. The lock screen prompts that the username or password is incorrect"></a>2. The lock screen prompts that the username or password is incorrect</h5><ol><li><p>Please check that you are entering your password and not your <strong>pin</strong>.</p></li><li><p>If you have changed your Microsoft account password, it may be because the local password and the online password are not synchronized.</p></li></ol><blockquote><p>It is recommended that you refer to the following steps:</p><p>Solution 1: Directly re-bind your Microsoft account and local account.</p><p>Solution 2:</p><ol><li><p>Press the Windows logo + R key combination to bring up the Run window, and enter “control userpasswords2” or “netplwiz” to open the “User Accounts” window.</p></li><li><p>Select the account you want to operate on, re-check “Users must enter a user name and password to use this computer,” and then “Apply”; then uncheck “Users must enter a user name and password to use this computer,” and click “Apply” again, and the automatic login settings window will pop up. Enter the new password for your Microsoft account in it, then click “OK” to close the “Automatic Login” settings window, and finally click the “OK” button in the “User Accounts” window.</p></li></ol><p><a href="https://answers.microsoft.com/zh-hans/windows/forum/all/microsoft%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95/092f9d9c-909e-4f7f-8fab-5e4169480960">https://answers.microsoft.com/zh-hans/windows/forum/all/microsoft%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95/092f9d9c-909e-4f7f-8fab-5e4169480960</a></p></blockquote><h5 id="3-Why-is-the-QR-code-gone"><a href="#3-Why-is-the-QR-code-gone" class="headerlink" title="3. Why is the QR code gone?"></a>3. Why is the QR code gone?</h5><p>The new version uses automatic pairing, so there is no need to scan a QR code for pairing.</p><h5 id="4-How-to-use-Bluetooth-unlock"><a href="#4-How-to-use-Bluetooth-unlock" class="headerlink" title="4. How to use Bluetooth unlock?"></a>4. How to use Bluetooth unlock?</h5><p>To use Bluetooth unlock, you first need to enable Bluetooth unlock on the computer, and then pair your phone with the computer via Bluetooth.</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/31496/image-20250822013555071.png" alt="image-20250822013555071"></p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> RemoteFingerUnlock </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> RemoteFingerUnlock </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to Install a Specific Version of Docker on CentOS</title>
      
      
      <link href="/posts/3776602279/"/>
      
      
      <url>/posts/3776602279/</url>
      
      
        
      <content type="html"><![CDATA[<p>Docker is a popular containerization technology that allows you to quickly create, deploy, and run applications. However, sometimes you may need to install a specific version of Docker instead of the latest version. In this article, we’ll walk you through the steps to install a specific version of Docker on CentOS.</p><h3 id="Step-1-Install-Necessary-Packages"><a href="#Step-1-Install-Necessary-Packages" class="headerlink" title="Step 1: Install Necessary Packages"></a>Step 1: Install Necessary Packages</h3><p>First, you need to install some necessary packages, including <code>yum-utils</code>, <code>device-mapper-persistent-data</code>, and <code>lvm2</code>. These packages will help you configure Docker storage drivers and LVM volumes.</p><p>You can install these packages using the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></tbody></table></figure><h3 id="Step-2-Add-Docker-Repository"><a href="#Step-2-Add-Docker-Repository" class="headerlink" title="Step 2: Add Docker Repository"></a>Step 2: Add Docker Repository</h3><p>Next, you need to add the Docker repository. You can add the Docker repository to your CentOS system using the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></tbody></table></figure><p>Alternatively, if you’re in China, you can use the Aliyun mirror by running the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></tbody></table></figure><p>This will add the YUM repository configuration file for the Docker repository.</p><h3 id="Step-3-Update-YUM-Cache"><a href="#Step-3-Update-YUM-Cache" class="headerlink" title="Step 3: Update YUM Cache"></a>Step 3: Update YUM Cache</h3><p>Once the Docker repository has been added to the system, you need to update the YUM cache to be able to install packages from the repository. You can update the YUM cache using the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache</span><br></pre></td></tr></tbody></table></figure><h3 id="Step-4-Install-Specific-Version-of-Docker"><a href="#Step-4-Install-Specific-Version-of-Docker" class="headerlink" title="Step 4: Install Specific Version of Docker"></a>Step 4: Install Specific Version of Docker</h3><p>Finally, you can install the specific version of Docker that you need using the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io</span><br></pre></td></tr></tbody></table></figure><p>Where <code>&lt;VERSION_STRING&gt;</code> is the version number of the Docker version you want to install. For example, if you want to install Docker version 20.10.8, you can use the following command:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install docker-ce-20.10.8 docker-ce-cli-20.10.8 containerd.io</span><br></pre></td></tr></tbody></table></figure><h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>In this article, we’ve shown you how to install a specific version of Docker on CentOS. By following these four simple steps, you can successfully install the Docker version you need and start using Docker for containerized development and deployment. If you encounter any issues, please refer to the official Docker documentation or community support.</p><p><a href="https://docs.docker.com/engine/install/centos/#install-using-the-repository">Install Docker Engine on CentOS | Docker Documentation</a></p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Backend Development </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to Get Log4j Log File Path in Java</title>
      
      
      <link href="/posts/735037507/"/>
      
      
      <url>/posts/735037507/</url>
      
      
        
      <content type="html"><![CDATA[<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>Log4j is one of the widely used logging tools on the Java platform. It allows configuration of logging output to various destinations, such as console, file, and database. In real-world applications, it is often necessary to obtain the file path of the Log4j log file for viewing, analysis, and processing purposes. In this blog, we will discuss a method to obtain the Log4j log file path using Java code.</p><h1 id="Code-example"><a href="#Code-example" class="headerlink" title="Code example"></a>Code example</h1><p>In Log4j, a Logger instance can be used to get all of its Appenders using the getAppenders() method. An Appender is an abstract class with several concrete subclasses, such as ConsoleAppender, FileAppender, and RollingFileAppender. The FileAppender and RollingFileAppender subclasses are used to output logs to a file.</p><p>To obtain the file path of a RollingFileAppender instance, we can traverse all the Appenders of a Logger instance, and check each Appender instance to see if it is a RollingFileAppender instance. If we find one, we can then obtain the file path by calling the getFileName() method of the RollingFileAppender instance.</p><p>Here is an example code snippet that demonstrates this process:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.LogManager;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.core.Appender;</span><br><span class="line"><span class="keyword">import</span> org.apache.logging.log4j.core.appender.RollingFileAppender;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Log4jUtils</span> {</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getLogPath</span><span class="params">(Logger logger)</span> {</span><br><span class="line">        Map&lt;String, Appender&gt; appenderMap = ((org.apache.logging.log4j.core.Logger) logger).getAppenders();</span><br><span class="line">        <span class="keyword">if</span> (appenderMap == <span class="literal">null</span>) {</span><br><span class="line">            <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span> (Appender appender : appenderMap.values()) {</span><br><span class="line">            <span class="keyword">if</span> (appender <span class="keyword">instanceof</span> RollingFileAppender) {</span><br><span class="line">                <span class="keyword">return</span> ((RollingFileAppender) appender).getFileName();</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LogManager.getLogger(Log4jUtils.class);</span><br><span class="line">        <span class="type">String</span> <span class="variable">logPath</span> <span class="operator">=</span> getLogPath(logger);</span><br><span class="line">        System.out.println(logPath);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In this code, we first cast the Logger instance to the org.apache.logging.log4j.core.Logger type and then call the getAppenders() method to get all the Appenders. We then traverse each Appender instance and check if it is an instance of RollingFileAppender. If we find one, we obtain its file path by calling the getFileName() method.</p><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p> In this blog, we have discussed a method to obtain the file path of a Log4j log file using Java code. By traversing the Appenders of a Logger instance and checking if it is a RollingFileAppender instance, we can obtain its file path. This method can be useful for viewing, analyzing, and processing Log4j log files.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Backend Development </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
            
        <tag> Java </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to Execute JavaScript Code and Functions in Java</title>
      
      
      <link href="/posts/2250085940/"/>
      
      
      <url>/posts/2250085940/</url>
      
      
        
      <content type="html"><![CDATA[<p>JavaScript is a popular scripting language used for developing dynamic and interactive web pages. While JavaScript is primarily used in web development, it can also be used in other areas such as server-side scripting, desktop applications, and mobile apps. In this blog, we will explore how to execute JavaScript code and functions in Java.</p><p>To execute JavaScript code in Java, we can use the ScriptEngine class provided by the Java API. The ScriptEngine class is used to execute scripts written in various languages, including JavaScript. Here is a sample code that demonstrates how to execute JavaScript code in Java:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.script.ScriptEngine;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngineManager;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaScriptExecutor</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="comment">// Create a ScriptEngineManager object</span></span><br><span class="line">        <span class="type">ScriptEngineManager</span> <span class="variable">manager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScriptEngineManager</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get the JavaScript engine</span></span><br><span class="line">        <span class="type">ScriptEngine</span> <span class="variable">engine</span> <span class="operator">=</span> manager.getEngineByName(<span class="string">"javascript"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// Execute JavaScript code</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">script</span> <span class="operator">=</span> <span class="string">"var a = 1 + 2; a;"</span>;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> engine.eval(script);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Print the result</span></span><br><span class="line">            System.out.println(result);</span><br><span class="line">        } <span class="keyword">catch</span> (ScriptException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In this example, we create a ScriptEngineManager object and get the JavaScript engine using the getEngineByName method. Then we execute the JavaScript code using the eval method of the ScriptEngine class and store the result in an Object variable. Finally, we print the result to the console.</p><p>To execute JavaScript functions in Java, we can define the function in JavaScript code and then call it from our Java code using the ScriptEngine class. Here is a sample code that demonstrates how to execute JavaScript functions in Java:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.script.ScriptEngine;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngineManager;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JavaScriptFunctionExecutor</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> {</span><br><span class="line">        <span class="comment">// Create a ScriptEngineManager object</span></span><br><span class="line">        <span class="type">ScriptEngineManager</span> <span class="variable">manager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScriptEngineManager</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get the JavaScript engine</span></span><br><span class="line">        <span class="type">ScriptEngine</span> <span class="variable">engine</span> <span class="operator">=</span> manager.getEngineByName(<span class="string">"javascript"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">            <span class="comment">// Define a JavaScript function</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">script</span> <span class="operator">=</span> <span class="string">"function add(a, b) { return a + b; }"</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Execute the JavaScript function and get the result</span></span><br><span class="line">            engine.eval(script);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> engine.eval(<span class="string">"add(1, 2)"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Print the result</span></span><br><span class="line">            System.out.println(result);</span><br><span class="line">        } <span class="keyword">catch</span> (ScriptException e) {</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In this example, we define a JavaScript function called add that takes two arguments and returns their sum. Then we execute the function using the eval method of the ScriptEngine class and store the result in an Object variable. Finally, we print the result to the console.</p><p>In conclusion, the ScriptEngine class provided by the Java API allows us to execute JavaScript code and functions in Java. By leveraging the power of both languages, we can create more powerful and dynamic applications.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Backend Development </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
            
        <tag> Java </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to make braised pork trotters</title>
      
      
      <link href="/posts/1037676127/"/>
      
      
      <url>/posts/1037676127/</url>
      
      
        
      <content type="html"><![CDATA[<blockquote><p>Braised pork trotters are a beloved dish in many Asian cuisines. It’s a rich, flavorful, and comforting dish that’s perfect for cold days or for any occasion. In this recipe, we’ll go through the steps of making a simple and delicious braised pork trotters dish.</p></blockquote><h1 id="Ingredients"><a href="#Ingredients" class="headerlink" title="Ingredients"></a>Ingredients</h1><ul><li>4 pork trotters</li><li>10g ginger slices</li><li>50ml Shaoxing wine</li><li>50ml light soy sauce</li><li>25ml dark soy sauce</li><li>20g rock sugar</li><li>2 star anise</li><li>1 piece cinnamon bark</li><li>2 bay leaves</li><li>Salt to taste</li><li>Water</li></ul><h1 id="Instructions"><a href="#Instructions" class="headerlink" title="Instructions"></a>Instructions</h1><ol><li>Clean the pork trotters: Rinse the pork trotters under cold water to remove any dirt or debris. Then, blanch the trotters in boiling water for a few minutes to get rid of any impurities. After that, rinse the trotters under cold water again.</li><li>Boil the pork trotters: In a large pot, add the pork trotters, ginger slices, and Shaoxing wine. Cover the trotters with enough water and bring it to a boil over high heat. Once the water boils, reduce the heat to low and let the pork trotters simmer for 10 minutes. Skim off any foam that rises to the surface.</li><li>Add the seasoning: Add the light soy sauce, dark soy sauce, rock sugar, star anise, cinnamon bark, and bay leaves. Stir the ingredients to combine, and bring the mixture to a boil again.</li><li>Simmer the pork trotters: Once the mixture boils, reduce the heat to low and let the pork trotters simmer for 2 hours, or until the meat is tender and falls off the bone. Add salt to taste.</li><li>Let the pork trotters cool: Turn off the heat and let the pork trotters cool in the pot. This will help them absorb more flavor.</li><li>Serve: Once the pork trotters are cool, remove them from the pot and place them on a plate. You can serve them with steamed rice or your favorite vegetables.</li></ol><h1 id="Tips-for-Making-Braised-Pork-Trotters"><a href="#Tips-for-Making-Braised-Pork-Trotters" class="headerlink" title="Tips for Making Braised Pork Trotters"></a>Tips for Making Braised Pork Trotters</h1><ul><li>For a richer and thicker sauce, you can add cornstarch or potato starch to the sauce.</li><li>You can also add other ingredients like garlic, scallions, or dried mushrooms to the pot for additional flavor.</li><li>If you don’t have Shaoxing wine, you can substitute it with dry sherry or rice wine.</li></ul><h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>Braised pork trotters are a classic dish that’s hearty, flavorful, and easy to make. This dish is perfect for any occasion, and it’s sure to impress your family and friends. Follow this recipe and enjoy a delicious and satisfying meal!</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Recipe </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Life </tag>
        
            
            
        <tag> Recipe </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to Retrieve User Addresses in a Spring Boot Application</title>
      
      
      <link href="/posts/1268933518/"/>
      
      
      <url>/posts/1268933518/</url>
      
      
        
      <content type="html"><![CDATA[<p>When building a web application, it’s often necessary to retrieve the IP address of the user who is accessing the application. This information can be useful for various purposes, such as security, analytics, and customization. In this tutorial, we will explore how to retrieve both IPv4 and IPv6 addresses of a user in a Spring Boot application.</p><h2 id="Retrieving-User-IP-Address"><a href="#Retrieving-User-IP-Address" class="headerlink" title="Retrieving User IP Address"></a>Retrieving User IP Address</h2><p>In Spring Boot, we can retrieve the IP address of a user by injecting a <code>HttpServletRequest</code> object into our controller class and calling its <code>getRemoteAddr()</code> method. For example:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class UserController {</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private HttpServletRequest request;</span><br><span class="line"></span><br><span class="line">    @GetMapping("/user/ip")</span><br><span class="line">    public String getUserIP() {</span><br><span class="line">        String ipAddress = request.getRemoteAddr();</span><br><span class="line">        return ipAddress;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In the above code, we have injected a <code>HttpServletRequest</code> object using the <code>@Autowired</code> annotation and defined a <code>getUserIP()</code> method that returns the IP address of the user. The <code>getRemoteAddr()</code> method of the <code>HttpServletRequest</code> object returns the IP address of the client or the last proxy that sent the request.</p><p>However, this method may not always return the correct IP address. In some cases, the IP address may be the address of a proxy server or load balancer rather than the actual user’s IP address. To obtain the correct IP address, we can check for the <code>X-Forwarded-For</code> header, which is a standard header used by proxies to indicate the originating IP address of a client connecting to a web server through the proxy. Here’s an updated version of the code that checks for the <code>X-Forwarded-For</code> header:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HttpServletRequest request;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping("/user/ip")</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUserIP</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">String</span> <span class="variable">ipAddress</span> <span class="operator">=</span> request.getHeader(<span class="string">"X-Forwarded-For"</span>);</span><br><span class="line">        <span class="keyword">if</span> (ipAddress == <span class="literal">null</span> || ipAddress.isEmpty() || <span class="string">"unknown"</span>.equalsIgnoreCase(ipAddress)) {</span><br><span class="line">            ipAddress = request.getRemoteAddr();</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> ipAddress;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In the above code, we first check for the <code>X-Forwarded-For</code> header using the <code>getHeader()</code> method of the <code>HttpServletRequest</code> object. If the header is not present or its value is empty or “unknown”, we fall back to the <code>getRemoteAddr()</code> method to obtain the IP address.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Backend Development </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>Java Thread Context: How to Determine Whether You're in a Request Context</title>
      
      
      <link href="/posts/2685105031/"/>
      
      
      <url>/posts/2685105031/</url>
      
      
        
      <content type="html"><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>When developing Java web applications, it is often necessary to check whether the current thread is in a request context. A request context is a context that holds information about a single HTTP request and is typically used in web applications. In this blog post, we will explore how to determine whether the current thread is in a request context using Spring Framework’s <code>RequestContextHolder</code> class.</p><h2 id="The-RequestContextHolder-Class"><a href="#The-RequestContextHolder-Class" class="headerlink" title="The RequestContextHolder Class"></a>The RequestContextHolder Class</h2><p>The <code>RequestContextHolder</code> class is a utility class provided by Spring Framework that allows you to bind the current HTTP request and response to the current thread. It provides access to the current request and response objects and allows you to access request attributes.</p><h2 id="Checking-if-the-Current-Thread-is-in-a-Request-Context"><a href="#Checking-if-the-Current-Thread-is-in-a-Request-Context" class="headerlink" title="Checking if the Current Thread is in a Request Context"></a>Checking if the Current Thread is in a Request Context</h2><p>To check if the current thread is in a request context, we can use the <code>RequestContextHolder.getRequestAttributes()</code> method. This method returns the current request attributes associated with the current thread. If there are no request attributes associated with the current thread, it means that the current thread is not in a request context.</p><p>Here’s an example implementation of a <code>RequestContextChecker</code> class that uses <code>RequestContextHolder</code> to check if the current thread is in a request context:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestAttributes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RequestContextChecker</span> {</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isCurrentThreadInRequestContext</span><span class="params">()</span> {</span><br><span class="line">        <span class="type">RequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> RequestContextHolder.getRequestAttributes();</span><br><span class="line">        <span class="keyword">return</span> requestAttributes != <span class="literal">null</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>In the code above, the <code>isCurrentThreadInRequestContext()</code> method calls <code>RequestContextHolder.getRequestAttributes()</code> to get the request attributes associated with the current thread. If there are request attributes associated with the current thread, the method returns <code>true</code>. Otherwise, it returns <code>false</code>.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In this  post, we’ve seen how to check if the current thread is in a request context using Spring Framework’s <code>RequestContextHolder</code> class. By using <code>RequestContextHolder.getRequestAttributes()</code>, we can determine if the current thread is in a request context and take appropriate actions based on the result. It’s important to note that this method is only applicable to web applications that use Spring Framework. For other types of request contexts, you may need to use a different method to determine if the current thread is in a request context.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Backend Development </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
            
        <tag> Trap </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>Wireshark Basic Usage</title>
      
      
      <link href="/posts/20069/"/>
      
      
      <url>/posts/20069/</url>
      
      
        
      <content type="html"><![CDATA[<h2 id="一、Introduction"><a href="#一、Introduction" class="headerlink" title="一、Introduction"></a>一、Introduction</h2><p>Wireshark is currently one of the most widely used network packet analysis software in the world. The function of network packet analysis software is to listen to network packets and display the most detailed network packet information as much as possible. Wireshark uses Winpcap as the interface to directly exchange data packets with the network card.</p><p>The following figure shows the initial interface after successfully installing Winpcap and Wireshark:</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608181205658.png" alt="image-20200608181205658"></p><p>In the initial interface of Wireshark, the fluctuating line represents the fluctuation of the information transmitted by the network card. Click the start icon in the upper left corner to enter the packet capture page shown in the following figure:</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608181307861.png" alt="image-20200608181307861"></p><h2 id="二、Packet-Capture-and-Analysis"><a href="#二、Packet-Capture-and-Analysis" class="headerlink" title="二、Packet Capture and Analysis"></a>二、Packet Capture and Analysis</h2><p>This example demonstrates packet capture using the curl and ping commands.<br>Start capturing with Wireshark, and then, as shown in the following figure, use the curl and ping commands in the terminal to interact with the target address:</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608173101731.png" alt="image-20200608173101731"></p><p>​                </p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174203428.png" alt="image-20200608174203428"></p><blockquote><p> From the response packets of ping, we can see that we received 7 response packets. The IP address of Baidu here is 14.215.177.39.</p></blockquote><p>Returning to Wireshark, filter the packets by IP address in the filter, as shown in the following figure is the result of filtering the packets. The filter command is:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip.addr ==14.215.177.39 </span><br></pre></td></tr></tbody></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608173431410.png" alt="image-20200608173431410"></p><h3 id="1-TCP-Three-Way-Handshake-Analysis"><a href="#1-TCP-Three-Way-Handshake-Analysis" class="headerlink" title="1.TCP Three-Way Handshake Analysis"></a>1.TCP Three-Way Handshake Analysis</h3><p>Viewing the packets, in the above figure, packets 1-3 are using the TCP protocol, and packet 4 is using the HTTP protocol, which is a clear sign of the TCP three-way handshake. The first three packets are the process of the TCP three-way handshake. The following figure shows the detailed packet contents of the TCP three-way handshake, which can be compared with the packet flag bits of the TCP three-way handshake.</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/JSYW201709050_01100.jpg" alt="img"></p><h3 id="2-ICMP-Protocol-Analysis"><a href="#2-ICMP-Protocol-Analysis" class="headerlink" title="2.ICMP Protocol Analysis"></a>2.ICMP Protocol Analysis</h3><p>The ping command belongs to the ICMP protocol. Viewing the ICMP packets in the filtered packets, we can observe 14 packets. As mentioned earlier, 7 response packets were received for the ping destination address.</p><p>ICMP packets have two modes: request and response. See the following figure for details:：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174410800.png" alt="image-20200608174410800"></p><p><strong>The ICMP Request and Reply message formats are as follows:</strong></p><p>Request：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174514228.png" alt="image-20200608174514228"></p><p> Reply：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174532582.png" alt="image-20200608174532582"></p><blockquote><p>Type indicates the type of ICMP message, 8 for request messages and 0 for reply messages;</p><p>Code = 0;</p><p>CheckSum is the checksum from the ICMP header (starting with Type) to the end of the data (ending with the entire packet);</p><p>Identifier is the identifier set by the host, usually set to the process ID. The identifier in the response message is the same as the identifier in the original message;</p><p>Sequence Number is the sequence number set by the host, usually set to an increasing sequence starting from 0. The sequence number in the response message is the same as the sequence number in the original message;</p><p>Data is the data set by the host. The data in the response message is the same as the data in the original message;</p><p>Note: The Identifier and Sequence Number fields are divided into [BE] and [LE]. [BE] is for Linux content, and [LE] is for Windows content. Since this experiment was conducted in a Linux environment, only the [BE] content needs to be viewed.</p></blockquote><p>Request Message Header ：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174737348.png" alt="image-20200608174737348"></p><p>Reply Message Header：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608174816396.png" alt="image-20200608174816396"></p><h2 id="三、Introduction-to-Wireshark-filters"><a href="#三、Introduction-to-Wireshark-filters" class="headerlink" title="三、Introduction to Wireshark filters"></a>三、Introduction to Wireshark filters</h2><p>One of the core features of Wireshark is the use of filters. There are three states for display filters: red, yellow, and green. Red means that the display filter expression is incorrect, yellow means that the filter expression can filter packets but may result in unpredictable results, and green means that the filter expression is correct.</p><p>Wireshark filters are divided into two types: display filters and capture filters. Display filters filter captured packets based on filtering rules, while capture filters only capture packets that meet the filtering rules that have been set in advance.</p><p><strong>Capture Filter：</strong></p><p>As shown in the following figure is the capture filter settings. ：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608175505369.png" alt="image-20200608175505369">  </p><p>The reason for setting a capture filter is to target situations where the network traffic is very large, such as several gigabytes per second, and most of the traffic is not the data that the analyst is interested in. In this case, a capture filter can be used to capture only the specified data. Useless data can not only interfere with analysis, but also waste storage space and copying time.</p><p><strong>Display filter：</strong></p><p>The following image shows the setting of a display filter ：</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/20069/image-20200608175705185.png" alt="image-20200608175705185"></p><blockquote><p>Common syntax of display filters:</p><ol><li><p>Protocol filter, such as http, icmp, etc;</p></li><li><p>Filter by specific port: tcp.port eq 80, displays packets with port 80 whether it is a source or destination port. To filter by the source port, use tcp.srcport eq 80, and to filter by the destination port, use tcp.dstport eq 80;</p></li><li><p>Filter by source IP address: ip.src eq 192.168.1.107, and to filter by the destination, use ip.dst eq 192.168.1.107. To filter by both source and destination, use ip.addr eq 192.168.1.107. MAC address filtering follows the same logic;</p></li><li><p>Filter packets containing a specific string domain name, such as http.host contains “moe”;</p></li><li><p>Multiple filter conditions can be used together, for example, to simultaneously filter for http protocol and port 80, use http &amp;&amp; tcp.port == 80. Combination symbols include AND/&amp;&amp;, OR/||, and NOT/!;</p></li></ol><p>The syntax of capture filters is slightly different from display filters, and some examples are as follows:</p><ol><li>Filter by specific protocol: http</li><li>Filter by specific port: port 80</li><li>Filter by specific IP address: host 192.168.0.115</li><li>Filter by specific domain name: host <a href="http://www.example.com/">www.example.com</a></li></ol></blockquote>]]></content>
      
      
      
      
        
      <tags>
        
            
            
        <tag> Information Security </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>The issue of SSL certificate being unable to issue due to the CNAME record pointing to Vercel affecting the CAA record.</title>
      
      
      <link href="/posts/3655275721/"/>
      
      
      <url>/posts/3655275721/</url>
      
      
        
      <content type="html"><![CDATA[<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>The most drastic solution is to directly pause all DNS related to Vercel.<br>Or, first pause the resolution of the second-level domain to Vercel, that is, pause example.com-&gt;Vercel,<br>and then pause the Vercel of the affected subdomain, that is, pause a.example.com-&gt;Vercel.</p><h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>Today, Alibaba Cloud informed me that an SSL certificate for one of my domains was about to expire. As an experienced developer, I opened the Alibaba Cloud console to apply for a new certificate.</p><p>However, something strange happened. Previously, the certificate could be issued within a minute, but this time it took a long time and it still didn’t work. I decided to take a nap and try again later.</p><p>When I woke up and opened the Alibaba Cloud console, I found that it still wasn’t successful. At this point, I still suspected that it was Alibaba Cloud’s problem. So I applied again using Freessl, but it still wasn’t successful in the afternoon. The result of the test using <a href="https://myssl.com/">myssl.com</a> is as follows:</p><table><thead><tr><th align="left">Region</th><th align="left">Match</th></tr></thead><tbody><tr><td align="left">China</td><td align="left">Not match (Validation failed. Your CAA configuration doesn’t allow the current CA to issue certificates for you. Please modify to: symantec.com or digicert.com)</td></tr><tr><td align="left">Hong Kong</td><td align="left">Not match (Validation failed. Your CAA configuration doesn’t allow the current CA to issue certificates for you. Please modify to: symantec.com or digicert.com)</td></tr><tr><td align="left">United States</td><td align="left">Not match (Validation failed. Your CAA configuration doesn’t allow the current CA to issue certificates for you. Please modify to: symantec.com or digicert.com)</td></tr></tbody></table><p>I haven’t set up any CAA records! </p><p>I thought it couldn’t be a DNS cache issue, right?</p><p> But I still went to the Alibaba Cloud console to temporarily stop resolving all DNS records. As a result, it actually worked! After investigation, I found that the problem was caused by the CNAME record pointing to Vercel. How could Vercel have the permission to set CAA records for me?!</p><h3 id="Reason"><a href="#Reason" class="headerlink" title="Reason"></a>Reason</h3><p>After some searching, I finally figured out the reason, which was caused by the CAA record.</p><blockquote><p> CAA (Certificate Authority Authorization) is a new additional field that can be added to DNS records to create CAA resource records through DNS mechanism, which can limit the connection between the domain name issuing the certificate and the CA (certificate authority). Unauthorized third parties attempting to obtain SSL/TLS certificates for the domain name through other CAs will be rejected. By setting a CAA record for the domain name, website owners can authorize specific CAs to issue certificates for their domain name, thereby preventing HTTPS certificate errors and improving website security.</p></blockquote><p>An additional piece of knowledge is that CNAME records can affect CAA records：</p><p>CAA record checking continues for CNAME records pointing to a different domain. In this example, <a href="http://www.example.com/">www.example.com</a> points to <a href="http://www.example.net/">www.example.net</a>, which also has CAA records:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(Example 7 / www.example.com)</span><br><span class="line">Domain   Record type  Flags  Tag      Value   </span><br><span class="line">www.example.com.   CNAME www.example.net</span><br><span class="line">www.example.net.   CAA           0      issue   ";"</span><br><span class="line"></span><br><span class="line">(Result: CAA failed)</span><br></pre></td></tr></tbody></table></figure><p>The first record redirects the CAA check to <a href="http://www.example.net/">www.example.net</a>. This CAA record can prevent any CA from issuing a certificate, so the certificate authority cannot issue a certificate for <a href="http://www.example.com/">www.example.com</a>.</p><p>If the domain being pointed to (<a href="http://www.example.net/">www.example.net</a>) does not have a CAA record, then the CAA record check will climb up to the parent domain (example.com).</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(Example 8 / www.example.com)</span><br><span class="line">Domain   Record type  Flags  Tag      Value   </span><br><span class="line">www.example.com.   CNAME www.example.net</span><br><span class="line">example.com.   CAA           0      issue   "amazon.com"</span><br><span class="line"></span><br><span class="line">(Result: CAA passed)</span><br></pre></td></tr></tbody></table></figure><p>In plain language, it means that because we set a CNAME record to point to Vercel, and Vercel set a CAA record, it affected our domain’s CAA record. After using a tool to check, we confirmed that this was indeed the case.：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">  "canIssue": false,</span><br><span class="line">  "status": "IssueMismatch",</span><br><span class="line">  "domain": "czqu.net",</span><br><span class="line">  "queryAt": "Sep 30, 2021 11:21:55 AM",</span><br><span class="line">  "elapsed": 1,</span><br><span class="line">  "caaRecordSet": [</span><br><span class="line">    {</span><br><span class="line">      "domain": "czqu.net",</span><br><span class="line">      "caaRecords": [</span><br><span class="line">        {</span><br><span class="line">          "issuerCritical": 0,</span><br><span class="line">          "tag": "issue",</span><br><span class="line">          "value": "letsencrypt.org",</span><br><span class="line">          "type": 257,</span><br><span class="line">          "dclass": 1,</span><br><span class="line">          "ttl": 60</span><br><span class="line">        },</span><br><span class="line">        {</span><br><span class="line">          "issuerCritical": 0,</span><br><span class="line">          "tag": "issue",</span><br><span class="line">          "value": "globalsign.com",</span><br><span class="line">          "type": 257,</span><br><span class="line">          "dclass": 1,</span><br><span class="line">          "ttl": 60</span><br><span class="line">        }</span><br><span class="line">      ]</span><br><span class="line">    }</span><br><span class="line">  ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      
      
        
      <tags>
        
            
            
        <tag> Backend Development </tag>
        
            
            
        <tag> Trap </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>How to Fix Redmi Bluetooth Earphones with One-Sided Sound Issue</title>
      
      
      <link href="/posts/56389/"/>
      
      
      <url>/posts/56389/</url>
      
      
        
      <content type="html"><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p> If you’re experiencing an issue with your Bluetooth earphones where only one side has sound, you might have been searching for solutions online. Unfortunately, not all online advice is reliable. To help fellow users, I’m sharing my tested solution to this problem.</p><h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ol><li><p>Unpair your earphones from your phone.</p></li><li><p>With both earphones turned on, press and hold the power button for 5 seconds until they turn off. Release the button once they turn off. (Both earphones’ lights should not be on during this process. Skip this step if your earphones are already turned off.)</p></li><li><p>Press and hold both earphones again. When the LED lights start flashing white, keep pressing until they flash red and white twice. (This step is crucial as it clears the previous configuration information on the earphones. Remember to unpair and turn off Bluetooth on your phone.)</p></li><li><p>Turn on the right earphone first and then the left. (Make sure the earphones are inside the charging case. Taking out the right earphone will automatically turn it on, so start with the right one first.)</p></li><li><p>The right earphone should start flashing quickly. When the left earphone stops flashing, the earphones are paired successfully.</p></li><li><p>Pair the earphones with your phone again through the Bluetooth settings.</p></li></ol><p>By following these steps, you should be able to fix the one-sided sound issue on your Redmi Bluetooth earphones.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> Life Hacks </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Life Hacks </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>LeetCode 46. Permutations</title>
      
      
      <link href="/posts/3587124311/"/>
      
      
      <url>/posts/3587124311/</url>
      
      
        
      <content type="html"><![CDATA[<h1 id="Question"><a href="#Question" class="headerlink" title="Question:"></a>Question:</h1><p>Given an array <code>nums</code> of distinct integers, return <em>all the possible permutations</em>. You can return the answer in <strong>any order</strong>.</p><p><strong>Example 1:</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: nums = [1,2,3]</span><br><span class="line">Output: [[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]</span><br></pre></td></tr></tbody></table></figure><p><strong>Example 2:</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: nums = [0,1]</span><br><span class="line">Output: [[0,1],[1,0]]</span><br></pre></td></tr></tbody></table></figure><p><strong>Example 3:</strong></p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: nums = [1]</span><br><span class="line">Output: [[1]]</span><br></pre></td></tr></tbody></table></figure><p><strong>Constraints:</strong></p><ul><li><code>1 &lt;= nums.length &lt;= 6</code></li><li><code>-10 &lt;= nums[i] &lt;= 10</code></li><li>All the integers of <code>nums</code> are <strong>unique</strong>.</li></ul><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution:"></a>Solution:</h1><p>Given an array of distinct integers nums, return all possible permutations of its elements. You can return the answer in any order.</p><p>Algorithm</p><p>The problem can be solved by recursively generating all permutations of the array. For a given array nums, the algorithm works as follows:</p><ul><li>If the length of nums is 1, return a list containing nums.</li><li>For each element in nums, generate all permutations of the remaining elements using recursion. This can be done by creating a new array without the current element, and calling the permutation function recursively with the new array.</li><li>For each permutation generated in step 2, add the current element to the beginning of the permutation.</li><li>Return the list of all permutations generated in step 3.</li></ul><p>Java Implementation</p><p>Here’s the Java implementation of the algorithm:</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> {</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permute</span><span class="params">(<span class="type">int</span>[] nums)</span> {</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        permute(nums, <span class="keyword">new</span> <span class="title class_">boolean</span>[nums.length], <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(), res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">permute</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">boolean</span>[] used, List&lt;Integer&gt; cur, List&lt;List&lt;Integer&gt;&gt; res)</span> {</span><br><span class="line">        <span class="keyword">if</span> (cur.size() == nums.length) {</span><br><span class="line">            res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(cur));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) {</span><br><span class="line">            <span class="keyword">if</span> (!used[i]) {</span><br><span class="line">                cur.add(nums[i]);</span><br><span class="line">                used[i] = <span class="literal">true</span>;</span><br><span class="line">                permute(nums, used, cur, res);</span><br><span class="line">                cur.remove(cur.size() - <span class="number">1</span>);</span><br><span class="line">                used[i] = <span class="literal">false</span>;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>The permute() function takes an array nums, and returns a list of all permutations of its elements. The function uses a helper function permute() to generate the permutations recursively. The permute() function takes the following arguments:</p><ul><li>nums: the array of integers to be permuted</li><li>used: a boolean array indicating which elements of nums have already been used in the current permutation</li><li>cur: a list representing the current permutation being generated</li><li>res: the list of all permutations generated so far</li></ul><p>Python Implementation</p><p>Here’s the Python implementation of the algorithm:</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">permute</span>(<span class="params">self, nums: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(nums) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> [nums]</span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nums)):</span><br><span class="line">            sub_res = <span class="variable language_">self</span>.permute(nums[:i] + nums[i+<span class="number">1</span>:])</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> sub_res:</span><br><span class="line">                res.append([nums[i]] + j)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></tbody></table></figure><p>The permute() function takes an array nums, and returns a list of all permutations of its elements. The function uses recursion to generate the permutations. The permute() function takes the following arguments:</p><ul><li>nums: the array of integers to be permuted</li></ul><p>Time Complexity</p><p>The time complexity of the algorithm is O(n!), where n is the length of the input array. This is because there are n! permutations of n distinct elements, and the algorithm generates each permutation once.</p><p>Space Complexity</p><p>The space complexity of the algorithm is O(n^2), where n is the length of the input array. This is because the algorithm generates n! permutations, each of which has length n. The algorithm uses additional space to store the list of permutations generated so far.</p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> LeetCode </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> Java </tag>
        
            
            
        <tag> LeetCode </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>Solutions to exercises and projects in the textbook C Programming: A Modern Approach, 2nd Edition</title>
      
      
      <link href="/posts/28638/"/>
      
      
      <url>/posts/28638/</url>
      
      
        
      <content type="html"><![CDATA[<h3 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h3><h4 id="Answers-to-Selected-Exercises"><a href="#Answers-to-Selected-Exercises" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] (a) The program contains one directive (<code>#include</code>) and four statements (three calls of <code>printf</code> and one <code>return</code>).</p><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Parkinson's Law:</span><br><span class="line">Work expands so as to fill the time</span><br><span class="line">available for its completion.</span><br></pre></td></tr></tbody></table></figure><p><strong>3.</strong> [was #4]</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int height = 8, length = 12, width = 10, volume;</span><br><span class="line"> </span><br><span class="line">  volume = height * length * width;</span><br><span class="line"> </span><br><span class="line">  printf("Dimensions: %dx%dx%d\n", length, width, height);</span><br><span class="line">  printf("Volume (cubic inches): %d\n", volume);</span><br><span class="line">  printf("Dimensional weight (pounds): %d\n", (volume + 165) / 166);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #6] Here’s one possible program:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int i, j, k;</span><br><span class="line">  float x, y, z;</span><br><span class="line"> </span><br><span class="line">  printf("Value of i: %d\n", i);</span><br><span class="line">  printf("Value of j: %d\n", j);</span><br><span class="line">  printf("Value of k: %d\n", k);</span><br><span class="line"> </span><br><span class="line">  printf("Value of x: %g\n", x);</span><br><span class="line">  printf("Value of y: %g\n", y);</span><br><span class="line">  printf("Value of z: %g\n", z);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>When compiled using GCC and then executed, this program produced the following output:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Value of i: 5618848</span><br><span class="line">Value of j: 0</span><br><span class="line">Value of k: 6844404</span><br><span class="line">Value of x: 3.98979e-34</span><br><span class="line">Value of y: 9.59105e-39</span><br><span class="line">Value of z: 9.59105e-39</span><br></pre></td></tr></tbody></table></figure><p>The values printed depend on many factors, so the chance that you’ll get exactly these numbers is small.</p><p><strong>5.</strong> [was #10] (a) is not legal because <code>100_bottles</code> begins with a digit.</p><p><strong>8.</strong> [was #12] There are 14 tokens: <code>a</code>, <code>=</code>, <code>(</code>, <code>3</code>, <code>*</code>, <code>q</code>, <code>-</code>, <code>p</code>, <code>*</code>, <code>p</code>, <code>)</code>, <code>/</code>, <code>3</code>, and <code>;</code>. </p><h4 id="Answers-to-Selected-Programming-Projects"><a href="#Answers-to-Selected-Programming-Projects" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>4.</strong> [was #8; modified]</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  float original_amount, amount_with_tax;</span><br><span class="line"> </span><br><span class="line">  printf("Enter an amount: ");</span><br><span class="line">  scanf("%f", &amp;original_amount);</span><br><span class="line">  amount_with_tax = original_amount * 1.05f;</span><br><span class="line">  printf("With tax added: $%.2f\n", amount_with_tax);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>The <code>amount_with_tax</code> variable is unnecessary. If we remove it, the program is slightly shorter:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  float original_amount;</span><br><span class="line"> </span><br><span class="line">  printf("Enter an amount: ");</span><br><span class="line">  scanf("%f", &amp;original_amount);</span><br><span class="line">  printf("With tax added: $%.2f\n", original_amount * 1.05f);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>Chapter 3</strong></p><p><strong>Answers to Selected Exercises</strong></p><p><strong>2.</strong> [was #2] </p><p>(a) printf(“%-8.1e”, x);<br> (b) printf(“%10.6e”, x);<br> (c) printf(“%-8.3f”, x);<br> (d) printf(“%6.0f”, x); </p><p><strong>5.</strong> [was #8] The values of x, i, and y will be 12.3, 45, and .6, respectively.</p><p><strong>Answers to Selected Programming Projects</strong></p><p><strong>1.</strong> [was #4; modified] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int month, day, year;</p><p> printf(“Enter a date (mm/dd/yyyy): “);</p><p> scanf(“%d/%d/%d”, &amp;month, &amp;day, &amp;year);</p><p> printf(“You entered the date %d%.2d%.2d\n”, year, month, day);</p><p> return 0;</p><p>}</p><p><strong>3.</strong> [was #6; modified] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int prefix, group, publisher, item, check_digit;</p><p> printf(“Enter ISBN: “);</p><p> scanf(“%d-%d-%d-%d-%d”, &amp;prefix, &amp;group, &amp;publisher, &amp;item, &amp;check_digit);</p><p> printf(“GS1 prefix: %d\n”, prefix);</p><p> printf(“Group identifier: %d\n”, group);</p><p> printf(“Publisher code: %d\n”, publisher);</p><p> printf(“Item number: %d\n”, item);</p><p> printf(“Check digit: %d\n”, check_digit);</p><p> /* The five printf calls can be combined as follows:</p><p>   printf(“GS1 prefix: %d\nGroup identifier: %d\nPublisher code: %d\nItem number: %d\nCheck digit: %d\n”,</p><p>​      prefix, group, publisher, item, check_digit);</p><p> */</p><p> return 0;</p><p>}</p><p><strong>Chapter 4</strong></p><p><strong>Answers to Selected Exercises</strong></p><p><strong>2.</strong> [was #2] Not in C89. Suppose that i is 9 and j is 7. The value of (-i)/j could be either –1 or –2, depending on the implementation. On the other hand, the value of -(i/j) is always –1, regardless of the implementation. In C99, on the other hand, the value of (-i)/j must be equal to the value of -(i/j). </p><p><strong>9.</strong> [was #6] </p><p>(a) 63 8<br> (b) 3 2 1<br> (c) 2 -1 3<br> (d) 0 0 0 </p><p><strong>13.</strong> [was #8] The expression ++i is equivalent to (i += 1). The value of both expressions is i <em>after</em> the increment has been performed. </p><p><strong>Answers to Selected Programming Projects</strong></p><p><strong>2.</strong> [was #4] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int n;</p><p> printf(“Enter a three-digit number: “);</p><p> scanf(“%d”, &amp;n);</p><p> printf(“The reversal is: %d%d%d\n”, n % 10, (n / 10) % 10, n / 100);</p><p> return 0;</p><p>}</p><p><strong>Chapter 5</strong></p><p><strong>Answers to Selected Exercises</strong></p><p><strong>2.</strong> [was #2] </p><p>(a) 1<br> (b) 1<br> (c) 1<br> (d) 1 </p><p><strong>4.</strong> [was #4] (i &gt; j) - (i &lt; j)</p><p><strong>6.</strong> [was #12] Yes, the statement is legal. When n is equal to 5, it does nothing, since 5 is not equal to –9. </p><p><strong>10.</strong> [was #16] The output is </p><p>onetwo</p><p>since there are no break statements after the cases. </p><p><strong>Answers to Selected Programming Projects</strong></p><p><strong>2.</strong> [was #6] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int hours, minutes;</p><p> printf(“Enter a 24-hour time: “);</p><p> scanf(“%d:%d”, &amp;hours, &amp;minutes);</p><p> printf(“Equivalent 12-hour time: “);</p><p> if (hours == 0)</p><p>  printf(“12:%.2d AM\n”, minutes);</p><p> else if (hours &lt; 12)</p><p>  printf(“%d:%.2d AM\n”, hours, minutes);</p><p> else if (hours == 12)</p><p>  printf(“%d:%.2d PM\n”, hours, minutes);</p><p> else</p><p>  printf(“%d:%.2d PM\n”, hours - 12, minutes);</p><p> return 0;</p><p>}</p><p><strong>4.</strong> [was #8; modified] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int speed;</p><p> printf(“Enter a wind speed in knots: “);</p><p> scanf(“%d”, &amp;speed);</p><p> if (speed &lt; 1)</p><p>  printf(“Calm\n”);</p><p> else if (speed &lt;= 3)</p><p>  printf(“Light air\n”);</p><p> else if (speed &lt;= 27)</p><p>  printf(“Breeze\n”);</p><p> else if (speed &lt;= 47)</p><p>  printf(“Gale\n”);</p><p> else if (speed &lt;= 63)</p><p>  printf(“Storm\n”);</p><p> else</p><p>  printf(“Hurricane\n”);</p><p> return 0;</p><p>}</p><p><strong>6.</strong> [was #10] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int check_digit, d, i1, i2, i3, i4, i5, j1, j2, j3, j4, j5,</p><p>   first_sum, second_sum, total;</p><p> printf(“Enter the first (single) digit: “);</p><p> scanf(“%1d”, &amp;d);</p><p> printf(“Enter first group of five digits: “);</p><p> scanf(“%1d%1d%1d%1d%1d”, &amp;i1, &amp;i2, &amp;i3, &amp;i4, &amp;i5);</p><p> printf(“Enter second group of five digits: “);</p><p> scanf(“%1d%1d%1d%1d%1d”, &amp;j1, &amp;j2, &amp;j3, &amp;j4, &amp;j5);</p><p> printf(“Enter the last (single) digit: “);</p><p> scanf(“%1d”, &amp;check_digit);</p><p> first_sum = d + i2 + i4 + j1 + j3 + j5;</p><p> second_sum = i1 + i3 + i5 + j2 + j4;</p><p> total = 3 * first_sum + second_sum;</p><p> if (check_digit == 9 - ((total - 1) % 10))</p><p>  printf(“VALID\n”);</p><p> else</p><p>  printf(“NOT VALID\n”);</p><p> return 0;</p><p>}</p><p><strong>10.</strong> [was #14] </p><p>#include &lt;stdio.h&gt;</p><p>int main(void)</p><p>{</p><p> int grade;</p><p> printf(“Enter numerical grade: “);</p><p> scanf(“%d”, &amp;grade);</p><p> if (grade &lt; 0 || grade &gt; 100) {</p><p>  printf(“Illegal grade\n”);</p><p>  return 0;</p><p> }</p><p> switch (grade / 10) {</p><p>  case 10:</p><p>  case 9: printf(“Letter grade: A\n”);</p><p>​       break;</p><p>  case 8: printf(“Letter grade: B\n”);</p><p>​       break;</p><p>  case 7: printf(“Letter grade: C\n”);</p><p>​       break;</p><p>  case 6: printf(“Letter grade: D\n”);</p><p>​       break;</p><p>  case 5:</p><p>  case 4:</p><p>  case 3:</p><p>  case 2:</p><p>  case 1:</p><p>  case 0: printf(“Letter grade: F\n”);</p><p>​       break;</p><p> }</p><p> return 0;</p><p>}</p><h3 id="Chapter-6"><a href="#Chapter-6" class="headerlink" title="Chapter 6"></a>Chapter 6</h3><h4 id="Answers-to-Selected-Exercises-1"><a href="#Answers-to-Selected-Exercises-1" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>4.</strong> [was #10] (c) is not equivalent to (a) and (b), because <code>i</code> is incremented <em>before</em> the loop body is executed. </p><p><strong>10.</strong> [was #12] Consider the following <code>while</code> loop: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while (…) {</span><br><span class="line">  …</span><br><span class="line">  continue;</span><br><span class="line">  …</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>The equivalent code using <code>goto</code> would have the following appearance:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">while (…) {</span><br><span class="line">  …</span><br><span class="line">  goto loop_end;</span><br><span class="line">  …</span><br><span class="line">  loop_end: ;   /* null statement */</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>12.</strong> [was #14] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (d = 2; d * d &lt;= n; d++)</span><br><span class="line">  if (n % d == 0)</span><br><span class="line">    break;</span><br></pre></td></tr></tbody></table></figure><p>The <code>if</code> statement that follows the loop will need to be modified as well:</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (d * d &lt;= n)</span><br><span class="line">  printf("%d is divisible by %d\n", n, d);</span><br><span class="line">else</span><br><span class="line">  printf("%d is prime\n", n);</span><br></pre></td></tr></tbody></table></figure><p><strong>14.</strong> [was #16] The problem is the semicolon at the end of the first line. If we remove it, the statement is now correct: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (n % 2 == 0)</span><br><span class="line">  printf("n is even\n");</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-1"><a href="#Answers-to-Selected-Programming-Projects-1" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>2.</strong> [was #2] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int m, n, remainder;</span><br><span class="line"> </span><br><span class="line">  printf("Enter two integers: ");</span><br><span class="line">  scanf("%d%d", &amp;m, &amp;n);</span><br><span class="line"> </span><br><span class="line">  while (n != 0) {</span><br><span class="line">    remainder = m % n;</span><br><span class="line">    m = n;</span><br><span class="line">    n = remainder;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Greatest common divisor: %d\n", m);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #4] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  float commission, value;</span><br><span class="line"> </span><br><span class="line">  printf("Enter value of trade: ");</span><br><span class="line">  scanf("%f", &amp;value);</span><br><span class="line"> </span><br><span class="line">  while (value != 0.0f) {</span><br><span class="line">    if (value &lt; 2500.00f)</span><br><span class="line">      commission = 30.00f + .017f * value;</span><br><span class="line">    else if (value &lt; 6250.00f)</span><br><span class="line">      commission = 56.00f + .0066f * value;</span><br><span class="line">    else if (value &lt; 20000.00f)</span><br><span class="line">      commission = 76.00f + .0034f * value;</span><br><span class="line">    else if (value &lt; 50000.00f)</span><br><span class="line">      commission = 100.00f + .0022f * value;</span><br><span class="line">    else if (value &lt; 500000.00f)</span><br><span class="line">      commission = 155.00f + .0011f * value;</span><br><span class="line">    else</span><br><span class="line">      commission = 255.00f + .0009f * value;</span><br><span class="line"> </span><br><span class="line">    if (commission &lt; 39.00f)</span><br><span class="line">      commission = 39.00f;</span><br><span class="line"> </span><br><span class="line">    printf("Commission: $%.2f\n\n", commission);</span><br><span class="line"> </span><br><span class="line">    printf("Enter value of trade: ");</span><br><span class="line">    scanf("%f", &amp;value);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int i, n;</span><br><span class="line"> </span><br><span class="line">  printf("Enter limit on maximum square: ");</span><br><span class="line">  scanf("%d", &amp;n);</span><br><span class="line"> </span><br><span class="line">  for (i = 2; i * i &lt;= n; i += 2)</span><br><span class="line">    printf("%d\n", i * i);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>8.</strong> [was #8] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int i, n, start_day;</span><br><span class="line"> </span><br><span class="line">  printf("Enter number of days in month: ");</span><br><span class="line">  scanf("%d", &amp;n);</span><br><span class="line">  printf("Enter starting day of the week (1=Sun, 7=Sat): ");</span><br><span class="line">  scanf("%d", &amp;start_day);</span><br><span class="line"> </span><br><span class="line">  /* print any leading "blank dates" */</span><br><span class="line">  for (i = 1; i &lt; start_day; i++)</span><br><span class="line">    printf("   ");</span><br><span class="line"> </span><br><span class="line">  /* now print the calendar */</span><br><span class="line">  for (i = 1; i &lt;= n; i++) {</span><br><span class="line">    printf("%3d", i);</span><br><span class="line">    if ((start_day + i - 1) % 7 == 0)</span><br><span class="line">      printf("\n");</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-7"><a href="#Chapter-7" class="headerlink" title="Chapter 7"></a>Chapter 7</h3><h4 id="Answers-to-Selected-Exercises-2"><a href="#Answers-to-Selected-Exercises-2" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>3.</strong> [was #4] (b) is not legal. </p><p><strong>4.</strong> [was #6] (d) is illegal, since <code>printf</code> requires a string, not a character, as its first argument. </p><p><strong>10.</strong> [was #14] <code>unsigned</code> <code>int</code>, because the <code>(int)</code> cast applies only to <code>j</code>, not <code>j</code> <code>*</code> <code>k</code>. </p><p><strong>12.</strong> [was #16] The value of <code>i</code> is converted to <code>float</code> and added to <code>f</code>, then the result is converted to <code>double</code> and stored in <code>d</code>. </p><p><strong>14.</strong> [was #18] No. Converting <code>f</code> to <code>int</code> will fail if the value stored in <code>f</code> exceeds the largest value of type <code>int</code>. </p><h4 id="Answers-to-Selected-Programming-Projects-2"><a href="#Answers-to-Selected-Programming-Projects-2" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #2] <code>short</code> <code>int</code> values are usually stored in 16 bits, causing failure at 182. <code>int</code> and <code>long</code> <code>int</code> values are usually stored in 32 bits, with failure occurring at 46341. </p><p><strong>2.</strong> [was #8] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int i, n;</span><br><span class="line">  char ch;</span><br><span class="line"> </span><br><span class="line">  printf("This program prints a table of squares.\n");</span><br><span class="line">  printf("Enter number of entries in table: ");</span><br><span class="line">  scanf("%d", &amp;n);</span><br><span class="line">  ch = getchar();</span><br><span class="line">    /* dispose of new-line character following number of entries */</span><br><span class="line">    /* could simply be getchar(); */</span><br><span class="line"> </span><br><span class="line">  for (i = 1; i &lt;= n; i++) {</span><br><span class="line">    printf("%10d%10d\n", i, i * i);</span><br><span class="line">    if (i % 24 == 0) {</span><br><span class="line">      printf("Press Enter to continue...");</span><br><span class="line">      ch = getchar();   /* or simply getchar(); */</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #10] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int sum = 0;</span><br><span class="line">  char ch;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a word: ");</span><br><span class="line"> </span><br><span class="line">  while ((ch = getchar()) != '\n')</span><br><span class="line">    switch (toupper(ch)) {</span><br><span class="line">      case 'D': case 'G':</span><br><span class="line">        sum += 2; break;</span><br><span class="line">      case 'B': case 'C': case 'M': case 'P':</span><br><span class="line">        sum += 3; break;</span><br><span class="line">      case 'F': case 'H': case 'V': case 'W': case 'Y':</span><br><span class="line">        sum += 4; break;</span><br><span class="line">      case 'K':</span><br><span class="line">        sum += 5; break;</span><br><span class="line">      case 'J': case 'X':</span><br><span class="line">        sum += 8; break;</span><br><span class="line">      case 'Q': case 'Z':</span><br><span class="line">        sum += 10; break;</span><br><span class="line">      default:</span><br><span class="line">        sum++; break;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">  printf("Scrabble value: %d\n", sum);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #12] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  printf("Size of int: %d\n", (int) sizeof(int));</span><br><span class="line">  printf("Size of short: %d\n", (int) sizeof(short));</span><br><span class="line">  printf("Size of long: %d\n", (int) sizeof(long));</span><br><span class="line">  printf("Size of float: %d\n", (int) sizeof(float));</span><br><span class="line">  printf("Size of double: %d\n", (int) sizeof(double));</span><br><span class="line">  printf("Size of long double: %d\n", (int) sizeof(long double));</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Since the type of a <code>sizeof</code> expression may vary from one implementation to another, it’s necessary in C89 to cast <code>sizeof</code> expressions to a known type before printing them. The sizes of the basic types are small numbers, so it’s safe to cast them to <code>int</code>. (In general, however, it’s best to cast <code>sizeof</code> expressions to <code>unsigned</code> <code>long</code> and print them using <code>%lu</code>.) In C99, we can avoid the cast by using the <code>%zu</code> conversion specification.</p><h3 id="Chapter-8"><a href="#Chapter-8" class="headerlink" title="Chapter 8"></a>Chapter 8</h3><h4 id="Answers-to-Selected-Exercises-3"><a href="#Answers-to-Selected-Exercises-3" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>1.</strong> [was #4] The problem with <code>sizeof(a)</code> <code>/</code> <code>sizeof(</code><em>t</em><code>)</code> is that it can’t easily be checked for correctness by someone reading the program. (The reader would have to locate the declaration of <code>a</code> and make sure that its elements have type <em>t</em>.) </p><p><strong>2.</strong> [was #8] To use a digit <code>d</code> (in character form) as a subscript into the array <code>a</code>, we would write <code>a[d-'0']</code>. This assumes that digits have consecutive codes in the underlying character set, which is true of ASCII and other popular character sets. </p><p><strong>7.</strong> [was #10] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const int segments[10][7] = {{1, 1, 1, 1, 1, 1},</span><br><span class="line">                             {0, 1, 1},</span><br><span class="line">                             {1, 1, 0, 1, 1, 0, 1},</span><br><span class="line">                             {1, 1, 1, 1, 0, 0, 1},</span><br><span class="line">                             {0, 1, 1, 0, 0, 1, 1},</span><br><span class="line">                             {1, 0, 1, 1, 0, 1, 1},</span><br><span class="line">                             {1, 0, 1, 1, 1, 1, 1},</span><br><span class="line">                             {1, 1, 1},</span><br><span class="line">                             {1, 1, 1, 1, 1, 1, 1},</span><br><span class="line">                             {1, 1, 1, 1, 0, 1, 1}};</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-3"><a href="#Answers-to-Selected-Programming-Projects-3" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>2.</strong> [was #2] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int digit_count[10] = {0};</span><br><span class="line">  int digit;</span><br><span class="line">  long n;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a number: ");</span><br><span class="line">  scanf("%ld", &amp;n);</span><br><span class="line"> </span><br><span class="line">  while (n &gt; 0) {</span><br><span class="line">    digit = n % 10;</span><br><span class="line">    digit_count[digit]++;</span><br><span class="line">    n /= 10;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf ("Digit:      ");</span><br><span class="line">  for (digit = 0; digit &lt;= 9; digit++)</span><br><span class="line">    printf("%3d", digit);</span><br><span class="line">  printf("\nOccurrences:");</span><br><span class="line">  for (digit = 0; digit &lt;= 9; digit++)</span><br><span class="line">    printf("%3d", digit_count[digit]);</span><br><span class="line">  printf("\n");</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NUM_RATES ((int) (sizeof(value) / sizeof(value[0])))</span><br><span class="line">#define INITIAL_BALANCE 100.00</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int i, low_rate, month, num_years, year;</span><br><span class="line">  double value[5];</span><br><span class="line"> </span><br><span class="line">  printf("Enter interest rate: ");</span><br><span class="line">  scanf("%d", &amp;low_rate);</span><br><span class="line">  printf("Enter number of years: ");</span><br><span class="line">  scanf("%d", &amp;num_years);</span><br><span class="line"> </span><br><span class="line">  printf("\nYears");</span><br><span class="line">  for (i = 0; i &lt; NUM_RATES; i++) {</span><br><span class="line">    printf("%6d%%", low_rate + i);</span><br><span class="line">    value[i] = INITIAL_BALANCE;</span><br><span class="line">  }</span><br><span class="line">  printf("\n");</span><br><span class="line"> </span><br><span class="line">  for (year = 1; year &lt;= num_years; year++) {</span><br><span class="line">    printf("%3d    ", year);</span><br><span class="line">    for (i = 0; i &lt; NUM_RATES; i++) {</span><br><span class="line">      for (month = 1; month &lt;= 12; month++)</span><br><span class="line">        value[i] += ((double) (low_rate + i) / 12) / 100.0 * value[i];</span><br><span class="line">      printf("%7.2f", value[i]);</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>8.</strong> [was #12] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NUM_QUIZZES  5</span><br><span class="line">#define NUM_STUDENTS 5</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int grades[NUM_STUDENTS][NUM_QUIZZES];</span><br><span class="line">  int high, low, quiz, student, total;</span><br><span class="line"> </span><br><span class="line">  for (student = 0; student &lt; NUM_STUDENTS; student++) {</span><br><span class="line">    printf("Enter grades for student %d: ", student + 1);</span><br><span class="line">    for (quiz = 0; quiz &lt; NUM_QUIZZES; quiz++)</span><br><span class="line">      scanf("%d", &amp;grades[student][quiz]);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("\nStudent  Total  Average\n");</span><br><span class="line">  for (student = 0; student &lt; NUM_STUDENTS; student++) {</span><br><span class="line">    printf("%4d      ", student + 1);</span><br><span class="line">    total = 0;</span><br><span class="line">    for (quiz = 0; quiz &lt; NUM_QUIZZES; quiz++)</span><br><span class="line">      total += grades[student][quiz];</span><br><span class="line">    printf("%3d     %3d\n", total, total / NUM_QUIZZES);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("\nQuiz  Average  High  Low\n");</span><br><span class="line">  for (quiz = 0; quiz &lt; NUM_QUIZZES; quiz++) {</span><br><span class="line">    printf("%3d     ", quiz + 1);</span><br><span class="line">    total = 0;</span><br><span class="line">    high = 0;</span><br><span class="line">    low = 100;</span><br><span class="line">    for (student = 0; student &lt; NUM_STUDENTS; student++) {</span><br><span class="line">      total += grades[student][quiz];</span><br><span class="line">      if (grades[student][quiz] &gt; high)</span><br><span class="line">        high = grades[student][quiz];</span><br><span class="line">      if (grades[student][quiz] &lt; low)</span><br><span class="line">        low = grades[student][quiz];</span><br><span class="line">    }</span><br><span class="line">    printf("%3d    %3d   %3d\n", total / NUM_STUDENTS, high, low);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-9"><a href="#Chapter-9" class="headerlink" title="Chapter 9"></a>Chapter 9</h3><h4 id="Answers-to-Selected-Exercises-4"><a href="#Answers-to-Selected-Exercises-4" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int check(int x, int y, int n)</span><br><span class="line">{</span><br><span class="line">  return (x &gt;= 0 &amp;&amp; x &lt;= n - 1 &amp;&amp; y &gt;= 0 &amp;&amp; y &lt;= n - 1);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #4] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">int day_of_year(int month, int day, int year)</span><br><span class="line">{</span><br><span class="line">  int num_days[] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};</span><br><span class="line">  int day_count = 0, i;</span><br><span class="line"> </span><br><span class="line">  for (i = 1; i &lt; month; i++)</span><br><span class="line">    day_count += num_days[i-1];</span><br><span class="line"> </span><br><span class="line">  /* adjust for leap years, assuming they are divisible by 4 */</span><br><span class="line">  if (year % 4 == 0 &amp;&amp; month &gt; 2)</span><br><span class="line">    day_count++;</span><br><span class="line"> </span><br><span class="line">  return day_count + day;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Using the expression <code>year</code> <code>%</code> <code>4</code> <code>==</code> <code>0</code> to test for leap years is not completely correct. Centuries are special cases: if a year is a multiple of 100, then it must also be a multiple of 400 in order to be a leap year. The correct test is </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">year % 4 == 0 &amp;&amp; (year % 100 != 0 || year % 400 == 0)</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int digit(int n, int k)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 1; i &lt; k; i++)</span><br><span class="line">    n /= 10;</span><br><span class="line"> </span><br><span class="line">  return n % 10;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>8.</strong> [was #8] (a) and (b) are valid prototypes. (c) is illegal, since it doesn’t specify the type of the parameter. (d) incorrectly specifies that <code>f</code> returns an <code>int</code> value in C89; in C99, omitting the return type is illegal. </p><p><strong>10.</strong> [was #10] </p><p>(a)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int largest(int a[], int n)</span><br><span class="line">{</span><br><span class="line">  int i, max = a[0];</span><br><span class="line"> </span><br><span class="line">  for (i = 1; i &lt; n; i++)</span><br><span class="line">    if (a[i] &gt; max)</span><br><span class="line">      max = a[i];</span><br><span class="line"> </span><br><span class="line">  return max;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int average(int a[], int n)</span><br><span class="line">{</span><br><span class="line">  int i, avg = 0;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; n; i++)</span><br><span class="line">    avg += a[i];</span><br><span class="line"> </span><br><span class="line">  return avg / n;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int num_positive(int a[], int n)</span><br><span class="line">{</span><br><span class="line">  int i, count = 0;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; n; i++)</span><br><span class="line">    if (a[i] &gt; 0)</span><br><span class="line">      count++;</span><br><span class="line"> </span><br><span class="line">  return count;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>15.</strong> [was #12; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">double median(double x, double y, double z)</span><br><span class="line">{</span><br><span class="line">  double result;</span><br><span class="line"> </span><br><span class="line">  if (x &lt;= y)</span><br><span class="line">    if (y &lt;= z) result = y;</span><br><span class="line">    else if (x &lt;= z) result = z;</span><br><span class="line">    else result = x;</span><br><span class="line">  else {</span><br><span class="line">    if (z &lt;= y) result = y;</span><br><span class="line">    else if (x &lt;= z) result = x;</span><br><span class="line">    else result = z;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>17.</strong> [was #14] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int fact(int n)</span><br><span class="line">{</span><br><span class="line">  int i, result = 1;</span><br><span class="line"> </span><br><span class="line">  for (i = 2; i &lt;= n; i++)</span><br><span class="line">    result *= i;</span><br><span class="line"> </span><br><span class="line">  return result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>19.</strong> [was #16] The following program tests the <code>pb</code> function: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">void pb(int n);</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int n;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a number: ");</span><br><span class="line">  scanf("%d", &amp;n);</span><br><span class="line"> </span><br><span class="line">  printf("Output of pb: ");</span><br><span class="line">  pb(n);</span><br><span class="line">  printf("\n");</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void pb(int n)</span><br><span class="line">{</span><br><span class="line">  if (n != 0) {</span><br><span class="line">    pb(n / 2);</span><br><span class="line">    putchar('0' + n % 2);</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><code>pb</code> prints the binary representation of the argument <code>n</code>, assuming that <code>n</code> is greater than 0. (We also assume that digits have consecutive codes in the underlying character set.) For example: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Enter a number: 53</span><br><span class="line">Output of pb: 110101</span><br></pre></td></tr></tbody></table></figure><p>A trace of <code>pb</code>‘s execution would look like this: </p><p><code> pb(53)</code> finds that 53 is not equal to 0, so it calls<br> <code>  pb(26)</code>, which finds that 26 is not equal to 0, so it calls<br> <code>   pb(13)</code>, which finds that 13 is not equal to 0, so it calls<br> <code>    pb(6)</code>, which finds that 6 is not equal to 0, so it calls<br> <code>     pb(3)</code>, which finds that 3 is not equal to 0, so it calls<br> <code>      pb(1)</code>, which finds that 1 is not equal to 0, so it calls<br> <code>       pb(0)</code>, which finds that 0 <em>is</em> equal to 0, so it returns, causing<br> <code>      pb(1)</code> to print <code>1</code> and return, causing<br> <code>     pb(3)</code> to print <code>1</code> and return, causing<br> <code>    pb(6)</code> to print <code>0</code> and return, causing<br> <code>   pb(13)</code> to print <code>1</code> and return, causing<br> <code>  pb(26)</code> to print <code>0</code> and return, causing<br> <code> pb(53)</code> to print <code>1</code> and return. </p><h3 id="Chapter-10"><a href="#Chapter-10" class="headerlink" title="Chapter 10"></a>Chapter 10</h3><h4 id="Answers-to-Selected-Exercises-5"><a href="#Answers-to-Selected-Exercises-5" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>1.</strong> [was #2] (a) <code>a</code>, <code>b</code>, and <code>c</code> are visible.<br> (b) <code>a</code>, and <code>d</code> are visible.<br> (c) <code>a</code>, <code>d</code>, and <code>e</code> are visible.<br> (d) <code>a</code> and <code>f</code> are visible. </p><h4 id="Answers-to-Selected-Programming-Projects-4"><a href="#Answers-to-Selected-Programming-Projects-4" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>3.</strong> [was #4] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NUM_CARDS 5</span><br><span class="line">#define RANK 0</span><br><span class="line">#define SUIT 1</span><br><span class="line"> </span><br><span class="line">/* external variables */</span><br><span class="line">int hand[NUM_CARDS][2];</span><br><span class="line">/*    0    1</span><br><span class="line">    ____ ____</span><br><span class="line"> 0 |____|____|</span><br><span class="line"> 1 |____|____|</span><br><span class="line"> 2 |____|____|</span><br><span class="line"> 3 |____|____|</span><br><span class="line"> 4 |____|____|</span><br><span class="line">    rank suit</span><br><span class="line">*/</span><br><span class="line"> </span><br><span class="line">bool straight, flush, four, three;</span><br><span class="line">int pairs;   /* can be 0, 1, or 2 */</span><br><span class="line"> </span><br><span class="line">/* prototypes */</span><br><span class="line">void read_cards(void);</span><br><span class="line">void analyze_hand(void);</span><br><span class="line">void print_result(void);</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * main: Calls read_cards, analyze_hand, and print_result *</span><br><span class="line"> *       repeatedly.                                      *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  for (;;) {</span><br><span class="line">    read_cards();</span><br><span class="line">    analyze_hand();</span><br><span class="line">    print_result();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * read_cards: Reads the cards into the external variable *</span><br><span class="line"> *             hand; checks for bad cards and duplicate   *</span><br><span class="line"> *             cards.                                     *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void read_cards(void)</span><br><span class="line">{</span><br><span class="line">  char ch, rank_ch, suit_ch;</span><br><span class="line">  int i, rank, suit;</span><br><span class="line">  bool bad_card, duplicate_card;</span><br><span class="line">  int cards_read = 0;</span><br><span class="line"> </span><br><span class="line">  while (cards_read &lt; NUM_CARDS) {</span><br><span class="line">    bad_card = false;</span><br><span class="line"> </span><br><span class="line">    printf("Enter a card: ");</span><br><span class="line"> </span><br><span class="line">    rank_ch = getchar();</span><br><span class="line">    switch (rank_ch) {</span><br><span class="line">      case '0':           exit(EXIT_SUCCESS);</span><br><span class="line">      case '2':           rank = 0; break;</span><br><span class="line">      case '3':           rank = 1; break;</span><br><span class="line">      case '4':           rank = 2; break;</span><br><span class="line">      case '5':           rank = 3; break;</span><br><span class="line">      case '6':           rank = 4; break;</span><br><span class="line">      case '7':           rank = 5; break;</span><br><span class="line">      case '8':           rank = 6; break;</span><br><span class="line">      case '9':           rank = 7; break;</span><br><span class="line">      case 't': case 'T': rank = 8; break;</span><br><span class="line">      case 'j': case 'J': rank = 9; break;</span><br><span class="line">      case 'q': case 'Q': rank = 10; break;</span><br><span class="line">      case 'k': case 'K': rank = 11; break;</span><br><span class="line">      case 'a': case 'A': rank = 12; break;</span><br><span class="line">      default:            bad_card = true;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    suit_ch = getchar();</span><br><span class="line">    switch (suit_ch) {</span><br><span class="line">      case 'c': case 'C': suit = 0; break;</span><br><span class="line">      case 'd': case 'D': suit = 1; break;</span><br><span class="line">      case 'h': case 'H': suit = 2; break;</span><br><span class="line">      case 's': case 'S': suit = 3; break;</span><br><span class="line">      default:            bad_card = true;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    while ((ch = getchar()) != '\n')</span><br><span class="line">      if (ch != ' ') bad_card = true;</span><br><span class="line"> </span><br><span class="line">    if (bad_card) {</span><br><span class="line">      printf("Bad card; ignored.\n");</span><br><span class="line">      continue;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    duplicate_card = false;</span><br><span class="line">    for (i = 0; i &lt; cards_read; i++)</span><br><span class="line">      if (hand[i][RANK] == rank &amp;&amp; hand[i][SUIT] == suit) {</span><br><span class="line">        printf("Duplicate card; ignored.\n");</span><br><span class="line">        duplicate_card = true;</span><br><span class="line">        break;</span><br><span class="line">      }</span><br><span class="line"> </span><br><span class="line">    if (!duplicate_card) {</span><br><span class="line">      hand[cards_read][RANK] = rank;</span><br><span class="line">      hand[cards_read][SUIT] = suit;</span><br><span class="line">      cards_read++;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * analyze_hand: Determines whether the hand contains a   *</span><br><span class="line"> *               straight, a flush, four-of-a-kind,       *</span><br><span class="line"> *               and/or three-of-a-kind; determines the   *</span><br><span class="line"> *               number of pairs; stores the results into *</span><br><span class="line"> *               the external variables straight, flush,  *</span><br><span class="line"> *               four, three, and pairs.                  *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void analyze_hand(void)</span><br><span class="line">{</span><br><span class="line">  int rank, suit, card, pass, run;</span><br><span class="line"> </span><br><span class="line">  straight = true;</span><br><span class="line">  flush = true;</span><br><span class="line">  four = false;</span><br><span class="line">  three = false;</span><br><span class="line">  pairs = 0;</span><br><span class="line"> </span><br><span class="line">  /* sort cards by rank */</span><br><span class="line">  for (pass = 1; pass &lt; NUM_CARDS; pass++)</span><br><span class="line">    for (card = 0; card &lt; NUM_CARDS - pass; card++) {</span><br><span class="line">      rank = hand[card][RANK];</span><br><span class="line">      suit = hand[card][SUIT];</span><br><span class="line">      if (hand[card+1][RANK] &lt; rank) {</span><br><span class="line">        hand[card][RANK] = hand[card+1][RANK];</span><br><span class="line">        hand[card][SUIT] = hand[card+1][SUIT];</span><br><span class="line">        hand[card+1][RANK] = rank;</span><br><span class="line">        hand[card+1][SUIT] = suit;</span><br><span class="line">      }</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">  /* check for flush */</span><br><span class="line">  suit = hand[0][SUIT];</span><br><span class="line">  for (card = 1; card &lt; NUM_CARDS; card++)</span><br><span class="line">    if (hand[card][SUIT] != suit)</span><br><span class="line">      flush = false;</span><br><span class="line"> </span><br><span class="line">  /* check for straight */</span><br><span class="line">  for (card = 0; card &lt; NUM_CARDS - 1; card++)</span><br><span class="line">    if (hand[card][RANK] + 1 != hand[card+1][RANK])</span><br><span class="line">      straight = false;</span><br><span class="line"> </span><br><span class="line">  /* check for 4-of-a-kind, 3-of-a-kind, and pairs by</span><br><span class="line">     looking for "runs" of cards with identical ranks */</span><br><span class="line">  card = 0;</span><br><span class="line">  while (card &lt; NUM_CARDS) {</span><br><span class="line">    rank = hand[card][RANK];</span><br><span class="line">    run = 0;</span><br><span class="line">    do {</span><br><span class="line">      run++;</span><br><span class="line">      card++;</span><br><span class="line">    } while (card &lt; NUM_CARDS &amp;&amp; hand[card][RANK] == rank);</span><br><span class="line">    switch (run) {</span><br><span class="line">      case 2: pairs++;      break;</span><br><span class="line">      case 3: three = true; break;</span><br><span class="line">      case 4: four = true;  break;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * print_result: Prints the classification of the hand,   *</span><br><span class="line"> *               based on the values of the external      *</span><br><span class="line"> *               variables straight, flush, four, three,  *</span><br><span class="line"> *               and pairs.                               *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void print_result(void)</span><br><span class="line">{</span><br><span class="line">  if (straight &amp;&amp; flush) printf("Straight flush");</span><br><span class="line">  else if (four)         printf("Four of a kind");</span><br><span class="line">  else if (three &amp;&amp;</span><br><span class="line">           pairs == 1)   printf("Full house");</span><br><span class="line">  else if (flush)        printf("Flush");</span><br><span class="line">  else if (straight)     printf("Straight");</span><br><span class="line">  else if (three)        printf("Three of a kind");</span><br><span class="line">  else if (pairs == 2)   printf("Two pairs");</span><br><span class="line">  else if (pairs == 1)   printf("Pair");</span><br><span class="line">  else                   printf("High card");</span><br><span class="line"> </span><br><span class="line">  printf("\n\n");</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NUM_RANKS 13</span><br><span class="line">#define NUM_SUITS 4</span><br><span class="line">#define NUM_CARDS 5</span><br><span class="line"> </span><br><span class="line">/* external variables */</span><br><span class="line">int num_in_rank[NUM_RANKS];</span><br><span class="line">int num_in_suit[NUM_SUITS];</span><br><span class="line">bool straight, flush, four, three;</span><br><span class="line">int pairs;   /* can be 0, 1, or 2 */</span><br><span class="line"> </span><br><span class="line">/* prototypes */</span><br><span class="line">void read_cards(void);</span><br><span class="line">void analyze_hand(void);</span><br><span class="line">void print_result(void);</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * main: Calls read_cards, analyze_hand, and print_result *</span><br><span class="line"> *       repeatedly.                                      *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  for (;;) {</span><br><span class="line">    read_cards();</span><br><span class="line">    analyze_hand();</span><br><span class="line">    print_result();</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * read_cards: Reads the cards into the external          *</span><br><span class="line"> *             variables num_in_rank and num_in_suit;     *</span><br><span class="line"> *             checks for bad cards and duplicate cards.  *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void read_cards(void)</span><br><span class="line">{</span><br><span class="line">  bool card_exists[NUM_RANKS][NUM_SUITS];</span><br><span class="line">  char ch, rank_ch, suit_ch;</span><br><span class="line">  int rank, suit;</span><br><span class="line">  bool bad_card;</span><br><span class="line">  int cards_read = 0;</span><br><span class="line"> </span><br><span class="line">  for (rank = 0; rank &lt; NUM_RANKS; rank++) {</span><br><span class="line">    num_in_rank[rank] = 0;</span><br><span class="line">    for (suit = 0; suit &lt; NUM_SUITS; suit++)</span><br><span class="line">      card_exists[rank][suit] = false;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  for (suit = 0; suit &lt; NUM_SUITS; suit++)</span><br><span class="line">    num_in_suit[suit] = 0;</span><br><span class="line"> </span><br><span class="line">  while (cards_read &lt; NUM_CARDS) {</span><br><span class="line">    bad_card = false;</span><br><span class="line"> </span><br><span class="line">    printf("Enter a card: ");</span><br><span class="line"> </span><br><span class="line">    rank_ch = getchar();</span><br><span class="line">    switch (rank_ch) {</span><br><span class="line">      case '0':           exit(EXIT_SUCCESS);</span><br><span class="line">      case '2':           rank = 0; break;</span><br><span class="line">      case '3':           rank = 1; break;</span><br><span class="line">      case '4':           rank = 2; break;</span><br><span class="line">      case '5':           rank = 3; break;</span><br><span class="line">      case '6':           rank = 4; break;</span><br><span class="line">      case '7':           rank = 5; break;</span><br><span class="line">      case '8':           rank = 6; break;</span><br><span class="line">      case '9':           rank = 7; break;</span><br><span class="line">      case 't': case 'T': rank = 8; break;</span><br><span class="line">      case 'j': case 'J': rank = 9; break;</span><br><span class="line">      case 'q': case 'Q': rank = 10; break;</span><br><span class="line">      case 'k': case 'K': rank = 11; break;</span><br><span class="line">      case 'a': case 'A': rank = 12; break;</span><br><span class="line">      default:            bad_card = true;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    suit_ch = getchar();</span><br><span class="line">    switch (suit_ch) {</span><br><span class="line">      case 'c': case 'C': suit = 0; break;</span><br><span class="line">      case 'd': case 'D': suit = 1; break;</span><br><span class="line">      case 'h': case 'H': suit = 2; break;</span><br><span class="line">      case 's': case 'S': suit = 3; break;</span><br><span class="line">      default:            bad_card = true;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    while ((ch = getchar()) != '\n')</span><br><span class="line">      if (ch != ' ') bad_card = true;</span><br><span class="line"> </span><br><span class="line">    if (bad_card)</span><br><span class="line">      printf("Bad card; ignored.\n");</span><br><span class="line">    else if (card_exists[rank][suit])</span><br><span class="line">      printf("Duplicate card; ignored.\n");</span><br><span class="line">    else {</span><br><span class="line">      num_in_rank[rank]++;</span><br><span class="line">      num_in_suit[suit]++;</span><br><span class="line">      card_exists[rank][suit] = true;</span><br><span class="line">      cards_read++;</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * analyze_hand: Determines whether the hand contains a   *</span><br><span class="line"> *               straight, a flush, four-of-a-kind,       *</span><br><span class="line"> *               and/or three-of-a-kind; determines the   *</span><br><span class="line"> *               number of pairs; stores the results into *</span><br><span class="line"> *               the external variables straight, flush,  *</span><br><span class="line"> *               four, three, and pairs.                  *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void analyze_hand(void)</span><br><span class="line">{</span><br><span class="line">  int num_consec = 0;</span><br><span class="line">  int rank, suit;</span><br><span class="line"> </span><br><span class="line">  straight = false;</span><br><span class="line">  flush = false;</span><br><span class="line">  four = false;</span><br><span class="line">  three = false;</span><br><span class="line">  pairs = 0;</span><br><span class="line"> </span><br><span class="line">  /* check for flush */</span><br><span class="line">  for (suit = 0; suit &lt; NUM_SUITS; suit++)</span><br><span class="line">    if (num_in_suit[suit] == NUM_CARDS)</span><br><span class="line">      flush = true;</span><br><span class="line"> </span><br><span class="line">  /* check for straight */</span><br><span class="line">  rank = 0;</span><br><span class="line">  while (num_in_rank[rank] == 0) rank++;</span><br><span class="line">  for (; rank &lt; NUM_RANKS &amp;&amp; num_in_rank[rank] &gt; 0; rank++)</span><br><span class="line">    num_consec++;</span><br><span class="line">  if (num_consec == NUM_CARDS) {</span><br><span class="line">    straight = true;</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  /* check for ace-low straight */</span><br><span class="line">  if (num_consec == NUM_CARDS - 1 &amp;&amp;</span><br><span class="line">      num_in_rank[0] &gt; 0 &amp;&amp; num_in_rank[NUM_RANKS-1] &gt; 0) {</span><br><span class="line">    straight = true;</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  /* check for 4-of-a-kind, 3-of-a-kind, and pairs */</span><br><span class="line">  for (rank = 0; rank &lt; NUM_RANKS; rank++) {</span><br><span class="line">    if (num_in_rank[rank] == 4) four = true;</span><br><span class="line">    if (num_in_rank[rank] == 3) three = true;</span><br><span class="line">    if (num_in_rank[rank] == 2) pairs++;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * print_result: Prints the classification of the hand,   *</span><br><span class="line"> *               based on the values of the external      *</span><br><span class="line"> *               variables straight, flush, four, three,  *</span><br><span class="line"> *               and pairs.                               *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void print_result(void)</span><br><span class="line">{</span><br><span class="line">  if (straight &amp;&amp; flush) printf("Straight flush");</span><br><span class="line">  else if (four)         printf("Four of a kind");</span><br><span class="line">  else if (three &amp;&amp;</span><br><span class="line">           pairs == 1)   printf("Full house");</span><br><span class="line">  else if (flush)        printf("Flush");</span><br><span class="line">  else if (straight)     printf("Straight");</span><br><span class="line">  else if (three)        printf("Three of a kind");</span><br><span class="line">  else if (pairs == 2)   printf("Two pairs");</span><br><span class="line">  else if (pairs == 1)   printf("Pair");</span><br><span class="line">  else                   printf("High card");</span><br><span class="line"> </span><br><span class="line">  printf("\n\n");</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-11"><a href="#Chapter-11" class="headerlink" title="Chapter 11"></a>Chapter 11</h3><h4 id="Answers-to-Selected-Exercises-6"><a href="#Answers-to-Selected-Exercises-6" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] (e), (f), and (i) are legal. (a) is illegal because <code>p</code> is a pointer to an integer and <code>i</code> is an integer. (b) is illegal because <code>*p</code> is an integer and <code>&amp;i</code> is a pointer to an integer. (c) is illegal because <code>&amp;p</code> is a pointer to a pointer to an integer and <code>q</code> is a pointer to an integer. (d) is illegal for reasons similar to (c). (g) is illegal because <code>p</code> is a pointer to an integer and <code>*q</code> is an integer. (h) is illegal because <code>*p</code> is an integer and <code>q</code> is a pointer to an integer. </p><p><strong>4.</strong> [was #4; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">void swap(int *p, int *q)</span><br><span class="line">{</span><br><span class="line">  int temp;</span><br><span class="line"> </span><br><span class="line">  temp = *p;</span><br><span class="line">  *p = *q;</span><br><span class="line">  *q = temp;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">void find_two_largest(int a[], int n, int *largest,</span><br><span class="line">                      int *second_largest)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  if (a[0] &gt; a[1]) {</span><br><span class="line">    *largest = a[0];</span><br><span class="line">    *second_largest = a[1];</span><br><span class="line">  } else {</span><br><span class="line">    *largest = a[1];</span><br><span class="line">    *second_largest = a[0];</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  for (i = 2; i &lt; n; i++)</span><br><span class="line">    if (a[i] &gt; *largest) {</span><br><span class="line">      *second_largest = *largest;</span><br><span class="line">      *largest = a[i];</span><br><span class="line">    } else if (a[i] &gt; *second_largest)</span><br><span class="line">      *second_largest = a[i];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-12"><a href="#Chapter-12" class="headerlink" title="Chapter 12"></a>Chapter 12</h3><h4 id="Answers-to-Selected-Exercises-7"><a href="#Answers-to-Selected-Exercises-7" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] The statement is illegal because pointers cannot be added. Here’s a legal statement that has the desired effect: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">middle = low + (high - low) / 2;</span><br></pre></td></tr></tbody></table></figure><p>The value of <code>(high</code> <code>-</code> <code>low)</code> <code>/</code> <code>2</code> is an integer, not a pointer, so it can legally be added to <code>low</code>. </p><p><strong>4.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">int *top_ptr;</span><br><span class="line"> </span><br><span class="line">void make_empty(void)</span><br><span class="line">{</span><br><span class="line">  top_ptr = &amp;contents[0];</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_empty(void)</span><br><span class="line">{</span><br><span class="line">  return top_ptr == &amp;contents[0];</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_full(void)</span><br><span class="line">{</span><br><span class="line">  return top_ptr == &amp;contents[STACK_SIZE];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #10; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int sum_array(const int a[], int n)</span><br><span class="line">{</span><br><span class="line">  int *p, sum;</span><br><span class="line"> </span><br><span class="line">  sum = 0;</span><br><span class="line">  for (p = a; p &lt; a + n; p++)</span><br><span class="line">    sum += *p;</span><br><span class="line">  return sum;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>13.</strong> [was #12; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#define N 10</span><br><span class="line"> </span><br><span class="line">double ident[N][N], *p;</span><br><span class="line">int num_zeros = N;</span><br><span class="line"> </span><br><span class="line">for (p = &amp;ident[0][0]; p &lt;= &amp;ident[N-1][N-1]; p++)</span><br><span class="line">  if (num_zeros == N) {</span><br><span class="line">    *p = 1.0;</span><br><span class="line">    num_zeros = 0;</span><br><span class="line">  } else {</span><br><span class="line">    *p = 0.0;</span><br><span class="line">    num_zeros++;</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><p><strong>15.</strong> [was #14] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int *p;</span><br><span class="line"> </span><br><span class="line">for (p = temperatures[i]; p &lt; temperatures[i] + 24; p++)</span><br><span class="line">  printf("%d ", *p);</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-5"><a href="#Answers-to-Selected-Programming-Projects-5" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #4] </p><p>(a)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define MSG_LEN 80     /* maximum length of message */</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char msg[MSG_LEN];</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a message: ");</span><br><span class="line">  for (i = 0; i &lt; MSG_LEN; i++) {</span><br><span class="line">    msg[i] = getchar();</span><br><span class="line">    if (msg[i] == '\n')</span><br><span class="line">      break;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Reversal is: ");</span><br><span class="line">  for (i--; i &gt;= 0; i--)</span><br><span class="line">    putchar(msg[i]);</span><br><span class="line">  putchar('\n');</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define MSG_LEN 80     /* maximum length of message */</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char msg[MSG_LEN], *p;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a message: ");</span><br><span class="line">  for (p = &amp;msg[0]; p &lt; &amp;msg[MSG_LEN]; p++) {</span><br><span class="line">    *p = getchar();</span><br><span class="line">    if (*p == '\n')</span><br><span class="line">      break;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Reversal is: ");</span><br><span class="line">  for (p--; p &gt;= &amp;msg[0]; p--)</span><br><span class="line">    putchar(*p);</span><br><span class="line">  putchar('\n');</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>3.</strong> [was #8] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define MSG_LEN 80     /* maximum length of message */</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char msg[MSG_LEN], *p;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a message: ");</span><br><span class="line">  for (p = msg; p &lt; msg + MSG_LEN; p++) {</span><br><span class="line">    *p = getchar();</span><br><span class="line">    if (*p == '\n')</span><br><span class="line">      break;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Reversal is: ");</span><br><span class="line">  for (p--; p &gt;= msg; p--)</span><br><span class="line">    putchar(*p);</span><br><span class="line">  putchar('\n');</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-13"><a href="#Chapter-13" class="headerlink" title="Chapter 13"></a>Chapter 13</h3><h4 id="Answers-to-Selected-Exercises-8"><a href="#Answers-to-Selected-Exercises-8" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] </p><p>(a) Illegal; <code>p</code> is not a character.<br> (b) Legal; output is <code>a</code>.<br> (c) Legal; output is <code>abc</code>.<br> (d) Illegal; <code>*p</code> is not a pointer. </p><p><strong>4.</strong> [was #4] </p><p>(a)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int read_line(char str[], int n)</span><br><span class="line">{</span><br><span class="line">  int ch, i = 0;</span><br><span class="line"> </span><br><span class="line">  while ((ch = getchar()) != '\n')</span><br><span class="line">    if (i == 0 &amp;&amp; isspace(ch))</span><br><span class="line">      ;   /* ignore */</span><br><span class="line">    else if (i &lt; n)</span><br><span class="line">      str[i++] = ch;</span><br><span class="line">  str[i] = '\0';</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int read_line(char str[], int n)</span><br><span class="line">{</span><br><span class="line">  int ch, i = 0;</span><br><span class="line"> </span><br><span class="line">  while (!isspace(ch = getchar()))</span><br><span class="line">    if (i &lt; n)</span><br><span class="line">      str[i++] = ch;</span><br><span class="line">  str[i] = '\0';</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int read_line(char str[], int n)</span><br><span class="line">{</span><br><span class="line">  int ch, i = 0;</span><br><span class="line"> </span><br><span class="line">  do {</span><br><span class="line">    ch = getchar();</span><br><span class="line">    if (i &lt; n)</span><br><span class="line">      str[i++] = ch;</span><br><span class="line">  } while (ch != '\n');</span><br><span class="line">  str[i] = '\0';</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(d)</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int read_line(char str[], int n)</span><br><span class="line">{</span><br><span class="line">  int ch, i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; n; i++) {</span><br><span class="line">    ch = getchar();</span><br><span class="line">    if (ch == '\n')</span><br><span class="line">      break;</span><br><span class="line">    str[i] = ch;</span><br><span class="line">  }</span><br><span class="line">  str[i] = '\0';</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">void censor(char s[])</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; s[i] != '\0'; i++)</span><br><span class="line">    if (s[i] == 'f' &amp;&amp; s[i+1] == 'o' &amp;&amp; s[i+2] =='o')</span><br><span class="line">      s[i] = s[i+1] = s[i+2] = 'x';</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Note that the short-circuit evaluation of <code>&amp;&amp;</code> prevents the <code>if</code> statement from testing characters that follow the null character. </p><p><strong>8.</strong> [was #10] <code>tired-or-wired?</code></p><p><strong>10.</strong> [was #12] The value of <code>q</code> is undefined, so the call of <code>strcpy</code> attempts to copy the string pointed to by <code>p</code> into some unknown area of memory. Exercise 2 in Chapter 17 discusses how to write this function correctly. </p><p><strong>15.</strong> [was #8] </p><p>(a) 3<br> (b) 0<br> (c) The length of the longest prefix of the string <code>s</code> that consists entirely of characters from the string <code>t</code>. Or, equivalently, the position of the first character in <code>s</code> that is not also in <code>t</code>.</p><p><strong>16.</strong> [was #16] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">int count_spaces(const char *s)</span><br><span class="line">{</span><br><span class="line">  int count = 0;</span><br><span class="line"> </span><br><span class="line">  while (*s)</span><br><span class="line">    if (*s++ == ' ')</span><br><span class="line">      count++;</span><br><span class="line">  return count;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-6"><a href="#Answers-to-Selected-Programming-Projects-6" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #14] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"> </span><br><span class="line">#define WORD_LEN 20</span><br><span class="line"> </span><br><span class="line">void read_line(char str[], int n);</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char smallest_word[WORD_LEN+1],</span><br><span class="line">       largest_word[WORD_LEN+1],</span><br><span class="line">       current_word[WORD_LEN+1];</span><br><span class="line"> </span><br><span class="line">  printf("Enter word: ");</span><br><span class="line">  read_line(current_word, WORD_LEN);</span><br><span class="line">  strcpy(smallest_word, strcpy(largest_word, current_word));</span><br><span class="line"> </span><br><span class="line">  while (strlen(current_word) != 4) {</span><br><span class="line">    printf("Enter word: ");</span><br><span class="line">    read_line(current_word, WORD_LEN);</span><br><span class="line">    if (strcmp(current_word, smallest_word) &lt; 0)</span><br><span class="line">      strcpy(smallest_word, current_word);</span><br><span class="line">    if (strcmp(current_word, largest_word) &gt; 0)</span><br><span class="line">      strcpy(largest_word, current_word);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("\nSmallest word: %s\n", smallest_word);</span><br><span class="line">  printf("Largest word: %s\n", largest_word);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void read_line(char str[], int n)</span><br><span class="line">{</span><br><span class="line">  int ch, i = 0;</span><br><span class="line"> </span><br><span class="line">  while ((ch = getchar()) != '\n')</span><br><span class="line">    if (i &lt; n)</span><br><span class="line">      str[i++] = ch;</span><br><span class="line">  str[i] = '\0';</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #18] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = argc - 1; i &gt; 0; i--)</span><br><span class="line">    printf("%s ", argv[i]);</span><br><span class="line">  printf("\n");</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #20] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NUM_PLANETS 9</span><br><span class="line"> </span><br><span class="line">int string_equal(const char *s, const char *t);</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  char *planets[] = {"Mercury", "Venus", "Earth",</span><br><span class="line">                     "Mars", "Jupiter", "Saturn",</span><br><span class="line">                     "Uranus", "Neptune", "Pluto"};</span><br><span class="line">  int i, j;</span><br><span class="line"> </span><br><span class="line">  for (i = 1; i &lt; argc; i++) {</span><br><span class="line">    for (j = 0; j &lt; NUM_PLANETS; j++)</span><br><span class="line">      if (string_equal(argv[i], planets[j])) {</span><br><span class="line">        printf("%s is planet %d\n", argv[i], j + 1);</span><br><span class="line">        break;</span><br><span class="line">      }</span><br><span class="line">    if (j == NUM_PLANETS)</span><br><span class="line">      printf("%s is not a planet\n", argv[i]);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int string_equal(const char *s, const char *t)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; toupper(s[i]) == toupper(t[i]); i++)</span><br><span class="line">    if (s[i] == '\0')</span><br><span class="line">      return 1;</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-14"><a href="#Chapter-14" class="headerlink" title="Chapter 14"></a>Chapter 14</h3><h4 id="Answers-to-Selected-Exercises-9"><a href="#Answers-to-Selected-Exercises-9" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] <code>#define NELEMS(a) ((int) (sizeof(a) / sizeof(a[0])))</code> </p><p><strong>4.</strong> [was #4] </p><p>(a) One problem stems from the lack of parentheses around the replacement list. For example, the statement </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = 1/AVG(b, c);</span><br></pre></td></tr></tbody></table></figure><p>will be replaced by </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = 1/(b+c)/2;</span><br></pre></td></tr></tbody></table></figure><p>Even if we add the missing parentheses, though, the macro still has problems, because it needs parentheses around <code>x</code> and <code>y</code> in the replacement list. The preprocessor will turn the statement </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = AVG(b&lt;c, c&gt;d);</span><br></pre></td></tr></tbody></table></figure><p>into </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = ((b&lt;c+c&gt;d)/2);</span><br></pre></td></tr></tbody></table></figure><p>which is equivalent to </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = ((b&lt;(c+c)&gt;d)/2);</span><br></pre></td></tr></tbody></table></figure><p>Here’s the final (corrected) version of the macro: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define AVG(x,y) (((x)+(y))/2)</span><br></pre></td></tr></tbody></table></figure><p>(b) The problem is the lack of parentheses around the replacement list. For example, </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = 1/AREA(b, c);</span><br></pre></td></tr></tbody></table></figure><p>becomes </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a = 1/(b)*(c);</span><br></pre></td></tr></tbody></table></figure><p>Here’s the corrected macro: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define AREA(x,y) ((x)*(y))</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #6] </p><p>(a) The call of <code>putchar</code> expands into the following statement: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">putchar(('a'&lt;=(s[++i])&amp;&amp;(s[++i])&lt;='z'?(s[++i])-'a'+'A':(s[++i])));</span><br></pre></td></tr></tbody></table></figure><p>The character <code>a</code> is less than or equal to <code>s[1]</code> (which is <code>b</code>), yielding a true condition. The character <code>s[2]</code> (which is <code>c</code>) is less than or equal to <code>z</code>, which is also true. The value printed is <code>s[3]-'a'+'A'</code>, which is <code>D</code> (assuming that the character set is ASCII). </p><p>(b) The character <code>a</code> is not less than or equal to <code>s[1]</code> (which is <code>1</code>) so the test condition is false. The value printed is <code>s[2]</code>, which is <code>2</code>. </p><p><strong>7.</strong> [was #8] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">long long_max(long x, long y)</span><br><span class="line">{</span><br><span class="line">  return x &gt; y ? x : y;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>The preprocessor would actually put all the tokens on one line, but this version is more readable. </p><p>(b) The problem with types such as <code>unsigned</code> <code>long</code> is that they require two words, which prevents <code>GENERIC_MAX</code> from creating the desired function name. For example, <code>GENERIC_MAX(unsigned</code> <code>long)</code> would expand into </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unsigned long unsigned long_max(unsigned long x, unsigned long y)</span><br><span class="line">{</span><br><span class="line">  return x &gt; y ? x : y;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c) To make <code>GENERIC_MAX</code> work with any basic type, use a type definition to rename the type: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">typedef unsigned long ULONG;</span><br></pre></td></tr></tbody></table></figure><p>We can now write <code>GENERIC_MAX(ULONG)</code>. </p><p><strong>12.</strong> [was #10] (c) and (e) will fail, since <code>M</code> is defined. </p><p><strong>14.</strong> [was #12; modified] Here’s what the program will look like after preprocessing: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int a[= 10], i, j, k, m;</span><br><span class="line"> </span><br><span class="line">Blank line</span><br><span class="line">  i = j;</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line">Blank line</span><br><span class="line"> </span><br><span class="line">  i = 10 * j+1;</span><br><span class="line">  i = (x,y) x-y(j, k);</span><br><span class="line">  i = ((((j)*(j)))*(((j)*(j))));</span><br><span class="line">  i = (((j)*(j))*(j));</span><br><span class="line">  i = jk;</span><br><span class="line">  puts("i" "j");</span><br><span class="line"> </span><br><span class="line">Blank line</span><br><span class="line">  i = SQR(j);</span><br><span class="line">Blank line</span><br><span class="line">  i = (j);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Some preprocessors delete white-space characters at the beginning of a line, so your results may vary. Three lines will cause errors when the program is compiled. Two contain syntax errors: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int a[= 10], i, j, k, m;</span><br><span class="line">i = (x,y) x-y(j, k);</span><br></pre></td></tr></tbody></table></figure><p>The third refers to an undefined variable: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = jk;</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-15"><a href="#Chapter-15" class="headerlink" title="Chapter 15"></a>Chapter 15</h3><h4 id="Answers-to-Selected-Exercises-10"><a href="#Answers-to-Selected-Exercises-10" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] (b). Function definitions should not be put in a header file. If a function definition appears in a header file that is included by two (or more) source files, the program can’t be linked, since the linker will see two copies of the function. </p><p><strong>6.</strong> [was #8] </p><p>(a) <code>main.c</code>, <code>f1.c</code>, and <code>f2.c</code>.<br> (b) <code>f1.c</code> (assuming that <code>f1.h</code> is not affected by the change).<br> (c) <code>main.c</code>, <code>f1.c</code>, and <code>f2.c</code>, since all three include <code>f1.h</code>.<br> (d) <code>f1.c</code> and <code>f2.c</code>, since both include <code>f2.h</code>.</p><h3 id="Chapter-16"><a href="#Chapter-16" class="headerlink" title="Chapter 16"></a>Chapter 16</h3><h4 id="Answers-to-Selected-Exercises-11"><a href="#Answers-to-Selected-Exercises-11" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2; modified] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">struct {</span><br><span class="line">  double real, imaginary;</span><br><span class="line">} c1, c2, c3;</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">struct {</span><br><span class="line">  double real, imaginary;</span><br><span class="line">} c1 = {0.0, 1.0}, c2 = {1.0, 0.0}, c3;</span><br></pre></td></tr></tbody></table></figure><p>(c) Only one statement is necessary: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c1 = c2;</span><br></pre></td></tr></tbody></table></figure><p>(d) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c3.real = c1.real + c2.real;</span><br><span class="line">c3.imaginary = c1.imaginary + c2.imaginary;</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #4; modified] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">typedef struct {</span><br><span class="line">  double real, imaginary;</span><br><span class="line">} Complex;</span><br></pre></td></tr></tbody></table></figure><p>(b) <code>Complex c1, c2, c3;</code> </p><p>(c) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Complex make_complex(double real, double imaginary)</span><br><span class="line">{</span><br><span class="line">  Complex c;</span><br><span class="line"> </span><br><span class="line">  c.real = real;</span><br><span class="line">  c.imaginary = imaginary;</span><br><span class="line">  return c;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(d) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Complex add_complex(Complex c1, Complex c2)</span><br><span class="line">{</span><br><span class="line">  Complex c3;</span><br><span class="line"> </span><br><span class="line">  c3.real = c1.real + c2.real;</span><br><span class="line">  c3.imaginary = c1.imaginary + c2.imaginary;</span><br><span class="line">  return c3;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>11.</strong> [was #10; modified] The <code>a</code> member will occupy 8 bytes, the union <code>e</code> will take 8 bytes (the largest member, <code>c</code>, is 8 bytes long), and the array <code>f</code> will require 4 bytes, so the total space allocated for <code>s</code> will be 20 bytes. </p><p><strong>14.</strong> [was #12; modified] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">double area(struct shape s)</span><br><span class="line">{</span><br><span class="line">  if (s.shape_kind == RECTANGLE)</span><br><span class="line">    return s.u.rectangle.height * s.u.rectangle.width;</span><br><span class="line">  else</span><br><span class="line">    return 3.14159 * s.u.circle.radius * s.u.circle.radius;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">struct shape move(struct shape s, int x, int y)</span><br><span class="line">{</span><br><span class="line">  struct shape new_shape = s;</span><br><span class="line"> </span><br><span class="line">  new_shape.center.x += x;</span><br><span class="line">  new_shape.center.y += y;</span><br><span class="line">  return new_shape;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">struct shape scale(struct shape s, double c)</span><br><span class="line">{</span><br><span class="line">  struct shape new_shape = s;</span><br><span class="line"> </span><br><span class="line">  if (new_shape.shape_kind == RECTANGLE) {</span><br><span class="line">    new_shape.u.rectangle.height *= c;</span><br><span class="line">    new_shape.u.rectangle.width *= c;</span><br><span class="line">  } else</span><br><span class="line">    new_shape.u.circle.radius *= c;</span><br><span class="line"> </span><br><span class="line">  return new_shape;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>15.</strong> [was #14] </p><p>(a) <code>enum week_days {MON, TUE, WED, THU, FRI, SAT, SUN};</code><br> (b) <code>typedef enum {MON, TUE, WED, THU, FRI, SAT, SUN} Week_days;</code> </p><p><strong>17.</strong> [was #16] All the statements are legal, since C allows integers and enumeration values to be mixed without restriction. Only (a), (d), and (e) are safe. (b) is not meaningful if <code>i</code> has a value other than 0 or 1. (c) will not yield a meaningful result if <code>b</code> has the value 1. </p><h4 id="Answers-to-Selected-Programming-Projects-7"><a href="#Answers-to-Selected-Programming-Projects-7" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #6; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">#define COUNTRY_COUNT \</span><br><span class="line">  ((int) (sizeof(country_codes) / sizeof(country_codes[0])))</span><br><span class="line"> </span><br><span class="line">struct dialing_code {</span><br><span class="line">  char *country;</span><br><span class="line">  int code;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">const struct dialing_code country_codes[] =</span><br><span class="line">  {{"Argentina",            54}, {"Bangladesh",      880},</span><br><span class="line">   {"Brazil",               55}, {"Burma (Myanmar)",  95},</span><br><span class="line">   {"China",                86}, {"Colombia",         57},</span><br><span class="line">   {"Congo, Dem. Rep. of", 243}, {"Egypt",            20},</span><br><span class="line">   {"Ethiopia",            251}, {"France",           33},</span><br><span class="line">   {"Germany",              49}, {"India",            91},</span><br><span class="line">   {"Indonesia",            62}, {"Iran",             98},</span><br><span class="line">   {"Italy",                39}, {"Japan",            81},</span><br><span class="line">   {"Mexico",               52}, {"Nigeria",         234},</span><br><span class="line">   {"Pakistan",             92}, {"Philippines",      63},</span><br><span class="line">   {"Poland",               48}, {"Russia",            7},</span><br><span class="line">   {"South Africa",         27}, {"South Korea",      82},</span><br><span class="line">   {"Spain",                34}, {"Sudan",           249},</span><br><span class="line">   {"Thailand",             66}, {"Turkey",           90},</span><br><span class="line">   {"Ukraine",             380}, {"United Kingdom",   44},</span><br><span class="line">   {"United States",         1}, {"Vietnam",          84}};</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int code, i;</span><br><span class="line"> </span><br><span class="line">  printf("Enter dialing code: ");</span><br><span class="line">  scanf("%d", &amp;code);</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; COUNTRY_COUNT; i++)</span><br><span class="line">    if (code == country_codes[i].code) {</span><br><span class="line">      printf("The country with dialing code %d is %s\n",</span><br><span class="line">             code, country_codes[i].country);</span><br><span class="line">      return 0;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">  printf("No corresponding country found\n");</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>3.</strong> [was #8] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include "readline.h"</span><br><span class="line"> </span><br><span class="line">#define NAME_LEN 25</span><br><span class="line">#define MAX_PARTS 100</span><br><span class="line"> </span><br><span class="line">struct part {</span><br><span class="line">  int number;</span><br><span class="line">  char name[NAME_LEN+1];</span><br><span class="line">  int on_hand;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">int find_part(int number, const struct part inv[], int np);</span><br><span class="line">void insert(struct part inv[], int *np);</span><br><span class="line">void search(const struct part inv[], int np);</span><br><span class="line">void update(struct part inv[], int np);</span><br><span class="line">void print(const struct part inv[], int np);</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * main: Prompts the user to enter an operation code,     *</span><br><span class="line"> *       then calls a function to perform the requested   *</span><br><span class="line"> *       action. Repeats until the user enters the        *</span><br><span class="line"> *       command 'q'. Prints an error message if the user *</span><br><span class="line"> *       enters an illegal code.                          *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char code;</span><br><span class="line">  struct part inventory[MAX_PARTS];</span><br><span class="line">  int num_parts = 0;</span><br><span class="line"> </span><br><span class="line">  for (;;) {</span><br><span class="line">    printf("Enter operation code: ");</span><br><span class="line">    scanf(" %c", &amp;code);</span><br><span class="line">    while (getchar() != '\n')   /* skips to end of line */</span><br><span class="line">      ;</span><br><span class="line">    switch (code) {</span><br><span class="line">      case 'i': insert(inventory, &amp;num_parts);</span><br><span class="line">                break;</span><br><span class="line">      case 's': search(inventory, num_parts);</span><br><span class="line">                break;</span><br><span class="line">      case 'u': update(inventory, num_parts);</span><br><span class="line">                break;</span><br><span class="line">      case 'p': print(inventory, num_parts);</span><br><span class="line">                break;</span><br><span class="line">      case 'q': return 0;</span><br><span class="line">      default:  printf("Illegal code\n");</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * find_part: Looks up a part number in the inv array.    *</span><br><span class="line"> *            Returns the array index if the part number  *</span><br><span class="line"> *            is found; otherwise, returns -1.            *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int find_part(int number, const struct part inv[], int np)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; np; i++)</span><br><span class="line">    if (inv[i].number == number)</span><br><span class="line">      return i;</span><br><span class="line">  return -1;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * insert: Prompts the user for information about a new   *</span><br><span class="line"> *         part and then inserts the part into the inv    *</span><br><span class="line"> *         array. Prints an error message and returns     *</span><br><span class="line"> *         prematurely if the part already exists or the  *</span><br><span class="line"> *         array is full.                                 *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void insert(struct part inv[], int *np)</span><br><span class="line">{</span><br><span class="line">  int part_number;</span><br><span class="line"> </span><br><span class="line">  if (*np == MAX_PARTS) {</span><br><span class="line">    printf("Database is full; can't add more parts.\n");</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;part_number);</span><br><span class="line">  if (find_part(part_number, inv, *np) &gt;= 0) {</span><br><span class="line">    printf("Part already exists.\n");</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  inv[*np].number = part_number;</span><br><span class="line">  printf("Enter part name: ");</span><br><span class="line">  read_line(inv[*np].name, NAME_LEN);</span><br><span class="line">  printf("Enter quantity on hand: ");</span><br><span class="line">  scanf("%d", &amp;inv[*np].on_hand);</span><br><span class="line">  (*np)++;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * search: Prompts the user to enter a part number, then  *</span><br><span class="line"> *         looks up the part in the inv array. If the     *</span><br><span class="line"> *         part exists, prints the name and quantity on   *</span><br><span class="line"> *         hand; if not, prints an error message.         *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void search(const struct part inv[], int np)</span><br><span class="line">{</span><br><span class="line">  int i, number;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number, inv, np);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Part name: %s\n", inv[i].name);</span><br><span class="line">    printf("Quantity on hand: %d\n", inv[i].on_hand);</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * update: Prompts the user to enter a part number.       *</span><br><span class="line"> *         Prints an error message if the part can't be   *</span><br><span class="line"> *         found in the inv array; otherwise, prompts the *</span><br><span class="line"> *         user to enter change in quantity on hand and   *</span><br><span class="line"> *         updates the array.                             *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void update(struct part inv[], int np)</span><br><span class="line">{</span><br><span class="line">  int i, number, change;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number, inv, np);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Enter change in quantity on hand: ");</span><br><span class="line">    scanf("%d", &amp;change);</span><br><span class="line">    inv[i].on_hand += change;</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * print: Prints a listing of all parts in the inv array, *</span><br><span class="line"> *        showing the part number, part name, and         *</span><br><span class="line"> *        quantity on hand. Parts are printed in the      *</span><br><span class="line"> *        order in which they were entered into the       *</span><br><span class="line"> *        array.                                          *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void print(const struct part inv[], int np)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  printf("Part Number   Part Name                  "</span><br><span class="line">         "Quantity on Hand\n");</span><br><span class="line">  for (i = 0; i &lt; np; i++)</span><br><span class="line">    printf("%7d       %-25s%11d\n", inv[i].number,</span><br><span class="line">           inv[i].name, inv[i].on_hand);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-17"><a href="#Chapter-17" class="headerlink" title="Chapter 17"></a>Chapter 17</h3><h4 id="Answers-to-Selected-Exercises-12"><a href="#Answers-to-Selected-Exercises-12" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">char *duplicate(const char *s)</span><br><span class="line">{</span><br><span class="line">  char *temp = malloc(strlen(s) + 1);</span><br><span class="line"> </span><br><span class="line">  if (temp == NULL)</span><br><span class="line">    return NULL;</span><br><span class="line"> </span><br><span class="line">  strcpy(temp, s);</span><br><span class="line">  return temp;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #6] (b) and (c) are legal. (a) is illegal because it tries to reference a member of <code>d</code> without mentioning <code>d</code>. (d) is illegal because it uses <code>-&gt;</code> instead of <code>.</code> to reference the <code>c</code> member of <code>d</code>.</p><p><strong>7.</strong> [was #8] The first call of <code>free</code> will release the space for the first node in the list, making <code>p</code> a dangling pointer. Executing <code>p</code> <code>=</code> <code>p-&gt;next</code> to advance to the next node will have an undefined effect. Here’s a correct way to write the loop, using a temporary pointer that points to the node being deleted: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">struct node *temp;</span><br><span class="line"> </span><br><span class="line">p = first;</span><br><span class="line">while (p != NULL) {</span><br><span class="line">  temp = p;</span><br><span class="line">  p = p-&gt;next;</span><br><span class="line">  free(temp);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>8.</strong> [was #10; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "stack.h"</span><br><span class="line"> </span><br><span class="line">struct node {</span><br><span class="line">  int value;</span><br><span class="line">  struct node *next;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">struct node *top = NULL;</span><br><span class="line"> </span><br><span class="line">void make_empty(void)</span><br><span class="line">{</span><br><span class="line">  struct node *temp;</span><br><span class="line"> </span><br><span class="line">  while (top != NULL) {</span><br><span class="line">    temp = top;</span><br><span class="line">    top = top-&gt;next;</span><br><span class="line">    free(temp);</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_empty(void)</span><br><span class="line">{</span><br><span class="line">  return top == NULL;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool push(int i)</span><br><span class="line">{</span><br><span class="line">  struct node *new_node;</span><br><span class="line"> </span><br><span class="line">  new_node = malloc(sizeof(struct node));</span><br><span class="line">  if (new_node == NULL)</span><br><span class="line">    return false;</span><br><span class="line"> </span><br><span class="line">  new_node-&gt;value = i;</span><br><span class="line">  new_node-&gt;next = top;</span><br><span class="line">  top = new_node;</span><br><span class="line"> </span><br><span class="line">  return true;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int pop(void)</span><br><span class="line">{</span><br><span class="line">  struct node *temp;</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  if (is_empty()) {</span><br><span class="line">    printf("*** Stack underflow; program terminated. ***\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  i = top-&gt;value;</span><br><span class="line">  temp = top;</span><br><span class="line">  top = top-&gt;next;</span><br><span class="line">  free(temp);</span><br><span class="line"> </span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>15.</strong> [was #12] The output of the program is </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Answer: 3</span><br></pre></td></tr></tbody></table></figure><p>The program tests the values of <code>f2(0)</code>, <code>f2(1)</code>, <code>f2(2)</code>, and so on, stopping when <code>f2</code> returns zero. It then prints the argument that was passed to <code>f2</code> to make it return zero. </p><p><strong>17.</strong> [was #14] Assuming that <code>compare</code> is the name of the comparison function, the following call of <code>qsort</code> will sort the last 50 elements of <code>a</code>: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qsort(&amp;a[50], 50, sizeof(a[0]), compare);</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-8"><a href="#Answers-to-Selected-Programming-Projects-8" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #4] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "readline.h"</span><br><span class="line"> </span><br><span class="line">#define NAME_LEN 25</span><br><span class="line">#define INITIAL_PARTS 10</span><br><span class="line"> </span><br><span class="line">struct part {</span><br><span class="line">  int number;</span><br><span class="line">  char name[NAME_LEN+1];</span><br><span class="line">  int on_hand;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">struct part *inventory;</span><br><span class="line">int num_parts = 0;      /* number of parts currently stored */</span><br><span class="line">int max_parts = INITIAL_PARTS;   /* size of inventory array */</span><br><span class="line"> </span><br><span class="line">int find_part(int number);</span><br><span class="line">void insert(void);</span><br><span class="line">void search(void);</span><br><span class="line">void update(void);</span><br><span class="line">void print(void);</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * main: Prompts the user to enter an operation code,     *</span><br><span class="line"> *       then calls a function to perform the requested   *</span><br><span class="line"> *       action. Repeats until the user enters the        *</span><br><span class="line"> *       command 'q'. Prints an error message if the user *</span><br><span class="line"> *       enters an illegal code.                          *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char code;</span><br><span class="line"> </span><br><span class="line">  inventory = malloc(max_parts * sizeof(struct part));</span><br><span class="line">  if (inventory == NULL) {</span><br><span class="line">    printf("Can't allocate initial inventory space.\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  for (;;) {</span><br><span class="line">    printf("Enter operation code: ");</span><br><span class="line">    scanf(" %c", &amp;code);</span><br><span class="line">    while (getchar() != '\n')   /* skips to end of line */</span><br><span class="line">      ;</span><br><span class="line">    switch (code) {</span><br><span class="line">      case 'i': insert();</span><br><span class="line">                break;</span><br><span class="line">      case 's': search();</span><br><span class="line">                break;</span><br><span class="line">      case 'u': update();</span><br><span class="line">                break;</span><br><span class="line">      case 'p': print();</span><br><span class="line">                break;</span><br><span class="line">      case 'q': return 0;</span><br><span class="line">      default:  printf("Illegal code\n");</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * find_part: Looks up a part number in the inventory     *</span><br><span class="line"> *            array. Returns the array index if the part  *</span><br><span class="line"> *            number is found; otherwise, returns -1.     *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int find_part(int number)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; num_parts; i++)</span><br><span class="line">    if (inventory[i].number == number)</span><br><span class="line">      return i;</span><br><span class="line">  return -1;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * insert: Prompts the user for information about a new   *</span><br><span class="line"> *         part and then inserts the part into the        *</span><br><span class="line"> *         database. Prints an error message and returns  *</span><br><span class="line"> *         prematurely if the part already exists or the  *</span><br><span class="line"> *         database is full.                              *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void insert(void)</span><br><span class="line">{</span><br><span class="line">  int part_number;</span><br><span class="line">  struct part *temp;</span><br><span class="line"> </span><br><span class="line">  if (num_parts == max_parts) {</span><br><span class="line">    max_parts *= 2;</span><br><span class="line">    temp = realloc(inventory, max_parts * sizeof(struct part));</span><br><span class="line">    if (temp == NULL) {</span><br><span class="line">      printf("Insufficient memory; can't add more parts.\n");</span><br><span class="line">      return;</span><br><span class="line">    }</span><br><span class="line">    inventory = temp;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;part_number);</span><br><span class="line">  if (find_part(part_number) &gt;= 0) {</span><br><span class="line">    printf("Part already exists.\n");</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  inventory[num_parts].number = part_number;</span><br><span class="line">  printf("Enter part name: ");</span><br><span class="line">  read_line(inventory[num_parts].name, NAME_LEN);</span><br><span class="line">  printf("Enter quantity on hand: ");</span><br><span class="line">  scanf("%d", &amp;inventory[num_parts].on_hand);</span><br><span class="line">  num_parts++;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * search: Prompts the user to enter a part number, then  *</span><br><span class="line"> *         looks up the part in the database. If the part *</span><br><span class="line"> *         exists, prints the name and quantity on hand;  *</span><br><span class="line"> *         if not, prints an error message.               *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void search(void)</span><br><span class="line">{</span><br><span class="line">  int i, number;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Part name: %s\n", inventory[i].name);</span><br><span class="line">    printf("Quantity on hand: %d\n", inventory[i].on_hand);</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * update: Prompts the user to enter a part number.       *</span><br><span class="line"> *         Prints an error message if the part doesn't    *</span><br><span class="line"> *         exist; otherwise, prompts the user to enter    *</span><br><span class="line"> *         change in quantity on hand and updates the     *</span><br><span class="line"> *         database.                                      *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void update(void)</span><br><span class="line">{</span><br><span class="line">  int i, number, change;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Enter change in quantity on hand: ");</span><br><span class="line">    scanf("%d", &amp;change);</span><br><span class="line">    inventory[i].on_hand += change;</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * print: Prints a listing of all parts in the database,  *</span><br><span class="line"> *        showing the part number, part name, and         *</span><br><span class="line"> *        quantity on hand. Parts are printed in the      *</span><br><span class="line"> *        order in which they were entered into the       *</span><br><span class="line"> *        database.                                       *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void print(void)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  printf("Part Number   Part Name                  "</span><br><span class="line">         "Quantity on Hand\n");</span><br><span class="line">  for (i = 0; i &lt; num_parts; i++)</span><br><span class="line">    printf("%7d       %-25s%11d\n", inventory[i].number,</span><br><span class="line">           inventory[i].name, inventory[i].on_hand);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>2.</strong> [was #16] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "readline.h"</span><br><span class="line"> </span><br><span class="line">#define NAME_LEN 25</span><br><span class="line">#define MAX_PARTS 100</span><br><span class="line"> </span><br><span class="line">struct part {</span><br><span class="line">  int number;</span><br><span class="line">  char name[NAME_LEN+1];</span><br><span class="line">  int on_hand;</span><br><span class="line">} inventory[MAX_PARTS];</span><br><span class="line"> </span><br><span class="line">int num_parts = 0;   /* number of parts currently stored */</span><br><span class="line"> </span><br><span class="line">int find_part(int number);</span><br><span class="line">void insert(void);</span><br><span class="line">void search(void);</span><br><span class="line">void update(void);</span><br><span class="line">void print(void);</span><br><span class="line">int compare_parts(const void *p, const void *q);</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * main: Prompts the user to enter an operation code,     *</span><br><span class="line"> *       then calls a function to perform the requested   *</span><br><span class="line"> *       action. Repeats until the user enters the        *</span><br><span class="line"> *       command 'q'. Prints an error message if the user *</span><br><span class="line"> *       enters an illegal code.                          *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char code;</span><br><span class="line"> </span><br><span class="line">  for (;;) {</span><br><span class="line">    printf("Enter operation code: ");</span><br><span class="line">    scanf(" %c", &amp;code);</span><br><span class="line">    while (getchar() != '\n')   /* skips to end of line */</span><br><span class="line">      ;</span><br><span class="line">    switch (code) {</span><br><span class="line">      case 'i': insert();</span><br><span class="line">                break;</span><br><span class="line">      case 's': search();</span><br><span class="line">                break;</span><br><span class="line">      case 'u': update();</span><br><span class="line">                break;</span><br><span class="line">      case 'p': print();</span><br><span class="line">                break;</span><br><span class="line">      case 'q': return 0;</span><br><span class="line">      default:  printf("Illegal code\n");</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * find_part: Looks up a part number in the inventory     *</span><br><span class="line"> *            array. Returns the array index if the part  *</span><br><span class="line"> *            number is found; otherwise, returns -1.     *</span><br><span class="line"> **********************************************************/</span><br><span class="line">int find_part(int number)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; num_parts; i++)</span><br><span class="line">    if (inventory[i].number == number)</span><br><span class="line">      return i;</span><br><span class="line">  return -1;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * insert: Prompts the user for information about a new   *</span><br><span class="line"> *         part and then inserts the part into the        *</span><br><span class="line"> *         database. Prints an error message and returns  *</span><br><span class="line"> *         prematurely if the part already exists or the  *</span><br><span class="line"> *         database is full.                              *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void insert(void)</span><br><span class="line">{</span><br><span class="line">  int part_number;</span><br><span class="line"> </span><br><span class="line">  if (num_parts == MAX_PARTS) {</span><br><span class="line">    printf("Database is full; can't add more parts.\n");</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;part_number);</span><br><span class="line">  if (find_part(part_number) &gt;= 0) {</span><br><span class="line">    printf("Part already exists.\n");</span><br><span class="line">    return;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  inventory[num_parts].number = part_number;</span><br><span class="line">  printf("Enter part name: ");</span><br><span class="line">  read_line(inventory[num_parts].name, NAME_LEN);</span><br><span class="line">  printf("Enter quantity on hand: ");</span><br><span class="line">  scanf("%d", &amp;inventory[num_parts].on_hand);</span><br><span class="line">  num_parts++;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * search: Prompts the user to enter a part number, then  *</span><br><span class="line"> *         looks up the part in the database. If the part *</span><br><span class="line"> *         exists, prints the name and quantity on hand;  *</span><br><span class="line"> *         if not, prints an error message.               *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void search(void)</span><br><span class="line">{</span><br><span class="line">  int i, number;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Part name: %s\n", inventory[i].name);</span><br><span class="line">    printf("Quantity on hand: %d\n", inventory[i].on_hand);</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * update: Prompts the user to enter a part number.       *</span><br><span class="line"> *         Prints an error message if the part doesn't    *</span><br><span class="line"> *         exist; otherwise, prompts the user to enter    *</span><br><span class="line"> *         change in quantity on hand and updates the     *</span><br><span class="line"> *         database.                                      *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void update(void)</span><br><span class="line">{</span><br><span class="line">  int i, number, change;</span><br><span class="line"> </span><br><span class="line">  printf("Enter part number: ");</span><br><span class="line">  scanf("%d", &amp;number);</span><br><span class="line">  i = find_part(number);</span><br><span class="line">  if (i &gt;= 0) {</span><br><span class="line">    printf("Enter change in quantity on hand: ");</span><br><span class="line">    scanf("%d", &amp;change);</span><br><span class="line">    inventory[i].on_hand += change;</span><br><span class="line">  } else</span><br><span class="line">    printf("Part not found.\n");</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">/**********************************************************</span><br><span class="line"> * print: Sorts the inventory array by part number, then  *</span><br><span class="line"> *        prints a listing of all parts in the database,  *</span><br><span class="line"> *        showing the part number, part name, and         *</span><br><span class="line"> *        quantity on hand.                               *</span><br><span class="line"> **********************************************************/</span><br><span class="line">void print(void)</span><br><span class="line">{</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  qsort(inventory, num_parts, sizeof(struct part), compare_parts);</span><br><span class="line">  printf("Part Number   Part Name                  "</span><br><span class="line">         "Quantity on Hand\n");</span><br><span class="line">  for (i = 0; i &lt; num_parts; i++)</span><br><span class="line">    printf("%7d       %-25s%11d\n", inventory[i].number,</span><br><span class="line">           inventory[i].name, inventory[i].on_hand);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int compare_parts(const void *p, const void *q)</span><br><span class="line">{</span><br><span class="line">  return ((struct part *) p)-&gt;number - ((struct part *) q)-&gt;number;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-18"><a href="#Chapter-18" class="headerlink" title="Chapter 18"></a>Chapter 18</h3><h4 id="Answers-to-Selected-Exercises-13"><a href="#Answers-to-Selected-Exercises-13" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] </p><p>(a) <code>extern</code><br> (b) <code>static</code><br> (c) <code>extern</code> and <code>static</code> (when applied to a local variable) </p><p><strong>4.</strong> [was #4] If <code>f</code> has never been called previously, the value of <code>f(10)</code> will be 0. If <code>f</code> has been called five times previously, the value of <code>f(10)</code> will be 50, since <code>j</code> is incremented once per call. </p><p><strong>8.</strong> [was #6; modified] </p><p>(a) <code>x</code> is an array of ten pointers to functions. Each function takes an <code>int</code> argument and returns a character.<br> (b) <code>x</code> is a function that returns a pointer to an array of five integers.<br> (c) <code>x</code> is a function with no arguments that returns a pointer to a function with an <code>int</code> argument that returns a pointer to a <code>float</code> value.<br> (d) <code>x</code> is a function with two arguments. The first argument is an integer, and the second is a pointer to a function with an <code>int</code> argument and no return value. <code>x</code> returns a pointer to a function with an <code>int</code> argument and no return value. (Although this example may seem artificially complex, the <code>signal</code> function—part of the standard C library—has exactly this prototype. See p. 632 for a discussion of <code>signal</code>.)</p><p><strong>10.</strong> [was #8] </p><p>(a) <code>char *(*p)(char *);</code><br> (b) <code>void *f(struct t *p, long int n)(void);</code><br> (c) <code>void (*a[])(void) = {insert, search, update, print};</code><br> (d) <code>struct t (*b[10])(int, int);</code> </p><p><strong>13.</strong> [was #10] (a), (c), and (d) are legal. (b) is illegal; the initializer for a variable with static storage duration must be a constant expression, and <code>i</code> <code>*</code> <code>i</code> doesn’t qualify. </p><p><strong>15.</strong> [was #12] (a). Variables with static storage duration are initialized to zero by default; variables with automatic storage duration have no default initial value. </p><h3 id="Chapter-19"><a href="#Chapter-19" class="headerlink" title="Chapter 19"></a>Chapter 19</h3><h4 id="Answers-to-Selected-Exercises-14"><a href="#Answers-to-Selected-Exercises-14" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "stack.h"</span><br><span class="line"> </span><br><span class="line">#define PUBLIC  /* empty */</span><br><span class="line">#define PRIVATE static</span><br><span class="line"> </span><br><span class="line">struct node {</span><br><span class="line">  int data;</span><br><span class="line">  struct node *next;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">PRIVATE struct node *top = NULL;</span><br><span class="line"> </span><br><span class="line">PRIVATE void terminate(const char *message)</span><br><span class="line">{</span><br><span class="line">  printf("%s\n", message);</span><br><span class="line">  exit(EXIT_FAILURE);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">PUBLIC void make_empty(void)</span><br><span class="line">{</span><br><span class="line">  while (!is_empty())</span><br><span class="line">    pop();</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">PUBLIC bool is_empty(void)</span><br><span class="line">{</span><br><span class="line">  return top == NULL;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">PUBLIC bool is_full(void)</span><br><span class="line">{</span><br><span class="line">  return false;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">PUBLIC void push(int i)</span><br><span class="line">{</span><br><span class="line">  struct node *new_node = malloc(sizeof(struct node));</span><br><span class="line">  if (new_node == NULL)</span><br><span class="line">    terminate("Error in push: stack is full.");</span><br><span class="line"> </span><br><span class="line">  new_node-&gt;data = i;</span><br><span class="line">  new_node-&gt;next = top;</span><br><span class="line">  top = new_node;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">PUBLIC int pop(void)</span><br><span class="line">{</span><br><span class="line">  struct node *old_top;</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  if (is_empty())</span><br><span class="line">    terminate("Error in pop: stack is empty.");</span><br><span class="line"> </span><br><span class="line">  old_top = top;</span><br><span class="line">  i = top-&gt;data;</span><br><span class="line">  top = top-&gt;next;</span><br><span class="line">  free(old_top);</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #4; modified] </p><p>(a) Contents of <code>stack.c</code> file: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "stack.h"</span><br><span class="line"> </span><br><span class="line">static void terminate(const char *message)</span><br><span class="line">{</span><br><span class="line">  printf("%s\n", message);</span><br><span class="line">  exit(EXIT_FAILURE);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void make_empty(Stack *s)</span><br><span class="line">{</span><br><span class="line">  s-&gt;top = 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_empty(const Stack *s)</span><br><span class="line">{</span><br><span class="line">  return s-&gt;top == 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_full(const Stack *s)</span><br><span class="line">{</span><br><span class="line">  return s-&gt;top == STACK_SIZE;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void push(Stack *s, int i)</span><br><span class="line">{</span><br><span class="line">  if (is_full(s))</span><br><span class="line">    terminate("Error in push: stack is full.");</span><br><span class="line">  s-&gt;contents[s-&gt;top++] = i;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int pop(Stack *s)</span><br><span class="line">{</span><br><span class="line">  if (is_empty(s))</span><br><span class="line">    terminate("Error in pop: stack is empty.");</span><br><span class="line">  return s-&gt;contents[--s-&gt;top];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) Contents of <code>stack.h</code> file: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#ifndef STACK_H</span><br><span class="line">#define STACK_H</span><br><span class="line"> </span><br><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line"> </span><br><span class="line">struct node {</span><br><span class="line">  int data;</span><br><span class="line">  struct node *next;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">typedef struct node *Stack;</span><br><span class="line"> </span><br><span class="line">void make_empty(Stack *s);</span><br><span class="line">bool is_empty(const Stack *s);</span><br><span class="line">bool is_full(const Stack *s);</span><br><span class="line">void push(Stack *s, int i);</span><br><span class="line">int pop(Stack *s);</span><br><span class="line"> </span><br><span class="line">#endif</span><br></pre></td></tr></tbody></table></figure><p>Contents of <code>stack.c</code> file: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include "stack.h"</span><br><span class="line"> </span><br><span class="line">static void terminate(const char *message)</span><br><span class="line">{</span><br><span class="line">  printf("%s\n", message);</span><br><span class="line">  exit(EXIT_FAILURE);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void make_empty(Stack *s)</span><br><span class="line">{</span><br><span class="line">  while (!is_empty(s))</span><br><span class="line">    pop(s);</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_empty(const Stack *s)</span><br><span class="line">{</span><br><span class="line">  return *s == NULL;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">bool is_full(const Stack *s)</span><br><span class="line">{</span><br><span class="line">  return false;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">void push(Stack *s, int i)</span><br><span class="line">{</span><br><span class="line">  struct node *new_node = malloc(sizeof(struct node));</span><br><span class="line">  if (new_node == NULL)</span><br><span class="line">    terminate("Error in push: stack is full.");</span><br><span class="line"> </span><br><span class="line">  new_node-&gt;data = i;</span><br><span class="line">  new_node-&gt;next = *s;</span><br><span class="line">  *s = new_node;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int pop(Stack *s)</span><br><span class="line">{</span><br><span class="line">  struct node *old_top;</span><br><span class="line">  int i;</span><br><span class="line"> </span><br><span class="line">  if (is_empty(s))</span><br><span class="line">    terminate("Error in pop: stack is empty.");</span><br><span class="line"> </span><br><span class="line">  old_top = *s;</span><br><span class="line">  i = (*s)-&gt;data;</span><br><span class="line">  *s = (*s)-&gt;next;</span><br><span class="line">  free(old_top);</span><br><span class="line">  return i;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-20"><a href="#Chapter-20" class="headerlink" title="Chapter 20"></a>Chapter 20</h3><h4 id="Answers-to-Selected-Exercises-15"><a href="#Answers-to-Selected-Exercises-15" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] To toggle a bit in a variable <code>i</code>, apply the exclusive-or operator (<code>^</code>) to <code>i</code> and a mask with a 1 bit in the desired position, then store the result back into <code>i</code>. To toggle bit 4, for example, use the statement </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = i ^ 0x0010;</span><br></pre></td></tr></tbody></table></figure><p>or, more concisely, </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i ^= 0x0010;</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #4] ``</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define MK_COLOR(r,g,b) ((long) (b) &lt;&lt; 16 | (g) &lt;&lt; 8 | (r))</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6; modified] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">unsigned short swap_bytes(unsigned short i);</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  unsigned short i;</span><br><span class="line"> </span><br><span class="line">  printf("Enter a hexadecimal number (up to four digits): ");</span><br><span class="line">  scanf("%hx", &amp;i);</span><br><span class="line">  printf("Number with bytes swapped: %hx\n", swap_bytes(i));</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">unsigned short swap_bytes(unsigned short i)</span><br><span class="line">{</span><br><span class="line">  unsigned short high_byte = i &lt;&lt; 8;</span><br><span class="line">  unsigned short low_byte = i &gt;&gt; 8;</span><br><span class="line"> </span><br><span class="line">  return high_byte | low_byte;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unsigned short swap_bytes(unsigned short i)</span><br><span class="line">{</span><br><span class="line">  return i &lt;&lt; 8 | i &gt;&gt; 8;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>8.</strong> [was #8] </p><p>(a) The value of <code>~0</code> is a number containing all 1 bits. Shifting this number to the left by <code>n</code> places yields a result of the form 1…10…0, where there are <code>n</code> 0 bits. Applying the <code>~</code> operator to that number yields a result of the form 0…01…1, where there are <code>n</code> 1 bits. </p><p>(b) It returns a bit-field within <code>i</code> of length <code>n</code> starting at position <code>m</code>. Positions are assumed to be numbered starting from the rightmost bit, which is position 0. </p><p><strong>14.</strong> [was #9] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct IEEE_float {</span><br><span class="line">  unsigned int fraction: 23;   /* members may need to be reversed */</span><br><span class="line">  unsigned int exponent: 8;</span><br><span class="line">  unsigned int sign: 1;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-21"><a href="#Chapter-21" class="headerlink" title="Chapter 21"></a>Chapter 21</h3><h4 id="Answers-to-Selected-Exercises-16"><a href="#Answers-to-Selected-Exercises-16" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>7.</strong> [was #4] </p><p>(a) <code>&lt;time.h&gt;</code><br> (b) <code>&lt;ctype.h&gt;</code><br> (c) <code>&lt;limits.h&gt;</code><br> (d) <code>&lt;math.h&gt;</code><br> (e) <code>&lt;limits.h&gt;</code><br> (f) <code>&lt;float.h&gt;</code><br> (g) <code>&lt;string.h&gt;</code><br> (h) <code>&lt;stdio.h&gt;</code> </p><h3 id="Chapter-22"><a href="#Chapter-22" class="headerlink" title="Chapter 22"></a>Chapter 22</h3><h4 id="Answers-to-Selected-Exercises-17"><a href="#Answers-to-Selected-Exercises-17" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] </p><p>(a) <code>"rb+"</code><br> (b) <code>"a"</code><br> (c) <code>"rb"</code><br> (d) <code>"r"</code> </p><p><strong>4.</strong> [was #4] </p><p>(a) <code>00000083.736</code><br> (b) <code>00000029749.</code><br> (c) <code>001.0549e+09</code><br> (d) <code>002.3522e-05</code> </p><p><strong>6.</strong> [was #6] <code>printf(widget == 1 ? "%d widget" : "%d widgets", widget);</code> </p><p><strong>8.</strong> [was #8] No. The difference is that <code>"%1s"</code> will store a null character after it reads and stores a nonblank character; <code>" %c"</code> will store only the nonblank character. As a result, the two format strings must be used differently: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">char c, s[2];</span><br><span class="line"> </span><br><span class="line">scanf(" %c", &amp;c);  /* stores a nonblank character into c */</span><br><span class="line">scanf("%1s", s);   /* stores a nonblank character into s[0]</span><br><span class="line">                      and a null character into s[1] */</span><br><span class="line"> </span><br></pre></td></tr></tbody></table></figure><p><strong>10.</strong> [was #10] Revise the program’s <code>while</code> loop as follows: </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">while ((ch = getc(source_fp)) != EOF)</span><br><span class="line">  if (putc(ch, dest_fp) == EOF) {</span><br><span class="line">    fprintf(stderr, "Error during writing; copy terminated\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure><p><strong>14.</strong> [was #18] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">char *fget_string(char *s, int n, FILE *stream)</span><br><span class="line">{</span><br><span class="line">  int ch, len = 0;</span><br><span class="line"> </span><br><span class="line">  while (len &lt; n - 1) {</span><br><span class="line">    if ((ch = getc(stream)) == EOF) {</span><br><span class="line">      if (len == 0 || ferror(stream))</span><br><span class="line">        return NULL;</span><br><span class="line">      break;</span><br><span class="line">    }</span><br><span class="line">    s[len++] = ch;</span><br><span class="line">    if (ch == '\n')</span><br><span class="line">      break;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  s[len] = '\0';</span><br><span class="line">  return s;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">int fput_string(const char *s, FILE *stream)</span><br><span class="line">{</span><br><span class="line">  while (*s != '\0') {</span><br><span class="line">    if (putc(*s, stream) == EOF)</span><br><span class="line">      return EOF;</span><br><span class="line">    s++;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>15.</strong> [was #22] </p><p>(a) <code>fseek(fp, n * 64L, SEEK_SET);</code><br> (b) <code>fseek(fp, -64L, SEEK_END);</code><br> (c) <code>fseek(fp, 64L, SEEK_CUR);</code><br> (d) <code>fseek(fp, -128L, SEEK_CUR);</code> </p><h4 id="Answers-to-Selected-Programming-Projects-9"><a href="#Answers-to-Selected-Programming-Projects-9" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>2.</strong> [was #12] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *fp;</span><br><span class="line">  int ch;</span><br><span class="line"> </span><br><span class="line">  if (argc != 2) {</span><br><span class="line">    fprintf(stderr, "usage: toupper file\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((fp = fopen(argv[1], "r")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  while ((ch = getc(fp)) != EOF)</span><br><span class="line">    putchar(toupper(ch));</span><br><span class="line"> </span><br><span class="line">  fclose(fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #14] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *fp;</span><br><span class="line">  int count = 0;</span><br><span class="line"> </span><br><span class="line">  if (argc != 2) {</span><br><span class="line">    fprintf(stderr, "usage: cntchar file\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((fp = fopen(argv[1], "r")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  while (getc(fp) != EOF)</span><br><span class="line">    count++;</span><br><span class="line"> </span><br><span class="line">  printf("There are %d characters in %s\n", count, argv[1]);</span><br><span class="line"> </span><br><span class="line">  fclose(fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *fp;</span><br><span class="line">  int ch, count = 0;</span><br><span class="line">  bool in_word;</span><br><span class="line"> </span><br><span class="line">  if (argc != 2) {</span><br><span class="line">    fprintf(stderr, "usage: cntword file\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((fp = fopen(argv[1], "r")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  in_word = false;</span><br><span class="line">  while ((ch = getc(fp)) != EOF)</span><br><span class="line">    if (isspace(ch))</span><br><span class="line">      in_word = false;</span><br><span class="line">    else if (!in_word) {</span><br><span class="line">      in_word = true;</span><br><span class="line">      count++;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">  printf("There are %d words in %s\n", count, argv[1]);</span><br><span class="line"> </span><br><span class="line">  fclose(fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *fp;</span><br><span class="line">  int ch, count = 0;</span><br><span class="line"> </span><br><span class="line">  if (argc != 2) {</span><br><span class="line">    fprintf(stderr, "usage: cntline file\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((fp = fopen(argv[1], "r")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  while((ch = getc(fp)) != EOF)</span><br><span class="line">    if (ch == '\n')</span><br><span class="line">      count++;</span><br><span class="line"> </span><br><span class="line">  printf("There are %d lines in %s\n", count, argv[1]);</span><br><span class="line"> </span><br><span class="line">  fclose(fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #16; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *fp;</span><br><span class="line">  int i, n, offset;</span><br><span class="line">  unsigned char buffer[10];</span><br><span class="line"> </span><br><span class="line">  if (argc != 2) {</span><br><span class="line">    fprintf(stderr, "usage: viewfile file\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((fp = fopen(argv[1], "rb")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  printf("Offset              Bytes              Characters\n");</span><br><span class="line">  printf("------  -----------------------------  ----------\n");</span><br><span class="line"> </span><br><span class="line">  for (offset = 0;; offset += 10) {</span><br><span class="line">    n = fread(buffer, 1, 10, fp);</span><br><span class="line">    if (n == 0)</span><br><span class="line">      break;</span><br><span class="line"> </span><br><span class="line">    printf("%6d  ", offset);</span><br><span class="line">    for (i = 0; i &lt; n; i++)</span><br><span class="line">      printf("%.2X ", buffer[i]);</span><br><span class="line">    for (; i &lt; 10; i++)</span><br><span class="line">      printf("   ");</span><br><span class="line">    printf(" ");</span><br><span class="line">    for (i = 0; i &lt; n; i++) {</span><br><span class="line">      if (!isprint(buffer[i]))</span><br><span class="line">        buffer[i] = '.';</span><br><span class="line">      printf("%c", buffer[i]);</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  fclose(fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>9.</strong> [was #20] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"> </span><br><span class="line">#define NAME_LEN 25</span><br><span class="line"> </span><br><span class="line">struct part {</span><br><span class="line">  int number;</span><br><span class="line">  char name[NAME_LEN + 1];</span><br><span class="line">  int on_hand;</span><br><span class="line">};</span><br><span class="line"> </span><br><span class="line">int main(int argc, char *argv[])</span><br><span class="line">{</span><br><span class="line">  FILE *in_fp1, *in_fp2, *out_fp;</span><br><span class="line">  int num_read1, num_read2;</span><br><span class="line">  struct part part1, part2;</span><br><span class="line"> </span><br><span class="line">  if (argc != 4) {</span><br><span class="line">    fprintf(stderr, "usage: merge infile1 infile2 outfile\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((in_fp1 = fopen(argv[1], "rb")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[1]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((in_fp2 = fopen(argv[2], "rb")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[2]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if ((out_fp = fopen(argv[3], "wb")) == NULL) {</span><br><span class="line">    fprintf(stderr, "Can't open %s\n", argv[3]);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  num_read1 = fread(&amp;part1, sizeof(struct part), 1, in_fp1);</span><br><span class="line">  num_read2 = fread(&amp;part2, sizeof(struct part), 1, in_fp2);</span><br><span class="line">  while (num_read1 == 1 &amp;&amp; num_read2 == 1)</span><br><span class="line">    /* successfully read records from both files */</span><br><span class="line">    if (part1.number &lt; part2.number) {</span><br><span class="line">      fwrite(&amp;part1, sizeof(struct part), 1, out_fp);</span><br><span class="line">      num_read1 = fread(&amp;part1, sizeof(struct part), 1, in_fp1);</span><br><span class="line">    } else if (part1.number &gt; part2.number) {</span><br><span class="line">      fwrite(&amp;part2, sizeof(struct part), 1, out_fp);</span><br><span class="line">      num_read2 = fread(&amp;part2, sizeof(struct part), 1, in_fp2);</span><br><span class="line">    } else {</span><br><span class="line">      /* part numbers are equal */</span><br><span class="line">      if (strcmp(part1.name, part2.name) != 0)</span><br><span class="line">        fprintf(stderr,</span><br><span class="line">                "Names don't match for part %d; using the name %s\n",</span><br><span class="line">                part1.number, part1.name);</span><br><span class="line">      part1.on_hand += part2.on_hand;</span><br><span class="line">      fwrite(&amp;part1, sizeof(struct part), 1, out_fp);</span><br><span class="line">      num_read1 = fread(&amp;part1, sizeof(struct part), 1, in_fp1);</span><br><span class="line">      num_read2 = fread(&amp;part2, sizeof(struct part), 1, in_fp2);</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">  /* copy rest of file1 to output file */</span><br><span class="line">  while (num_read1 == 1) {</span><br><span class="line">    fwrite(&amp;part1, sizeof(struct part), 1, out_fp);</span><br><span class="line">    num_read1 = fread(&amp;part1, sizeof(struct part), 1, in_fp1);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  /* copy rest of file2 to output file */</span><br><span class="line">  while (num_read2 == 1) {</span><br><span class="line">    fwrite(&amp;part2, sizeof(struct part), 1, out_fp);</span><br><span class="line">    num_read2 = fread(&amp;part2, sizeof(struct part), 1, in_fp2);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  fclose(in_fp1);</span><br><span class="line">  fclose(in_fp2);</span><br><span class="line">  fclose(out_fp);</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-23"><a href="#Chapter-23" class="headerlink" title="Chapter 23"></a>Chapter 23</h3><h4 id="Answers-to-Selected-Exercises-18"><a href="#Answers-to-Selected-Exercises-18" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>1.</strong> [was #2; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">double round_nearest(double x, int n)</span><br><span class="line">{</span><br><span class="line">  double power = pow(10.0, n);</span><br><span class="line"> </span><br><span class="line">  if (x &lt; 0.0)</span><br><span class="line">    return ceil(x * power - 0.5) / power;</span><br><span class="line">  else</span><br><span class="line">    return floor(x * power + 0.5) / power;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #6] </p><p>(a) <code>memmove</code><br> (b) <code>memmove</code> (we can’t use <code>strcpy</code> because its behavior is undefined when the source of the copy overlaps with the destination)<br> (c) <code>strncpy</code><br> (d) <code>memcpy</code> </p><p><strong>8.</strong> [was #8] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int numchar(const char *s, char ch)</span><br><span class="line">{</span><br><span class="line">  int count = 0;</span><br><span class="line"> </span><br><span class="line">  s = strchr(s, ch);</span><br><span class="line">  while (s != NULL) {</span><br><span class="line">    count++;</span><br><span class="line">    s = strchr(s + 1, ch);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return count;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>10.</strong> [was #10] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (strstr("foo#bar#baz", str) != NULL) …</span><br></pre></td></tr></tbody></table></figure><p>The assumptions are that <code>str</code> is at least three characters long and doesn’t contain the <code>#</code> character. </p><p><strong>11.</strong> [was #12] <code>memset(&amp;s[strlen(s)-n], '!', n);</code> </p><h4 id="Answers-to-Selected-Programming-Projects-10"><a href="#Answers-to-Selected-Programming-Projects-10" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>2.</strong> [was #4; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;stdbool.h&gt;   /* C99 only */</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  bool nonblank_seen = false;</span><br><span class="line">  int ch;</span><br><span class="line"> </span><br><span class="line">  while ((ch = getchar()) != EOF) {</span><br><span class="line">    if (nonblank_seen)</span><br><span class="line">      putchar(ch);</span><br><span class="line">    else if (!isspace(ch)) {</span><br><span class="line">      nonblank_seen = true;</span><br><span class="line">      putchar(ch);</span><br><span class="line">    }</span><br><span class="line">    if (ch == '\n')</span><br><span class="line">      nonblank_seen = false;</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-24"><a href="#Chapter-24" class="headerlink" title="Chapter 24"></a>Chapter 24</h3><h4 id="Answers-to-Selected-Exercises-19"><a href="#Answers-to-Selected-Exercises-19" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>4.</strong> [was #2] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">double try_math_fcn(double (*f)(double), double x, const char *msg)</span><br><span class="line">{</span><br><span class="line">  double result;</span><br><span class="line"> </span><br><span class="line">  errno = 0;</span><br><span class="line">  result = (*f)(x);</span><br><span class="line">  if (errno != 0) {</span><br><span class="line">    perror(msg);</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line">  return result;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define TRY_MATH_FCN(f,x) try_math_fcn(f, x, "Error in call of " #f)</span><br></pre></td></tr></tbody></table></figure><p><strong>5.</strong> [was #4] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char code;</span><br><span class="line"> </span><br><span class="line">  for (;;) {</span><br><span class="line">    setjmp(env);</span><br><span class="line">    printf("Enter operation code: ");</span><br><span class="line">    scanf(" %c", &amp;code);</span><br><span class="line">    while (getchar() != '\n')   /* skips to end of line */</span><br><span class="line">      ;</span><br><span class="line">    switch (code) {</span><br><span class="line">      case 'i': insert();</span><br><span class="line">                break;</span><br><span class="line">      case 's': search();</span><br><span class="line">                break;</span><br><span class="line">      case 'u': update();</span><br><span class="line">                break;</span><br><span class="line">      case 'p': print();</span><br><span class="line">                break;</span><br><span class="line">      case 'q': return 0;</span><br><span class="line">      default:  printf("Illegal code\n");</span><br><span class="line">    }</span><br><span class="line">    printf("\n");</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>The <code>jmp_buf</code> variable <code>env</code> will need to be global, rather than local to <code>main</code>, so that the function performing the <code>longjmp</code> will be able to supply it as an argument.</p><h3 id="Chapter-25"><a href="#Chapter-25" class="headerlink" title="Chapter 25"></a>Chapter 25</h3><h4 id="Answers-to-Selected-Exercises-20"><a href="#Answers-to-Selected-Exercises-20" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>6.</strong> [was #4; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">while ((orig_char = getchar()) != EOF) ??&lt;</span><br><span class="line">  new_char = orig_char ??' KEY;</span><br><span class="line">  if (isprint(orig_char) &amp;&amp; isprint(new_char))</span><br><span class="line">    putchar(new_char);</span><br><span class="line">  else</span><br><span class="line">    putchar(orig_char);</span><br><span class="line">??&gt;</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-11"><a href="#Answers-to-Selected-Programming-Projects-11" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #2] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;locale.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  char *temp, *C_locale;</span><br><span class="line"> </span><br><span class="line">  temp = setlocale(LC_ALL, NULL);</span><br><span class="line">    /* "C" is the current locale by default */</span><br><span class="line">  if (temp == NULL) {</span><br><span class="line">    printf("\"C\" locale information not available\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  C_locale = malloc(strlen(temp) + 1);</span><br><span class="line">  if (C_locale == NULL) {</span><br><span class="line">    printf("Can't allocate space to store locale information\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  strcpy(C_locale, temp);</span><br><span class="line"> </span><br><span class="line">  temp = setlocale(LC_ALL, "");</span><br><span class="line">  if (temp == NULL) {</span><br><span class="line">    printf("Native locale information not available\n");</span><br><span class="line">    exit(EXIT_FAILURE);</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  if (strcmp(temp, C_locale) == 0)</span><br><span class="line">    printf("Native locale is the same as the \"C\" locale\n");</span><br><span class="line">  else</span><br><span class="line">    printf("Native locale is not the same as the \"C\" locale\n");</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="Chapter-26"><a href="#Chapter-26" class="headerlink" title="Chapter 26"></a>Chapter 26</h3><h4 id="Answers-to-Selected-Exercises-21"><a href="#Answers-to-Selected-Exercises-21" class="headerlink" title="Answers to Selected Exercises"></a>Answers to Selected Exercises</h4><p><strong>2.</strong> [was #2] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">void int_printf(const char *format, ...)</span><br><span class="line">{</span><br><span class="line">  va_list ap;</span><br><span class="line">  const char *p;</span><br><span class="line">  int digit, i, power, temp;</span><br><span class="line"> </span><br><span class="line">  va_start(ap, format);</span><br><span class="line"> </span><br><span class="line">  for (p = format; *p != '\0'; p++) {</span><br><span class="line">    if (*p != '%') {</span><br><span class="line">      putchar(*p);</span><br><span class="line">      continue;</span><br><span class="line">    }</span><br><span class="line"> </span><br><span class="line">    if (*++p == 'd') {</span><br><span class="line">      i = va_arg(ap, int);</span><br><span class="line">      if (i &lt; 0) {</span><br><span class="line">        i = -i;</span><br><span class="line">        putchar('-');</span><br><span class="line">      }</span><br><span class="line"> </span><br><span class="line">      temp = i;</span><br><span class="line">      power = 1;</span><br><span class="line">      while (temp &gt; 9) {</span><br><span class="line">        temp /= 10;</span><br><span class="line">        power *= 10;</span><br><span class="line">      }</span><br><span class="line"> </span><br><span class="line">      do {</span><br><span class="line">        digit = i / power;</span><br><span class="line">        putchar(digit + '0');</span><br><span class="line">        i -= digit * power;</span><br><span class="line">        power /= 10;</span><br><span class="line">      } while (i &gt; 0);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line"> </span><br><span class="line">  va_end(ap);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>7.</strong> [was #4] The statement converts the string that <code>p</code> points to into a long integer, storing the result in <code>value</code>. <code>p</code> is left pointing to the first character not included in the conversion. The base used for the conversion is 10. </p><p><strong>9.</strong> [was #6] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">double rand_double(void)</span><br><span class="line">{</span><br><span class="line">  return (double) rand() / (RAND_MAX + 1);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="Answers-to-Selected-Programming-Projects-12"><a href="#Answers-to-Selected-Programming-Projects-12" class="headerlink" title="Answers to Selected Programming Projects"></a>Answers to Selected Programming Projects</h4><p><strong>1.</strong> [was #8] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int count = 1000;</span><br><span class="line"> </span><br><span class="line">  while (count-- &gt; 0)</span><br><span class="line">    printf("%d", rand() &amp; 1);</span><br><span class="line">  printf("\n");</span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) For generating numbers in the range 0 to <code>N</code> <code>-</code> <code>1</code>, the formula <code>rand()</code> <code>/</code> <code>(RAND_MAX</code> <code>/</code> <code>N</code> <code>+</code> <code>1)</code> often gives better results than <code>rand()</code> <code>%</code> <code>N</code>. For example, if <code>N</code> is 2 and <code>RAND_MAX</code> is 32767, the formula works out to <code>rand()</code> <code>/</code> 16384, which yields 0 if the return value of <code>rand</code> is less than 16384 and 1 if it’s greater than or equal to 16384. </p><p><strong>3.</strong> [was #10; modified] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line"> </span><br><span class="line">#define N 1000</span><br><span class="line"> </span><br><span class="line">int compare_ints(const void *p, const void *q);</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  int a[N], i;</span><br><span class="line">  clock_t start_clock;</span><br><span class="line"> </span><br><span class="line">  for (i = 0; i &lt; N; i++)</span><br><span class="line">    a[i] = N - i;</span><br><span class="line"> </span><br><span class="line">  start_clock = clock();</span><br><span class="line">  qsort(a, N, sizeof(a[0]), compare_ints);</span><br><span class="line"> </span><br><span class="line">  printf("Time used to sort %d integers: %g sec.\n", N,</span><br><span class="line">         (clock() - start_clock) / (double) CLOCKS_PER_SEC);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br><span class="line"> </span><br><span class="line">int compare_ints(const void *p, const void *q)</span><br><span class="line">{</span><br><span class="line">  return *(int *)p - *(int *)q;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>4.</strong> [was #12] </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  struct tm t;</span><br><span class="line">  int n;</span><br><span class="line"> </span><br><span class="line">  /* initialize unused members */</span><br><span class="line">  t.tm_sec = t.tm_min = t.tm_hour = 0;</span><br><span class="line">  t.tm_isdst = -1;</span><br><span class="line"> </span><br><span class="line">  printf("Enter month (1-12): ");</span><br><span class="line">  scanf("%d", &amp;t.tm_mon);</span><br><span class="line">  t.tm_mon--;</span><br><span class="line"> </span><br><span class="line">  printf("Enter day (1-31): ");</span><br><span class="line">  scanf("%d", &amp;t.tm_mday);</span><br><span class="line"> </span><br><span class="line">  printf("Enter year: ");</span><br><span class="line">  scanf("%d", &amp;t.tm_year);</span><br><span class="line">  t.tm_year -= 1900;</span><br><span class="line"> </span><br><span class="line">  printf("Enter number of days in future: ");</span><br><span class="line">  scanf("%d", &amp;n);</span><br><span class="line"> </span><br><span class="line">  t.tm_mday += n;</span><br><span class="line">  mktime(&amp;t);</span><br><span class="line">  printf("\nFuture date: %d/%d/%d\n",</span><br><span class="line">         t.tm_mon + 1, t.tm_mday, t.tm_year + 1900);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>6.</strong> [was #14] </p><p>(a) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  time_t current = time(NULL);</span><br><span class="line">  struct tm *ptr;</span><br><span class="line">  char date_time[37];</span><br><span class="line"> </span><br><span class="line">  ptr = localtime(&amp;current);</span><br><span class="line">  strftime(date_time, sizeof(date_time), "%A, %B %d, %Y  %I:%M", ptr);</span><br><span class="line">  printf("%s%c\n", date_time, ptr-&gt;tm_hour &lt;= 11 ? 'a' : 'p');</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(b) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  time_t current = time(NULL);</span><br><span class="line">  char date_time[22];</span><br><span class="line"> </span><br><span class="line">  strftime(date_time, sizeof(date_time), "%a, %d %b %y  %H:%M",</span><br><span class="line">           localtime(&amp;current));</span><br><span class="line">  puts(date_time);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>(c) </p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;time.h&gt;</span><br><span class="line"> </span><br><span class="line">int main(void)</span><br><span class="line">{</span><br><span class="line">  time_t current = time(NULL);</span><br><span class="line">  struct tm *ptr;</span><br><span class="line">  char date[9], time[12];</span><br><span class="line"> </span><br><span class="line">  ptr = localtime(&amp;current);</span><br><span class="line">  strftime(date, sizeof(date), "%m/%d/%y", ptr);</span><br><span class="line">  strftime(time, sizeof(time), "%I:%M:%S %p", ptr);</span><br><span class="line"> </span><br><span class="line">  /* print date and time, suppressing leading zero in hours */</span><br><span class="line">  printf("%s  %s\n", date, time[0] == '0' ? &amp;time[1] : time);</span><br><span class="line"> </span><br><span class="line">  return 0;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      
      
        
      <tags>
        
            
            
        <tag> C </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>远程解锁常见问题</title>
      
      
      <link href="/cn/posts/31496/"/>
      
      
      <url>/cn/posts/31496/</url>
      
      
        
      <content type="html"><![CDATA[<h3 id="联系我们："><a href="#联系我们：" class="headerlink" title="联系我们："></a>联系我们：</h3><p>QQ群：1053768454(推荐)</p><p>Discord:  <a href="https://discord.gg/b5fMzvdmeX">https://discord.gg/b5fMzvdmeX</a></p><blockquote><p>或者在文末评论区留下你的意见和建议。</p></blockquote><h3 id="常见问题："><a href="#常见问题：" class="headerlink" title="常见问题："></a>常见问题：</h3><h5 id="1-锁屏界面无反应？无法连接？"><a href="#1-锁屏界面无反应？无法连接？" class="headerlink" title="1.锁屏界面无反应？无法连接？"></a>1.锁屏界面无反应？无法连接？</h5><p>新版不在锁屏界面展示解锁结果，而是通过接口返回，调用接口的时候可以看到。接口文档可以到官网查阅。</p><p>无法连接可能是防火墙问题，可以试试先关闭防火墙排查，此问题的出现可能是安装的时候阻止了创建防火墙规则请手动给LogonUI.exe添加规则。</p><p>还有一种可能就是启动了开始配对。</p><p>目前只有局域网版，监听了所有IP，支持IPV6，但是不建议直接开放到公网。</p><h5 id="2-锁屏界面提示用户名密码错误"><a href="#2-锁屏界面提示用户名密码错误" class="headerlink" title="2.锁屏界面提示用户名密码错误"></a>2.锁屏界面提示用户名密码错误</h5><p>1.请检查你输入的是密码而不是<strong>pin</strong>。</p><p>2.如果有更改过微软账户密码，可能是本地密码和在线密码不同步导致的</p><blockquote><p>建议您参考以下步骤：</p><p>方案一：直接重新绑定微软账户和本地账户</p><p>方案二：</p><p>1.按Windows徽标 + R组合键调出运行窗口，在其中输入“control userpasswords2 ”或“netplwiz”，打开“用户帐户”窗口，</p><p>2.选中需要操作的帐户，重新勾选“要使用本计算机，用户必须输入用户名和密码”，然后“应用”；然后再取消勾选“要使用本计算机，用户必须输入用户名和密码”，再点击“应用”，就会弹出自动登录设置窗口了。在其中输入微软帐户的新密码，然后点击“确定”关闭“自动登录”设置窗口，最后点击“用户帐户”窗口的“确定”按钮。</p><p><a href="https://answers.microsoft.com/zh-hans/windows/forum/all/microsoft%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95/092f9d9c-909e-4f7f-8fab-5e4169480960">https://answers.microsoft.com/zh-hans/windows/forum/all/microsoft%E8%B4%A6%E5%8F%B7%E7%99%BB%E5%BD%95/092f9d9c-909e-4f7f-8fab-5e4169480960</a></p></blockquote><h5 id="3-二维码怎么不见了"><a href="#3-二维码怎么不见了" class="headerlink" title="3.二维码怎么不见了?"></a>3.二维码怎么不见了?</h5><p>新版采用自动配对的方式，无需扫描二维码配对。</p><h5 id="4-如何使用蓝牙解锁？"><a href="#4-如何使用蓝牙解锁？" class="headerlink" title="4.如何使用蓝牙解锁？"></a>4.如何使用蓝牙解锁？</h5><p>蓝牙解锁需要首先再电脑端启用蓝牙解锁，然后手机上和电脑进行蓝牙配对</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/cn/posts/31496/image-20250822013605758.png" alt="image-20250822013605758"></p>]]></content>
      
      
      
      
      <categories>
        
          
          
        <category> 远程解锁 </category>
        
          
      
      </categories>
      
      
      
        
      <tags>
        
            
            
        <tag> 远程解锁 </tag>
        
            
        
      </tags>
      
      
    
    </entry>
    <entry>
      
      
      <title>远程解锁模块 API 文档</title>
      
      
      <link href="/cn/posts/2167915263/"/>
      
      
      <url>/cn/posts/2167915263/</url>
      
      
        
      <content type="html"><![CDATA[<h1 id="远程解锁模块-API-文档"><a href="#远程解锁模块-API-文档" class="headerlink" title="远程解锁模块 API 文档"></a>远程解锁模块 API 文档</h1><p><strong>版本:</strong> 1.0</p><p>本文档是远程解锁模块 (Remote Unlock Module) 的官方API参考。提供了所有可用端点的详细信息，包括如何进行身份验证、请求参数、以及预期的响应格式。</p><ul><li><strong>服务条款:</strong> <a href="https://rfu.czqu.net/">https://rfu.czqu.net</a></li></ul><h2 id="免-责-声-明"><a href="#免-责-声-明" class="headerlink" title="免 责 声 明"></a><strong>免 责 声 明</strong></h2><p>本 [网站/文件/服务/产品]（以下简称“本服务”）提供的信息仅供一般参考之用。所有信息均基于诚信原则提供，但我们不对本服务上任何信息的准确性、充分性、有效性、可靠性、可用性或完整性作出任何明示或暗示的陈述或保证。</p><p>在任何情况下，对于因使用本服务或依赖本服务提供的任何信息而导致的任何形式的损失或损害，我们概不负责。您使用本服务以及对本服务上任何信息的依赖，风险完全由您自行承担。</p><p>本服务可能包含（或通过本服务将您引导至）来自第三方网站的链接或内容。我们不会对此类外部链接的准确性、相关性、及时性或完整性进行调查、监控或检查。</p><p>本服务提供的内容不构成任何形式的专业建议（包括但不限于法律、财务、医疗或其他专业建议）。所有内容仅为信息分享，在根据此类信息采取任何行动之前，我们强烈建议您咨询相关领域的专业人士。我们不提供任何形式的专业建议。</p><hr><h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><h3 id="基础URL"><a href="#基础URL" class="headerlink" title="基础URL"></a>基础URL</h3><p>所有API请求的基础URL如下：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:2091/api/v1</span><br></pre></td></tr></tbody></table></figure><h3 id="身份验证"><a href="#身份验证" class="headerlink" title="身份验证"></a>身份验证</h3><p>本API的大部分端点需要通过API密钥进行身份验证。请在HTTP请求头 (Header) 中包含 <code>Authorization</code> 字段。</p><ul><li><strong>类型:</strong> <code>apiKey</code></li><li><strong>请求头字段名:</strong> <code>Authorization</code></li><li><strong>格式:</strong> <code>Authorization: Bearer  &lt;YOUR_API_KEY&gt;</code></li></ul><blockquote><p><strong>中文提示:</strong> 这里的 <code>&lt;YOUR_API_KEY&gt;</code> 需要替换为您在登录或系统配置中获取的实际认证令牌 (Token)。所有需要认证的接口都必须携带此请求头，否则将返回 <code>401 Unauthorized</code> 错误。</p></blockquote><h3 id="通用响应格式"><a href="#通用响应格式" class="headerlink" title="通用响应格式"></a>通用响应格式</h3><p>所有API的响应都遵循统一的数据结构，方便客户端进行统一处理。</p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"code"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"msg"</span><span class="punctuation">:</span> <span class="string">"success"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"data"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"request_id"</span><span class="punctuation">:</span> <span class="string">"unique-request-id-string"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><code>code</code>: 状态码。<code>0</code> 通常表示成功，其他非零值表示不同类型的错误。</li><li><code>msg</code>: 对本次响应的简短描述，可能是 “success” 或具体的错误信息。</li><li><code>data</code>: 实际返回的数据内容，可以是对象、数组或null。</li><li><code>request_id</code>: 本次请求的唯一标识符，可用于问题排查。</li></ul><hr><h2 id="API-端点详解"><a href="#API-端点详解" class="headerlink" title="API 端点详解"></a>API 端点详解</h2><h3 id="计算机控制-PC-Control"><a href="#计算机控制-PC-Control" class="headerlink" title="计算机控制 (PC Control)"></a>计算机控制 (PC Control)</h3><h4 id="POST-control-pc-action"><a href="#POST-control-pc-action" class="headerlink" title="POST /control-pc/{action}/"></a><code>POST /control-pc/{action}/</code></h4><p>控制计算机执行指定操作，如关机、待机或锁定。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li><li><strong>描述:</strong> 根据传入的 <code>action</code> 参数来控制计算机。<code>shutdown</code> (关机) 和 <code>standby</code> (待机) 操作还可以附加一个延迟时间。</li></ul><p><strong>路径参数 (Path Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>枚举值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>action</code></td><td>string</td><td>是</td><td><code>shutdown</code>, <code>standby</code>, <code>lock</code></td><td>要执行的操作类型。分别是关机、待机、锁定。</td></tr></tbody></table><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>delay</code></td><td>string</td><td>是</td><td>延迟执行的时间（秒）。仅在 <code>action</code> 为 <code>shutdown</code> 或 <code>standby</code> 时有效。</td></tr><tr><td><code>shutdown_type</code></td><td>string</td><td>否</td><td>关机类型。当且仅当action=shutdown生效。例如，可以指定为“强制”或“混合”等（具体可用值参考下面）。</td></tr></tbody></table><table><thead><tr><th>shutdown_type</th><th>中文说明</th></tr></thead><tbody><tr><td>0</td><td>不执行操作</td></tr><tr><td><strong>通用 (General)</strong></td><td></td></tr><tr><td>1</td><td>注销当前用户</td></tr><tr><td>2</td><td>强制关闭所有应用程序并关机</td></tr><tr><td>3</td><td>强制关闭所有应用程序并重启</td></tr><tr><td><strong>仅Windows 版可用</strong></td><td></td></tr><tr><td>4</td><td>关机但不关闭电源</td></tr><tr><td>5</td><td>重启计算机</td></tr><tr><td>6</td><td>强制关闭所有应用程序</td></tr><tr><td>7</td><td>关机并关闭电源</td></tr><tr><td>8</td><td>重启应用程序</td></tr><tr><td>9</td><td>混合关机</td></tr><tr><td>10</td><td>强制关闭所有应用程序并关机同时关闭电源</td></tr><tr><td>11</td><td>重启计算机并重启应用程序</td></tr><tr><td>12</td><td>强制关闭应用程序后重启并重启应用程序</td></tr><tr><td>13</td><td>关机但不关闭电源，关机后重启应用程序</td></tr><tr><td>14</td><td>混合关机并强制关闭应用程序</td></tr><tr><td>15</td><td>混合关机并重启应用程序</td></tr><tr><td>16</td><td>混合关机、强制关闭应用程序并重启应用程序</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 操作指令已成功发送。</li><li><code>400 Bad Request</code>: 无效的操作类型 (<code>action</code> 不在枚举值内)。</li><li><code>500 Internal Server Error</code>: 执行操作失败，可能是权限不足或其他系统错误。</li></ul><hr><h3 id="系统信息-System"><a href="#系统信息-System" class="headerlink" title="系统信息 (System)"></a>系统信息 (System)</h3><h4 id="GET-info"><a href="#GET-info" class="headerlink" title="GET /info"></a><code>GET /info</code></h4><p>获取软件的版本等基本信息。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li></ul><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取信息。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-info-check-update"><a href="#GET-info-check-update" class="headerlink" title="GET /info/check_update"></a><code>GET /info/check_update</code></h4><p>检查系统是否有可用的更新。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li><li><strong>描述:</strong> 返回最新的可用更新详情，包括版本号、更新URL和发布说明。</li></ul><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>默认值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>lang</code></td><td>string</td><td>否</td><td><code>en</code></td><td>指定更新信息的语言。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取更新信息。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-info-language"><a href="#GET-info-language" class="headerlink" title="GET /info/language"></a><code>GET /info/language</code></h4><p>获取当前系统设置的语言。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 不需要</li></ul><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取语言设置。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="PATCH-info-language"><a href="#PATCH-info-language" class="headerlink" title="PATCH /info/language"></a><code>PATCH /info/language</code></h4><p>设置系统语言。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 不需要</li></ul><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>默认值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>lang</code></td><td>string</td><td>否</td><td><code>en</code></td><td>要设置的目标语言。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功设置语言。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-logs-module"><a href="#GET-logs-module" class="headerlink" title="GET /logs/{module}"></a><code>GET /logs/{module}</code></h4><p>实时获取系统日志流。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li><li><strong>描述:</strong> 此端点会建立一个长连接，实时推送系统产生的日志。连接将保持打开状态，直到客户端关闭或发生错误。</li></ul><p><strong>路径参数 (Path Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>module</code></td><td>string</td><td>是</td><td>指定要获取哪个模块的日志。当前文档中，此值必须是 <code>service</code>。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 开始推送日志流 (<code>Content-Type: text/event-stream</code>)。</li><li><code>400 Bad Request</code>: 指定了无效的模块。</li><li><code>500 Internal Server Error</code>: 服务器内部错误，例如日志缓冲区不可用。</li></ul><hr><h3 id="节能模式-Power-Saving"><a href="#节能模式-Power-Saving" class="headerlink" title="节能模式 (Power Saving)"></a>节能模式 (Power Saving)</h3><h4 id="POST-power-saving"><a href="#POST-power-saving" class="headerlink" title="POST /power-saving"></a><code>POST /power-saving</code></h4><p>开启、关闭或自动设置节能模式。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li><li><strong>描述:</strong> 该功能会先将设置写入数据库，如果写入成功，再应用到系统。即使系统应用失败，数据库中的值也会被更新。</li></ul><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>默认值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>mode</code></td><td>string</td><td>否</td><td><code>auto</code></td><td>节能模式。可选值为 <code>enable</code> (开启), <code>disable</code> (关闭), 或 <code>auto</code> (自动)。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功设置节能模式。</li><li><code>400 Bad Request</code>: 无效的请求参数。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-power-saving-status"><a href="#GET-power-saving-status" class="headerlink" title="GET /power-saving/status"></a><code>GET /power-saving/status</code></h4><p>获取当前节能模式的状态。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li></ul><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取节能模式状态。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><hr><h3 id="网络接口-Network-Interfaces"><a href="#网络接口-Network-Interfaces" class="headerlink" title="网络接口 (Network Interfaces)"></a>网络接口 (Network Interfaces)</h3><h4 id="GET-interface"><a href="#GET-interface" class="headerlink" title="GET /interface"></a><code>GET /interface</code></h4><p>获取有效的网络接口列表。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li><li><strong>描述:</strong> 根据指定的IP版本（IPv4或IPv6），返回一个当前设备上所有有效网络接口的列表。</li></ul><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>默认值</th><th>枚举值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>type</code></td><td>string</td><td>否</td><td><code>4</code></td><td><code>4</code>, <code>6</code></td><td>IP协议版本类型，<code>4</code> 代表IPv4，<code>6</code> 代表IPv6。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功返回网络接口列表。</li><li><code>400 Bad Request</code>: 请求参数不正确。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-interface-ip"><a href="#GET-interface-ip" class="headerlink" title="GET /interface/{ip}"></a><code>GET /interface/{ip}</code></h4><p>根据IP地址获取其对应的MAC地址。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li></ul><p><strong>路径参数 (Path Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>ip</code></td><td>string</td><td>是</td><td>要查询的IP地址。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取MAC地址。</li><li><code>400 Bad Request</code>: 请求格式不正确（例如IP地址无效）。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="GET-interface-ip-all"><a href="#GET-interface-ip-all" class="headerlink" title="GET /interface/{ip}/all"></a><code>GET /interface/{ip}/all</code></h4><p>根据IP地址获取完整的接口信息。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要</li></ul><p><strong>路径参数 (Path Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>ip</code></td><td>string</td><td>是</td><td>要查询的IP地址。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 成功获取接口信息。</li><li><code>400 Bad Request</code>: 请求格式不正确。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><hr><h3 id="用户认证与操作-User"><a href="#用户认证与操作-User" class="headerlink" title="用户认证与操作 (User)"></a>用户认证与操作 (User)</h3><h4 id="POST-login"><a href="#POST-login" class="headerlink" title="POST /login"></a><code>POST /login</code></h4><p>用户登录。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>✅</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/2705.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 需要 (此处的认证可能是指客户端的基础认证，用于换取更长时效的Token)</li><li><strong>描述:</strong> 使用用户名和密码进行身份验证，成功后会返回一个JWT（JSON Web Token），用于后续需要认证的API请求。</li></ul><p><strong>请求体 (Request Body)</strong></p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"your_username"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"your_password"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><strong>Schema:</strong> <code>LoginRequest</code></li></ul><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 认证成功，响应的 <code>data</code> 字段中会包含JWT Token。</li><li><code>400 Bad Request</code>: 请求参数无效（例如用户名或密码为空）。</li><li><code>500 Internal Server Error</code>: 服务器内部错误。</li></ul><h4 id="POST-unlock"><a href="#POST-unlock" class="headerlink" title="POST /unlock"></a><code>POST /unlock</code></h4><p>解锁你的电脑。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 不需要</li><li><strong>描述:</strong> 发送电脑的用户名和密码来执行解锁操作。</li></ul><p><strong>请求体 (Request Body)</strong></p><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"username"</span><span class="punctuation">:</span> <span class="string">"your_pc_username"</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"password"</span><span class="punctuation">:</span> <span class="string">"your_pc_password"</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure><ul><li><strong>Schema:</strong> <code>PcUserInfo</code></li></ul><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 解锁成功。</li><li><code>400 Bad Request</code>: 请求格式不正确。</li><li><code>500 Internal Server Error</code>: 内部错误（例如用户名或密码错误，解锁失败）。</li></ul><hr><h3 id="其他-Miscellaneous"><a href="#其他-Miscellaneous" class="headerlink" title="其他 (Miscellaneous)"></a>其他 (Miscellaneous)</h3><h4 id="GET-ping"><a href="#GET-ping" class="headerlink" title="GET /ping"></a><code>GET /ping</code></h4><p>服务探活（Ping）。</p><ul><li><strong>认证:</strong> <span class="github-emoji"><span>❌</span><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.githubassets.com/images/icons/emoji/unicode/274c.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 不需要</li><li><strong>描述:</strong> 用于检查服务是否正常运行，或特定子服务（如WebSocket）的状态。</li></ul><p><strong>查询参数 (Query Parameters)</strong></p><table><thead><tr><th>参数名</th><th>类型</th><th>必需</th><th>枚举值</th><th>中文说明</th></tr></thead><tbody><tr><td><code>type</code></td><td>string</td><td>否</td><td><code>ws</code>, <code>pairing</code></td><td>探测类型。<code>ws</code> 可能用于测试WebSocket服务，<code>pairing</code> 可能用于测试配对服务。</td></tr></tbody></table><p><strong>响应 (Responses)</strong></p><ul><li><code>200 OK</code>: 服务正常。</li><li><code>500 Internal Server Error</code>: 服务异常。</li></ul><hr><h2 id="数据模型-Definitions"><a href="#数据模型-Definitions" class="headerlink" title="数据模型 (Definitions)"></a>数据模型 (Definitions)</h2><h3 id="LoginRequest"><a href="#LoginRequest" class="headerlink" title="LoginRequest"></a><code>LoginRequest</code></h3><p>用户登录时使用的凭据对象。</p><table><thead><tr><th>字段名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>username</code></td><td>string</td><td>是</td><td>用户名</td></tr><tr><td><code>password</code></td><td>string</td><td>是</td><td>密码</td></tr></tbody></table><h3 id="PcUserInfo"><a href="#PcUserInfo" class="headerlink" title="PcUserInfo"></a><code>PcUserInfo</code></h3><p>解锁电脑时使用的用户信息对象。</p><table><thead><tr><th>字段名</th><th>类型</th><th>必需</th><th>中文说明</th></tr></thead><tbody><tr><td><code>username</code></td><td>string</td><td>否</td><td>电脑的用户名</td></tr><tr><td><code>password</code></td><td>string</td><td>否</td><td>电脑的登录密码</td></tr></tbody></table><h3 id="ResponseData"><a href="#ResponseData" class="headerlink" title="ResponseData"></a><code>ResponseData</code></h3><p>所有API响应的通用数据结构。</p><table><thead><tr><th>字段名</th><th>类型</th><th>中文说明</th></tr></thead><tbody><tr><td><code>code</code></td><td>integer</td><td>业务状态码, <code>0</code> 表示成功</td></tr><tr><td><code>data</code></td><td>object</td><td>实际返回的数据</td></tr><tr><td><code>msg</code></td><td>string</td><td>提示信息</td></tr><tr><td><code>request_id</code></td><td>string</td><td>本次请求的唯一ID</td></tr></tbody></table>]]>